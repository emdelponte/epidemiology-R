{
  "hash": "e95efd484889fd3a69d114a67235809f",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Disease modeling\"\nbibliography: references.bib\n---\n\n\n\n\n\n## Introduction\n\nAs seen in the previous chapter, plant disease modeling is a crucial tool for predicting disease dynamics and informing management decisions when integrated into decision support systems. By leveraging models, researchers and practitioners can anticipate disease outbreaks, assess potential risks, and implement timely interventions to mitigate losses [@savary2018; @rossi2010a].\n\nMathematical modeling involves representing empirical phenomena and experimental outcomes using mathematical functions. The data used for these models may be collected specifically for modeling purposes or drawn from existing experiments and observations originally conducted to address different research questions, with such data often found in the literature [@hau1990].\n\nMathematical models integrating plant, disease, and environmental - in most cases weather-based variables - factors have been developed since the mid-1900s (See recent review by @gonz√°lez-dom√≠nguez2023 ). Dynamic modeling of disease epidemics gained traction in the early 1960s with foundational work by Vanderplank and Zadoks, setting the stage for future advancements. Since then, researchers have contributed extensively to model development, mainly focusing on the plant disease cycle which outline pathogen development stages, such as dormancy, reproduction, dispersal, and pathogenesis, driven by interactions among host, pathogen, and environmental factors [@dewolf2007].\n\nA systematic map by @fedele2022a identified over 750 papers on plant disease models, primarily aimed at understanding system interactions (n = 680). This map revealed that while most models focus on system understanding, fewer are devoted to tactical management (n = 40), strategic planning (n = 38), or scenario analysis (n = 9).\n\nIn terms of model development, we can classify the models into two main groups based on the approach taken [@gonz√°lez-dom√≠nguez2023]: Empirical or mechanistic approaches, which differ fundamentally in their basis, complexity and application ([@fig-approaches_modeling]).\n\n![Steps of model development from data collection to modeling based on statistical relationships (data-driven) between data collected from field or controlled environment to mechanistic approach based on the elements of the disease cycles (concept-driven).](imgs/modeling-fig1.png){#fig-approaches_modeling fig-align=\"center\" width=\"614\"}\n\n**Empirical models**, which emerged in the mid-20th century, rely on data-driven statistical relationships between variables collected under varying field or controlled environments. These models often lack cause-effect understanding, making them less robust and requiring rigorous validation and calibration when applied in diverse environments, especially in regions that did not provide data for model construction. The parameters of the model change every time new data are incorporated during model development.\n\nIn contrast, **mechanistic models**, developed from a deep understanding of biological and epidemiological processes, explain disease dynamics based on known system behaviors in response to external variables---a concept-driven approach. These dynamic models quantitatively characterize the state of the pathosystem over time, offering generally more robust predictions by utilizing mathematical equations to describe how epidemics evolve under varying environmental conditions.\n\nBoth empirical and mechanistic approaches are valid methodologies extensively used in plant pathology research. The choice between these approaches depends on several factors, including data availability, urgency in model development, and, frequently, the researcher's experience or preference. Empirical models focus on statistical relationships derived directly from data, whereas mechanistic models aim to represent the biological processes of disease progression through linked mathematical equations.\n\nIn mechanistic modeling, the equations used to predict specific disease components---such as infection frequency or the latency period---are often empirically derived from controlled experiments. For example, an infection frequency equation is typically based on data collected under specific environmental conditions, with models fitted to accurately describe observed patterns. These process-based models are then built by integrating empirically-derived equations or rules, which collectively simulate the disease cycle. Data and equations are sourced from published studies or generated from new experiments conducted by researchers.\n\nBeyond their practical predictive value, mechanistic models are valuable tools for organizing existing knowledge about a particular disease, helping to identify gaps and guide future research efforts. An example of such work is the extensive collection of comprehensive mechanistic models developed for various plant diseases by the research group led by Prof. Vittorio Rossi in Italy [@rossi2008; @rossi2014; @salotti2023; @salotti2022].\n\nThis chapter focuses mainly on empirical modeling. We begin by examining the types of data utilized in model development, focusing on those collected under controlled conditions, such as replicated laboratory or growth chamber experiments, as well as field data collected from several locations and years. We will also analyze real-world case studies, drawing on examples from the literature to replicate and understand model applications. Through these examples, we aim to illustrate the process of fitting models to data and underscore the role of modeling in advancing plant disease management practices.\n\n## Controlled environment\n\nIn this section, we will demonstrate, using examples from the literature, how statistical models can be fitted to data that represent various stages of the disease cycle.\n\nResearch on disease-environment interactions under controlled conditions - such as laboratory or growth chamber studies - lays the groundwork for building foundational models, including infection-based models and sub-models for specific processes like dormancy, dispersal, infection, and latency [@krause1975; @magarey2005; @dewolf2007].\n\nGrowth chambers and phytotrons are essential for testing the effects of individual variables, though these controlled results may not fully replicate field conditions. Anyway, laboratory experiments help clarify specific questions by isolating interactions, unlike complex field trials where host, pathogen, and environment factors interact. Polycyclic or \"mini epidemic\" experiments enable observation of disease dynamics under targeted conditions [@hau1990; @rotem1988].\n\nOnce developed, these sub-models can be incorporated into larger mechanistic models that simulate the entire disease cycle, thereby mimicking disease progression over time [@rossi2008; @salotti2023]. Alternatively, sub-models can also be used in stand-alone predictive systems where the process being modeled - such as infection - is the key factor in determining disease occurrence [@machardy1989; @magarey2007]. For example, infection sub-models can be integrated into prediction systems that help schedule crop protection measures by forecasting when infection risk is highest.\n\n### Infection-based models\n\nTo model infection potential based on environmental factors, simple rules can be used with daily weather data, such as temperature and rainfall thresholds [@magarey2002]. Simple decision aids, such as charts and graphs, also exist to help model infection potential by using combinations of daily average temperature and hours of wetness. These tools offer a straightforward approach to evaluate infection risks based on readily available weather data, supporting decision-making without complex modeling [@seem1984]. However, for many pathogens, hourly data is needed, requiring complex models that track favorable conditions hour by hour. These models start with specific triggers and can reset due to conditions like dryness or low humidity, simulating a biological clock for infection risk assessment [@magarey2007].\n\nModeling approaches vary based on available data and model goals. A common method is the matrix approach, like the Wallin potato late blight model, which uses rows for temperature and columns for moisture duration to estimate disease severity [@krause1975] (see previous chapter on [warning systems](https://r4pde.net/prediction-warning-systems)). Bailey enhanced this with an interactive matrix that combines temperature, relative humidity, and duration to assess infection risk across pathogens, making it versatile for various modeling needs [@bailey1999].\n\nWhen infection responses are measured at various temperature and wetness combinations, regression models can be developed to predict infection rates. These models often use polynomial, logistic, or complex three-dimensional response surface equations to represent the relationship between environmental conditions and infection potential. In an excellent review title \"*How to create and deploy infection models for plant pathogen*s\" @magarey2007 discusses that many modeling approaches lack biological foundations and are not generic, making them unsuitable for developing a unified set of disease forecast models. While three-dimensional response surfaces, such as those created with sufficient temperature-moisture observations, offer detailed infection responses, they are often too complex and data-intensive for widespread use (seeTable 1 adapted from @magarey2007).\n\n| Approach                                                               | Strengths                                                                                                          | Weaknesses                                                                               |\n|------------------|---------------------------------|---------------------|\n| Matrix [@krause1975; @mills1944; @windels1998]                         | Easy; converts moisture/temperature combinations into severity values or risk categories. Tried and true approach. | Data to populate matrix may not be readily available.                                    |\n| Regression:<br>-- Polynomial [@evans1992]<br>-- Logistic [@bulger1987] | Widely used in plant pathology. Available for many economically important pathogens.                               | Parameters not biologically based. Requires dataset for development.                     |\n| Three-dimensional response surface [@duthie1997]                       | Describes infection response in detail.                                                                            | Parameters not biologically based. Complex, requires extensive data and processing time. |\n| Degree wet hours [@pfender2003]                                        | Simple; based on degree hours, commonly used in entomology. Requires only Tmin and Tmax                            | Recently developed; assumes linear thermal response.                                     |\n| Temperature-moisture response function [@magarey2005]                  | Simple; based on crop modeling functions, requires only Tmin, Topt and Tmax                                        | Recently developed.                                                                      |\n\n: Comparison of different infection modeling approaches. Source: @magarey2007\n\nIn the following sections, I will demonstrate how various biologically meaningful models fit infection data, using temperature, wetness duration, or a combination of both as predictors.\n\n#### Temperature effects\n\n##### Generalized beta-function\n\nAmong several non-linear models that can be fitted to infection responses to temperature, the generalized beta-function is an interesting alternative [@hau1990]. This is a nonlinear model with five parameters. Two of them, namely $b$ and $c$ , have a biological meaning because they are estimates of the minimum and maximum temperature of the biological process under consideration.\n\nWe will use a subset of the data obtained from a study conducted under controlled conditions that aimed to assess the influence of temperature on the symptom development of citrus canker in sweet orange [@dallapria2006]. The data used here is only for severity on the cultivar Hamlin (plot a in @fig-temperature). The data was extracted using the R package {digitize} as shown [here on this tweet](https://twitter.com/edelponte/status/1580320409794539520?s=20&t=KqjJPmwzFVKm8Gu7Ss-P6A).\n\n![Effect of temperature (12, 15, 20, 25, 30, 35 or 40¬∞C) on disease severity of citrus canker on sweet orange cvs Hamlin (a), Natal (b), Pera (c) and Valencia (d) with a leaf wetness duration of 24 h. Each point represents the mean of three repetitions. Vertical bars represent standard errors. Lines show the generalized beta function fitted to data. Source: @dallapria2006](imgs/modeling-fig_temperature.gif){#fig-temperature fig-align=\"center\" width=\"441\"}\n\nLet's enter the data manually. Where $t$ is the temperature and $y$ is the severity on leaves.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntemp <- tibble::tribble(\n  ~t, ~y,\n12.0, 0.00,\n15.0, 0.1,\n20.0, 0.5,\n25.0, 1.2,\n30.0, 1.5,\n35.0, 1.2,\n40.0, 0.1\n)\n```\n:::\n\n\n\n\n\nFit the generalized beta-function [@hau1990]. The model can be written as:\n\n$$\ny = a*((t - b )^d)*((c - t)^e)\n$$\n\nwhere $b$ and $c$ represent minimum and maximum temperatures, respectively, for the development of the disease, $a$, $d$ and $e$ are parameters to be estimated, $t$ is the temperature and $y$ is disease severity. We need the {minpack.lm} library to avoid parameterization issues.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(minpack.lm)\nfit_temp <- nlsLM(\n  y ~ a * ((t - b) ^ d) * ((c - t) ^ e),\n  start = list(\n    a = 0,\n    b = 10,\n    c = 40,\n    d = 1.5,\n    e = 1\n  ),\n  algorithm = \"port\",\n  data = temp\n)\nsummary(fit_temp)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nFormula: y ~ a * ((t - b)^d) * ((c - t)^e)\n\nParameters:\n   Estimate Std. Error t value Pr(>|t|)    \na  0.001303   0.006295   0.207    0.855    \nb 11.999999   4.875412   2.461    0.133    \nc 40.137236   0.346763 115.748 7.46e-05 ***\nd  1.760101   1.193017   1.475    0.278    \ne  0.830868   0.445213   1.866    0.203    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.1121 on 2 degrees of freedom\n\nAlgorithm \"port\", convergence message: Relative error between `par' and the solution is at most `ptol'.\n```\n\n\n:::\n\n```{.r .cell-code}\nmodelr::rsquare(fit_temp, temp)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.9898275\n```\n\n\n:::\n:::\n\n\n\n\n\nStore the model parameters in objects.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfit_temp$m$getAllPars()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n          a           b           c           d           e \n 0.00130259 11.99999936 40.13723602  1.76010097  0.83086798 \n```\n\n\n:::\n\n```{.r .cell-code}\na <- fit_temp$m$getAllPars()[1]\nb <- fit_temp$m$getAllPars()[2]\nc <- fit_temp$m$getAllPars()[3]\nd <- fit_temp$m$getAllPars()[4]\ne <- fit_temp$m$getAllPars()[5]\n```\n:::\n\n\n\n\n\nCreate a data frame for predictions at each temperature unit from 10 to 45 degree Celsius.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nt <- seq(10, 45, 0.1)\ny <- a * ((t - b) ^ d) * ((c - t) ^ e)\ndat <- data.frame(t, y)\n```\n:::\n\n\n\n\n\nPlot the observed and predicted data using {ggplot2} package.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ggplot2)\nlibrary(r4pde)\ndat |>\n  ggplot(aes(t, y)) +\n  geom_line() +\n  geom_point(data = temp, aes(t, y)) +\n  theme_r4pde(font_size = 16) +\n  labs(x = \"Temperature\", y = \"Severity\",\n       title = \"Generalized beta-function\")\n```\n\n::: {.cell-output-display}\n![](prediction-disease-modeling_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\n\n\n\n##### Analytis beta function\n\n@ji2023a tested and compared various mathematical equations to describe the response of mycelial growth to temperature for several fungi associated with Grapevine trunk diseases. The authors found that the beta equation [@analytis1977] provided the best fit and, therefore, was considered the most suitable for all fungi.\n\nThe model equation for re-scaled severity (0 to 1) as a function of temperature is given by:\n\n$Y = \\left( a \\cdot T_{eq}^b \\cdot (1 - T_{eq}) \\right)^c \\quad ; \\quad \\text{if } Y > 1, \\text{ then } Y = 1$\n\nwhere\n\n$T_{eq} = \\frac{T - T_{\\text{min}}}{T_{\\text{max}} - T_{\\text{min}}}$\n\n$T$ is the temperature in degrees Celsius. $T_{\\text{min}}$ is the minimum temperature, $T_{\\text{max}}$ is the maximum temperature for severity. The $a$ , $b$ , and $c$ are parameters that define the top, symmetry, and size of the unimodal curve.\n\nLet's rescale (0 to 1) the data on the citrus canker using the function rescale of the {scales} package.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(scales)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\nAttaching package: 'scales'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nThe following object is masked from 'package:purrr':\n\n    discard\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nThe following object is masked from 'package:readr':\n\n    col_factor\n```\n\n\n:::\n\n```{.r .cell-code}\ntemp$yscaled <- rescale(temp$y)\ntemp\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 7 √ó 3\n      t     y yscaled\n  <dbl> <dbl>   <dbl>\n1    12   0    0     \n2    15   0.1  0.0667\n3    20   0.5  0.333 \n4    25   1.2  0.8   \n5    30   1.5  1     \n6    35   1.2  0.8   \n7    40   0.1  0.0667\n```\n\n\n:::\n:::\n\n\n\n\n\nNow we can fit the model using the same `nlsLM` function.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Define the minimum and maximum temperatures\nTmin <- 12\nTmax <- 40\n\nlibrary(minpack.lm)\nfit_temp2 <- nlsLM(\n  yscaled ~ (a * ((t - Tmin) / (Tmax - Tmin))^b * (1 - ((t - Tmin) / (Tmax - Tmin))))^c,\n  data = temp,\n  start = list(a = 1, b = 2, c = 3), # Initial guesses for parameters\n  algorithm = \"port\" \n)\n\nsummary(fit_temp2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nFormula: yscaled ~ (a * ((t - Tmin)/(Tmax - Tmin))^b * (1 - ((t - Tmin)/(Tmax - \n    Tmin))))^c\n\nParameters:\n  Estimate Std. Error t value Pr(>|t|)    \na   6.7625     0.3218  21.013 3.03e-05 ***\nb   1.9648     0.1030  19.072 4.45e-05 ***\nc   1.1607     0.1507   7.701  0.00153 ** \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.03955 on 4 degrees of freedom\n\nAlgorithm \"port\", convergence message: Relative error in the sum of squares is at most `ftol'.\n```\n\n\n:::\n\n```{.r .cell-code}\nmodelr::rsquare(fit_temp2, temp)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.9948325\n```\n\n\n:::\n:::\n\n\n\n\n\nLets's store the model parameters in objects.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfit_temp2$m$getAllPars()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n       a        b        c \n6.762509 1.964817 1.160702 \n```\n\n\n:::\n\n```{.r .cell-code}\na <- fit_temp2$m$getAllPars()[1]\nb <- fit_temp2$m$getAllPars()[2]\nc <- fit_temp2$m$getAllPars()[3]\n```\n:::\n\n\n\n\n\nAgain, we create a data frame for predictions at each temperature unit from 10 to 45 degree Celsius.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nTmin <- 12\nTmax <- 40\nt <- seq(10, 45, 0.1)\ny <- (a * ((t - Tmin) / (Tmax - Tmin))^b * (1 - ((t - Tmin) / (Tmax - Tmin))))^c\ndat2 <- data.frame(t, y)\n```\n:::\n\n\n\n\n\nAnd now we can plot the observed and predicted data using {ggplot2} package.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ggplot2)\nlibrary(r4pde)\ndat2 |>\n  ggplot(aes(t, y)) +\n  geom_line() +\n  geom_point(data = temp, aes(t, yscaled)) +\n  theme_r4pde(font_size = 16) +\n  labs(x = \"Temperature\", y = \"Scaled severity\", \n       title = \"Analytis beta function\")\n```\n\n::: {.cell-output-display}\n![](prediction-disease-modeling_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n\n\n\n\n#### Moisture effects\n\n##### Monomolecular function\n\nFor this example, we will use a subset of the data obtained from a study conducted under controlled conditions that aimed to assess the effects of moisture duration on the symptom development of citrus canker in sweet orange [@dallapria2006]. As in the previous example for temperature effects, the data used here is only for severity on the cultivar Hamlin (plot a in @fig-moisture). The data was also extracted using the R package digitize.\n\nLet's look at the original data and the predictions by the model fitted in the paper.\n\n![Effect of leaf wetness duration (0, 4, 8, 12, 16, 20 or 24 h) on disease severity of citrus canker on sweet orange cvs Hamlin (a), Natal (b), Pera (c) and Valencia (d) at 30¬∞C. Each point represents the mean of three repetitions. Vertical bars represent standard errors. Lines show the monomolecular model fitted to data. Source: @dallapria2006](imgs/modeling-fig2.gif){#fig-moisture fig-align=\"center\" width=\"516\"}\n\nFor this pattern in the data, we will fit a three-parameter asymptotic regression model. These models describe a limited growth, where y approaches an horizontal asymptote as x tends to infinity. This equation is also known as Monomolecular Growth, Mitscherlich law or von Bertalanffy law. See [this tutorial](https://www.statforbiology.com/nonlinearregression/usefulequations) for comprehensive information about fitting several non-linear regression models in R.\n\nAgain, we enter the data manually. The ùë•x is wetness duration in hours and ùë¶y is severity.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwet <- tibble::tribble(~ x, ~ y,\n                       0 ,  0,\n                       4 ,  0.50,\n                       8 ,  0.81,\n                       12,  1.50,\n                       16,  1.26,\n                       20,  2.10,\n                       24,  1.45)\n```\n:::\n\n\n\n\n\nThe model can be written as:\n\n$y = c1 + (d1-c1)*(1-exp(-x/e1))$\n\nwhere $c$ is the lower limit (at $x = 0$), the parameter $d$ is the upper limit and the parameter $e$ (greater than 0) is determining the steepness of the increase as $x$.\n\nWe will solve the model again using the `nlsLM` function. We should provide initial values for the three parameters.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfit_wet <- nlsLM(y ~ c1 + (d1 - c1) * (1 - exp(-x / e1)),\n                 start = list(c1 = 0.5,\n                              d1 = 3,\n                              e1 = 1),\n                 data = wet)\n\nsummary(fit_wet)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nFormula: y ~ c1 + (d1 - c1) * (1 - exp(-x/e1))\n\nParameters:\n   Estimate Std. Error t value Pr(>|t|)  \nc1 -0.04898    0.31182  -0.157   0.8828  \nd1  2.00746    0.70594   2.844   0.0467 *\ne1 11.63694    9.33184   1.247   0.2804  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.3296 on 4 degrees of freedom\n\nNumber of iterations to convergence: 7 \nAchieved convergence tolerance: 1.49e-08\n```\n\n\n:::\n\n```{.r .cell-code}\nmodelr::rsquare(fit_wet, wet)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.8532282\n```\n\n\n:::\n:::\n\n\n\n\n\nStore the value of the parameters in the respective object.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nHW <- seq(0, 24, 0.1)\nc1 <-  fit_wet$m$getAllPars()[1]\nd1 <- fit_wet$m$getAllPars()[2]\ne1 <- fit_wet$m$getAllPars()[3]\ny <-  (c1 + (d1 - c1) * (1 - exp(-HW / e1)))\ndat2 <- data.frame(HW, y)\n```\n:::\n\n\n\n\n\nNow we can plot the predictions and the original data.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndat2 |>\n  ggplot(aes(HW, y)) +\n  geom_line() +\n  geom_point(data = wet, aes(x, y)) +\n  theme_r4pde(font_size = 16) +\n  labs(x = \"Wetness duration\", y = \"Severity\")\n```\n\n::: {.cell-output-display}\n![](prediction-disease-modeling_files/figure-html/unnamed-chunk-14-1.png){width=672}\n:::\n:::\n\n\n\n\n\n##### Weibull function\n\nIn the study by [@ji2021; @ji2023a], a Weibull model was fitted to the re-scaled data (0 to 1) on the effect of moisture duration on spore germination or infection. Let's keep working with the re-scaled data on the citrus canker.\n\nThe model is given by:\n\n$y = 1 - \\exp(-(a \\cdot x)^b)$\n\nwhere $y$ is the response variable, $x$ is the moist duration, $a$ is the scale parameter influencing the rate of infection and $b$ is the shape parameter affecting the curve's shape and acceleration\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwet$yscaled <- rescale(wet$y) \nwet\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 7 √ó 3\n      x     y yscaled\n  <dbl> <dbl>   <dbl>\n1     0  0      0    \n2     4  0.5    0.238\n3     8  0.81   0.386\n4    12  1.5    0.714\n5    16  1.26   0.6  \n6    20  2.1    1    \n7    24  1.45   0.690\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nfit_wet2 <- nlsLM(\n  yscaled ~ 1 - exp(-(a * x)^b),\n  data = wet,\n  start = list(a = 1, b = 2),  # Initial guesses for parameters a and b\n  )\nsummary(fit_wet2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nFormula: yscaled ~ 1 - exp(-(a * x)^b)\n\nParameters:\n  Estimate Std. Error t value Pr(>|t|)   \na  0.07684    0.01296    5.93  0.00195 **\nb  1.07610    0.37103    2.90  0.03378 * \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.1404 on 5 degrees of freedom\n\nNumber of iterations to convergence: 26 \nAchieved convergence tolerance: 1.49e-08\n```\n\n\n:::\n\n```{.r .cell-code}\nmodelr::rsquare(fit_wet2, wet)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.8534077\n```\n\n\n:::\n:::\n\n\n\n\n\nSet the value of the parameters in the respective objects\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nx <- seq(0, 24, 0.1)\na <-  fit_wet2$m$getAllPars()[1]\nb <- fit_wet2$m$getAllPars()[2]\ny <-  1 - exp(-(a * x)^b)\ndat3 <- data.frame(x, y)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndat3 |>\n  ggplot(aes(x, y)) +\n  geom_line() +\n  geom_point(data = wet, aes(x, yscaled)) +\n  theme_r4pde(font_size = 16) +\n  labs(x = \"Wetness duration\", y = \"Scaled severity\")\n```\n\n::: {.cell-output-display}\n![](prediction-disease-modeling_files/figure-html/unnamed-chunk-18-1.png){width=672}\n:::\n:::\n\n\n\n\n\n#### Integrating temperature and wetness effects\n\nThe equations developed for the separate effects can be integrated to create a surface response curve or a simple contour plot. Let's first integrate the generalized beta and the monomolecular models for the original severity data for the citrus canker experiment.\n\nFirst, we need a data frame for the interaction between temperature $t$ and hours of wetness $hw$. Then, we obtain the disease value for each combination of $t$ and $hw$.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nt <- rep(1:40, 40)\nhw <- rep(1:40, each = 40)\n\n# let's fit the two models again and store the parameters in objects\n# Temperature effects\nfit_temp <- nlsLM(\n  y ~ a * ((t - b) ^ d) * ((c - t) ^ e),\n  start = list(\n    a = 0,\n    b = 10,\n    c = 40,\n    d = 1.5,\n    e = 1\n  ),\n  algorithm = \"port\",\n  data = temp\n)\nfit_temp$m$getAllPars()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n          a           b           c           d           e \n 0.00130259 11.99999936 40.13723602  1.76010097  0.83086798 \n```\n\n\n:::\n\n```{.r .cell-code}\na <- fit_temp$m$getAllPars()[1]\nb <- fit_temp$m$getAllPars()[2]\nc <- fit_temp$m$getAllPars()[3]\nd <- fit_temp$m$getAllPars()[4]\ne <- fit_temp$m$getAllPars()[5]\n\n## Moist duration effects\nfit_wet <- nlsLM(y ~ c1 + (d1 - c1) * (1 - exp(-x / e1)),\n                 start = list(c1 = 0.5,\n                              d1 = 3,\n                              e1 = 1),\n                 data = wet)\n\nc1 <-  fit_wet$m$getAllPars()[1]\nd1 <- fit_wet$m$getAllPars()[2]\ne1 <- fit_wet$m$getAllPars()[3]\n\ndis <-\n  (a * (t - b) ^ d) * ((c - t) ^ e) * (c1 + (d1 - c1) * (1 - exp(- hw / e1)))\nvalidation <- data.frame(t, hw, dis)\n```\n:::\n\n\n\n\n\nNow the contour plot can be visualized using {ggplot2} and {geomtextpath} packages.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(geomtextpath)\nggplot(validation, aes(t, hw, z = dis)) +\n  geom_contour_filled(bins = 8, alpha = 0.7) +\n  geom_textcontour(bins = 8,\n                   size = 2.5,\n                   padding = unit(0.05, \"in\")) +\n  theme_light(base_size = 10) +\n  theme(legend.position = \"right\") +\n  ylim(0, 40) +\n  labs(y = \"Wetness duration (hours)\",\n       fill = \"Severity\",\n       x = \"Temperature (Celcius)\",\n       title = \"Integrating generalized beta and monomolecular\")\n```\n\n::: {.cell-output-display}\n![](prediction-disease-modeling_files/figure-html/unnamed-chunk-20-1.png){width=672}\n:::\n:::\n\n\n\n\n\nIn the second example, let's integrate the Analytis beta and the Weibull model:\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfit_temp2 <- nlsLM(\n  yscaled ~ (a * ((t - Tmin) / (Tmax - Tmin))^b * (1 - ((t - Tmin) / (Tmax - Tmin))))^c,\n  data = temp,\n  start = list(a = 1, b = 2, c = 3), # Initial guesses for parameters\n  algorithm = \"port\" \n)\n\nfit_temp2$m$getAllPars()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n       a        b        c \n6.762509 1.964817 1.160702 \n```\n\n\n:::\n\n```{.r .cell-code}\na2 <- fit_temp2$m$getAllPars()[1]\nb2 <- fit_temp2$m$getAllPars()[2]\nc2 <- fit_temp2$m$getAllPars()[3]\n\n\nfit_wet2 <- nlsLM(\n  yscaled ~ 1 - exp(-(d * x)^e),\n  data = wet,\n  start = list(d = 1, e = 2),  # Initial guesses for parameters a and b\n  )\n\nd2 <-  fit_wet2$m$getAllPars()[1]\ne2 <- fit_wet2$m$getAllPars()[2]\n\nTmin <- 12\nTmax <- 40\ndis2 <-  (a2 * ((t - Tmin) / (Tmax - Tmin))^b2 * (1 - ((t - Tmin) / (Tmax - Tmin))))^c2 * 1 - exp(-(d2 * hw)^e2)\n\nt <- rep(1:40, 40)\nhw <- rep(1:40, each = 40)\nvalidation2 <- data.frame(t, hw, dis2)\n\nvalidation2 <- validation2 |> \n  filter(dis2 != \"NaN\") |> \n  mutate(dis2 = case_when(dis2 < 0 ~ 0,\n                          TRUE ~ dis2))\n```\n:::\n\n\n\n\n\nNow the plot.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(validation2, aes(t, hw, z = dis2)) +\n  geom_contour_filled(bins = 7, alpha = 0.7) +\n  geom_textcontour(bins = 7,\n                   size = 2.5,\n                   padding = unit(0.05, \"in\")) +\n  theme_light(base_size = 10) +\n  theme(legend.position = \"right\") +\n  ylim(0, 40) +\n  labs(y = \"Wetness duration (hours)\",\n       fill = \"Severity\",\n       x = \"Temperature (Celcius)\",\n       title = \"Integrating generalized beta and monomolecular\")\n```\n\n::: {.cell-output-display}\n![](prediction-disease-modeling_files/figure-html/unnamed-chunk-22-1.png){width=672}\n:::\n:::\n\n\n\n\n\nWe can create a 3D surface plot to visualize the predictions, as [it was used in the original paper](https://bsppjournals.onlinelibrary.wiley.com/cms/asset/0acf45ce-bad8-4a49-9a17-181836aa9876/ppa_1393_f3.gif). Note that In `plot_ly`, a 3D surface plot requires a matrix or grid format for the `z` values, with corresponding vectors for `x` and `y` values that define the axes. If the data frame (`validation2`) has three columns (`t`, `hw`, and `dis2`), we'll need to convert `dis2` into a matrix format that `plot_ly` can interpret for a surface plot.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(plotly)\nlibrary(reshape2)  \nz_matrix <- acast(validation2, hw ~ t, value.var = \"dis2\")\nx_vals <- sort(unique(validation2$t))  \ny_vals <- sort(unique(validation2$hw)) \n\nplot_ly(x = ~x_vals, y = ~y_vals, z = ~z_matrix, type = \"surface\") |> \n    config(displayModeBar = FALSE) |> \n  layout(\n    scene = list(\n      xaxis = list(title = \"Temperature (¬∞C)\", nticks = 10),\n      yaxis = list(title = \"Wetness Duration (hours)\", range = c(0, 40)),\n      zaxis = list(title = \"Severity\"),\n      aspectratio = list(x = 1, y = 1, z = 1)  \n    ),\n    title = \"Integrating Generalized Beta and Monomolecular\"\n  )\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"plotly html-widget html-fill-item\" id=\"htmlwidget-7d3739c51ca9875329e0\" style=\"width:100%;height:464px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-7d3739c51ca9875329e0\">{\"x\":{\"visdat\":{\"aa4c78b4d116\":[\"function () \",\"plotlyVisDat\"]},\"cur_data\":\"aa4c78b4d116\",\"attrs\":{\"aa4c78b4d116\":{\"x\":{},\"y\":{},\"z\":{},\"alpha_stroke\":1,\"sizes\":[10,100],\"spans\":[1,20],\"type\":\"surface\"}},\"layout\":{\"margin\":{\"b\":40,\"l\":60,\"t\":25,\"r\":10},\"scene\":{\"xaxis\":{\"title\":\"Temperature (¬∞C)\",\"nticks\":10},\"yaxis\":{\"title\":\"Wetness Duration (hours)\",\"range\":[0,40]},\"zaxis\":{\"title\":\"Severity\"},\"aspectratio\":{\"x\":1,\"y\":1,\"z\":1}},\"title\":\"Integrating Generalized Beta and Monomolecular\",\"hovermode\":\"closest\",\"showlegend\":false,\"legend\":{\"yanchor\":\"top\",\"y\":0.5}},\"source\":\"A\",\"config\":{\"modeBarButtonsToAdd\":[\"hoverclosest\",\"hovercompare\"],\"showSendToCloud\":false,\"displayModeBar\":false},\"data\":[{\"colorbar\":{\"title\":\"z_matrix\",\"ticklen\":2,\"len\":0.5,\"lenmode\":\"fraction\",\"y\":1,\"yanchor\":\"top\"},\"colorscale\":[[\"0\",\"rgba(68,1,84,1)\"],[\"0.0416666666666667\",\"rgba(70,19,97,1)\"],[\"0.0833333333333333\",\"rgba(72,32,111,1)\"],[\"0.125\",\"rgba(71,45,122,1)\"],[\"0.166666666666667\",\"rgba(68,58,128,1)\"],[\"0.208333333333333\",\"rgba(64,70,135,1)\"],[\"0.25\",\"rgba(60,82,138,1)\"],[\"0.291666666666667\",\"rgba(56,93,140,1)\"],[\"0.333333333333333\",\"rgba(49,104,142,1)\"],[\"0.375\",\"rgba(46,114,142,1)\"],[\"0.416666666666667\",\"rgba(42,123,142,1)\"],[\"0.458333333333333\",\"rgba(38,133,141,1)\"],[\"0.5\",\"rgba(37,144,140,1)\"],[\"0.541666666666667\",\"rgba(33,154,138,1)\"],[\"0.583333333333333\",\"rgba(39,164,133,1)\"],[\"0.625\",\"rgba(47,174,127,1)\"],[\"0.666666666666667\",\"rgba(53,183,121,1)\"],[\"0.708333333333333\",\"rgba(79,191,110,1)\"],[\"0.75\",\"rgba(98,199,98,1)\"],[\"0.791666666666667\",\"rgba(119,207,85,1)\"],[\"0.833333333333333\",\"rgba(147,214,70,1)\"],[\"0.875\",\"rgba(172,220,52,1)\"],[\"0.916666666666667\",\"rgba(199,225,42,1)\"],[\"0.958333333333333\",\"rgba(226,228,40,1)\"],[\"1\",\"rgba(253,231,37,1)\"]],\"showscale\":true,\"x\":[12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40],\"y\":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40],\"z\":[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.020947694132832373,0.057384573297643904,0.077230206950872682,0.078258676120725901,0.058386690942224817,0.015730531346323851,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.033762749915840051,0.08446510582329847,0.12090198498811,0.14074761864133878,0.141776087811192,0.12190410263269091,0.079247943036789947,0.0122037295877373,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.032721048885429149,0.095297112477565782,0.1459994683850242,0.18243634754983573,0.20228198120306451,0.20331045037291773,0.18343846519441664,0.14078230559851568,0.07373809214946303,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0.019351163855817033,0.091371292312893315,0.15394735590502995,0.20464971181248837,0.2410865909772999,0.26093222463052868,0.26196069380038189,0.24208870862188081,0.19943254902597984,0.1323883355769272,0.039753054281635225,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0.074790333687643873,0.14681046214472016,0.20938652573685679,0.26008888164431521,0.29652576080912674,0.31637139446235552,0.31739986363220873,0.29752787845370765,0.25487171885780668,0.18782750540875404,0.095192224113462065,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0.047900347494019724,0.12692153951611718,0.19894166797319346,0.26151773156533009,0.31222008747278851,0.34865696663760004,0.36850260029082882,0.36953106946068204,0.34965908428218095,0.30700292468627999,0.23995871123722734,0.14732342994193537,0.02849331834837221,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0.013153336797770865,0.096741646029262052,0.1757628380513595,0.24778296650843579,0.31035903010057242,0.36106138600803084,0.39749826517284237,0.41734389882607115,0.41837236799592437,0.39850038281742328,0.35584422322152232,0.28880000977246967,0.1961647284771777,0.077334616883614538,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0.05878620711756577,0.14237451634905696,0.22139570837115441,0.29341583682823069,0.35599190042036732,0.40669425632782574,0.44313113549263727,0.46297676914586605,0.46400523831571927,0.44413325313721819,0.40147709354131722,0.33443288009226457,0.2417975987969726,0.12296748720340944,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0.015576470095582273,0.10132851251883124,0.18491682175032242,0.26393801377241988,0.33595814222949616,0.39853420582163279,0.44923656172909121,0.48567344089390274,0.50551907454713152,0.50654754371698474,0.48667555853848365,0.44401939894258269,0.37697518549353004,0.28433990419823807,0.16550979260467491,0.020844084446482447,0,0,0],[0,0,0,0,0,0,0,0,0,0,0.055166792480272175,0.14091883490352114,0.22450714413501233,0.30352833615710978,0.37554846461418606,0.43812452820632269,0.48882688411378111,0.52526376327859259,0.54510939693182148,0.5461378661016747,0.5262658809231735,0.48360972132727259,0.41656550787821994,0.32393022658292797,0.20510011498936481,0.060434406831172349,0,0,0],[0,0,0,0,0,0,0,0,0,0.0063901141470076861,0.091954748201850456,0.17770679062509942,0.26129509985659061,0.34031629187868806,0.41233642033576434,0.47491248392790097,0.52561483983535939,0.56205171900017092,0.5818973526533997,0.58292582182325292,0.56305383664475184,0.52039767704885087,0.45335346359979822,0.36071818230450625,0.24188807071094309,0.09722236255275063,0,0,0],[0,0,0,0,0,0,0,0,0,0.040530107226282475,0.12609474128112524,0.21184678370437421,0.2954350929358654,0.37445628495796285,0.44647641341503913,0.50905247700717582,0.55975483291463424,0.59619171207944577,0.61603734573267444,0.61706581490252765,0.59719382972402668,0.55453767012812571,0.48749345667907301,0.39485817538378104,0.27602806379021788,0.13136235563202542,0,0,0],[0,0,0,0,0,0,0,0,0,0.072177191810116947,0.15774182586495972,0.24349386828820868,0.32708217751969987,0.40610336954179732,0.4781234979988736,0.54069956159101018,0.5914019174984686,0.62783879666328013,0.64768443031650902,0.64871289948636224,0.62884091430786104,0.58618475471196008,0.51914054126290754,0.42650525996761551,0.30767514837405235,0.16300944021585989,0,0,0],[0,0,0,0,0,0,0,0,0.018382984623872112,0.10148429471524639,0.18704892877008916,0.27280097119333813,0.35638928042482931,0.43541047244692677,0.50743060090400305,0.57000666449613968,0.6207090204035981,0.65714589956840963,0.67699153322163841,0.67802000239149163,0.65814801721299054,0.61549185761708958,0.54844764416803693,0.45581236287274496,0.3369822512791818,0.19231654312098934,0.023924351496224072,0,0],[0,0,0,0,0,0,0,0,0.045499038715348106,0.12860034880672239,0.21416498286156516,0.29991702528481412,0.38350533451630531,0.46252652653840276,0.53454665499547904,0.59712271858761568,0.64782507449507409,0.68426195365988562,0.7041075873131144,0.70513605648296762,0.68526407130446654,0.64260791170856557,0.57556369825951292,0.48292841696422095,0.36409830537065779,0.21943259721246533,0.051040405587700066,0,0],[0,0,0,0,0,0,0,0,0.070567744086310835,0.15366905417768512,0.23923368823252789,0.32498573065577685,0.40857403988726804,0.48759523190936549,0.55961536036644177,0.6221914239585784,0.67289377986603682,0.70933065903084835,0.72917629268407713,0.73020476185393035,0.71033277667542927,0.6676766170795283,0.60063240363047565,0.50799712233518368,0.38916701074162052,0.24450130258342806,0.076109110958662796,0,0],[0,0,0,0,0,0,0,0.015263809606941958,0.093726771391593799,0.17682808148296808,0.26239271553781085,0.34814475796105981,0.431733067192551,0.51075425921464845,0.58277438767172474,0.64535045126386137,0.69605280717131979,0.73248968633613132,0.7523353199893601,0.75336378915921332,0.73349180398071223,0.69083564438481126,0.62379143093575862,0.53115614964046665,0.41232603804690349,0.26766032988871102,0.09926813826394576,0,0],[0,0,0,0,0,0,0,0.036644319676398529,0.11510728146105037,0.19820859155242465,0.28377322560726742,0.36952526803051639,0.45311357726200757,0.53213476928410497,0.60415489774118125,0.66673096133331788,0.7174333172407763,0.75387019640558783,0.77371583005881672,0.77474429922866994,0.75487231405016875,0.71221615445426778,0.64517194100521524,0.55253665970992327,0.43370654811636006,0.28904083995816759,0.12064864833340233,0,0],[0,0,0,0,0,0,0,0.056370711696431181,0.13483367348108302,0.2179349835724573,0.30349961762730004,0.38925166005054901,0.4728399692820402,0.55186116130413765,0.62388128976121393,0.68645735335335056,0.73715970926080898,0.77359658842562051,0.79344222207884929,0.79447069124870251,0.77459870607020143,0.73194254647430046,0.66489833302524781,0.57226305172995584,0.45343294013639268,0.30876723197820022,0.14037504035343498,0,0],[0,0,0,0,0,0,0.0027797863651659871,0.074560537448874808,0.15302349923352665,0.23612480932490093,0.3216894433797437,0.40744148580299266,0.49102979503448385,0.5700509870565813,0.64207111551365759,0.70464717910579422,0.75534953501325264,0.79178641417806417,0.81163204783129295,0.81266051700114617,0.79278853182264508,0.75013237222674412,0.68308815877769147,0.5904528774823995,0.47162276588883634,0.32695705773064387,0.15856486610587861,0,0],[0,0,0,0,0,0,0.01954378514400601,0.091324536227714831,0.16978749801236667,0.25288880810374093,0.33845344215858375,0.42420548458183271,0.5077937938133239,0.58681498583542135,0.65883511429249764,0.72141117788463427,0.77211353379209269,0.80855041295690422,0.828396046610133,0.82942451577998622,0.80955253060148513,0.76689637100558417,0.69985215755653152,0.60721687626123955,0.48838676466767639,0.34372105650948392,0.17532886488471863,0,0],[0,0,0,0,0,0,0.034986005911865042,0.10676675699557386,0.18522971878022571,0.26833102887159999,0.35389566292644276,0.43964770534969172,0.52323601458118296,0.6022572066032803,0.67427733506035659,0.73685339865249322,0.78755575455995164,0.82399263372476317,0.84383826737799206,0.84486673654784528,0.82499475136934408,0.78233859177344311,0.71529437832439058,0.62265909702909861,0.50382898543553534,0.35916327727734293,0.19077108565257767,0.0047806794252760465,0],[0,0,0,0,0,0,0.049203991764441707,0.12098474284815053,0.19944770463280237,0.28254901472417665,0.36811364877901942,0.45386569120226838,0.53745400043375957,0.61647519245585702,0.68849532091293331,0.75107138450506994,0.80177374041252836,0.83821061957733989,0.85805625323056867,0.85908472240042189,0.8392127372219208,0.79655657762601983,0.72951236417696719,0.63687708288167522,0.51804697128811206,0.37338126312991959,0.20498907150515433,0.018998665277852711,0],[0,0,0,0,0,0,0.062289007944925534,0.13406975902863436,0.2125327208132862,0.29563403090466045,0.38119866495950328,0.46695070738275224,0.55053901661424343,0.62956020863634088,0.70158033709341716,0.76415640068555379,0.81485875659301221,0.85129563575782374,0.87114126941105252,0.87216973858090574,0.85229775340240466,0.80964159380650369,0.74259738035745104,0.64996209906215907,0.53113198746859591,0.38646627931040345,0.21807408768563816,0.032083681458336538,0],[0,0,0,0,0,0.011102565507374845,0.074326299204323099,0.14610705028803192,0.22457001207268376,0.30767132216405801,0.39323595621890084,0.4789879986421498,0.56257630787364099,0.64159749989573844,0.71361762835281473,0.77619369194495136,0.82689604785240978,0.86333292701722131,0.88317856067045009,0.8842070298403033,0.86433504466180222,0.82167888506590125,0.75463467161684861,0.66199939032155664,0.54316927872799348,0.39850357056980101,0.23011137894503572,0.044120972717734103,0],[0,0,0,0,0,0.022171632012530862,0.085395365709479115,0.15717611679318794,0.23563907857783978,0.31874038866921406,0.40430502272405683,0.49005706514730579,0.57364537437879703,0.65266656640089438,0.72468669485797066,0.78726275845010729,0.83796511435756571,0.87440199352237724,0.89424762717560613,0.89527609634545935,0.87540411116695815,0.83274795157105719,0.76570373812200465,0.67306845682671268,0.55423834523314941,0.409572637074957,0.24118044545019174,0.055190039222890119,0],[0,0,0,0,0,0.032346515581032839,0.095570249277981092,0.16735100036168993,0.24581396214634177,0.32891527223771605,0.41447990629255882,0.50023194871580778,0.58382025794729897,0.66284144996939642,0.73486157842647271,0.79743764201860934,0.84813999792606776,0.88457687709087929,0.90442251074410807,0.90545097991396128,0.8855789947354602,0.84292283513955923,0.77587862169050659,0.68324334039521462,0.56441322880165146,0.41974752064345899,0.25135532901869373,0.065364922791392097,0],[0,0,0,0,0,0.041696089992078661,0.10491982368902691,0.17670057477273574,0.25516353655738755,0.33826484664876189,0.4238294807036046,0.50958152312685356,0.59316983235834475,0.6721910243804422,0.74421115283751849,0.80678721642965512,0.85748957233711354,0.89392645150192507,0.91377208515515385,0.91480055432500706,0.89492856914650598,0.85227240955060501,0.78522819610155237,0.6925929148062604,0.57376280321269724,0.42909709505450477,0.26070490342973951,0.074714497202437918,0],[0,0,0,0,0,0.050284350640351805,0.11350808433730006,0.18528883542100888,0.26375179720566072,0.346853107297035,0.43241774135187777,0.51816978377512668,0.60175809300661798,0.68077928502871532,0.7527994134857916,0.81537547707792823,0.86607783298538665,0.90251471215019818,0.92236034580342707,0.92338881497328029,0.9035168297947791,0.86086067019887813,0.79381645674982559,0.70118117545453362,0.58235106386097035,0.43768535570277795,0.26929316407801268,0.083302757850711062,0],[0,0,0,0,0.0051589349460192252,0.058170699977401263,0.12139443367434952,0.19317518475805834,0.27163814654271018,0.35473945663408446,0.44030409068892723,0.52605613311217625,0.60964444234366733,0.68866563436576489,0.76068576282284117,0.8232618264149778,0.87396418232243622,0.91040106148724775,0.93024669514047642,0.93127516431032964,0.91140317913182867,0.8687470195359277,0.80170280608687494,0.70906752479158297,0.59023741319801992,0.4455717050398274,0.27717951341506214,0.091189107187760521,0],[0,0,0,0,0.01239846107163517,0.065410226103017208,0.12863395979996545,0.2004147108836743,0.27887767266832614,0.36197898275970042,0.44754361681454319,0.5332956592377921,0.61688396846928328,0.69590516049138074,0.76792528894845702,0.83050135254059365,0.88120370844805207,0.9176405876128636,0.93748622126609238,0.9385146904359456,0.91864270525744451,0.87598654566154355,0.8089423322124909,0.71630705091719893,0.59747693932363577,0.45281123116544336,0.2844190395406781,0.098428633313376465,0],[0,0,0,0,0.019042207556016613,0.072053972587398651,0.1352777062843469,0.20705845736805573,0.28552141915270757,0.36862272924408185,0.45418736329892462,0.53993940572217358,0.62352771495366477,0.70254890697576222,0.7745690354328385,0.83714509902497514,0.88784745493243356,0.92428433409724509,0.94412996775047386,0.94515843692032708,0.925286451741826,0.88263029214592503,0.81558607869687239,0.72295079740158041,0.60412068580801725,0.45945497764982479,0.29106278602505953,0.10507237979775791,0],[0,0,0,0,0.025137433136809217,0.078149198168191256,0.1413729318651395,0.21315368294884834,0.29161664473350019,0.37471795482487447,0.46028258887971724,0.54603463130296614,0.62962294053445733,0.70864413255655478,0.78066426101363107,0.8432403246057677,0.89394268051322612,0.93037955967803765,0.95022519333126643,0.95125366250111965,0.93138167732261856,0.8887255177267176,0.82168130427766495,0.72904602298237298,0.61021591138880982,0.46555020323061741,0.29715801160585215,0.11116760537855051,0],[0,0,0,0,0.030727860377120234,0.083739625408502272,0.14696335910545053,0.21874411018915935,0.29720707197381119,0.38030838206518547,0.46587301612002824,0.55162505854327715,0.63521336777476844,0.71423455979686579,0.78625468825394207,0.8488307518460787,0.89953310775353712,0.93596998691834865,0.95581562057157754,0.95684408974143076,0.93697210456292956,0.8943159449670286,0.82727173151797606,0.73463645022268409,0.61580633862912082,0.47114063047092841,0.30274843884616315,0.11675803261886153,0],[0,0,0,0,0.035853912717181649,0.088865677748563687,0.15208941144551194,0.22387016252922076,0.3023331243138726,0.38543443440524688,0.47099906846008965,0.55675111088333862,0.6403394201148298,0.71936061213692726,0.79138074059400354,0.85395680418614017,0.90465916009359859,0.94109603925841012,0.9609416729116389,0.96197014208149212,0.94209815690299104,0.89944199730709007,0.83239778385803742,0.73976250256274545,0.62093239096918229,0.47626668281098983,0.30787449118622456,0.12188408495892294,0],[0,0,0,0,0.040552939623338537,0.093564704654720582,0.15678843835166884,0.22856918943537766,0.30703215122002947,0.39013346131140375,0.47569809536624652,0.56145013778949548,0.64503844702098667,0.72405963904308412,0.79607976750016041,0.85865583109229704,0.90935818699975546,0.94579506616456699,0.96564069981779577,0.96666916898764899,0.9467971838091479,0.90414102421324694,0.83709681076419429,0.74446152946890232,0.62563141787533916,0.48096570971714669,0.31257351809238143,0.12658311186507984,0],[0,0,0,0.0034205896149966802,0.044859429748971731,0.097871194780353776,0.16109492847730203,0.23287567956101085,0.31133864134566269,0.39443995143703697,0.48000458549187974,0.56575662791512871,0.64934493714661989,0.72836612916871735,0.80038625762579363,0.86296232121793026,0.91366467712538868,0.95010155629020021,0.96994718994342899,0.97097565911328221,0.95110367393478112,0.90844751433888016,0.84140330088982751,0.74876801959453554,0.62993790800097238,0.48527219984277992,0.31688000821801465,0.13088960199071303,0],[0,0,0,0.0073663720509898542,0.048805212184964905,0.10181697721634694,0.1650407109132952,0.23682146199700402,0.31528442378165589,0.39838573387303011,0.48395036792787294,0.5697024103511219,0.65329071958261309,0.73231191160471054,0.80433204006178682,0.86690810365392346,0.91761045956138187,0.95404733872619341,0.97389297237942218,0.9749214415492754,0.95504945637077432,0.91239329677487335,0.8453490833258207,0.75271380203052873,0.63388369043696557,0.48921798227877311,0.32082579065400785,0.1348353844267062,0],[0,0,0,0.010980805868016412,0.052419646001991463,0.1054314110333735,0.16865514473032175,0.24043589581403058,0.31889885759868242,0.4020001676900567,0.48756480174489947,0.57331684416814843,0.65690515339963962,0.73592634542173707,0.80794647387881335,0.87052253747094999,0.9212248933784084,0.95766177254321994,0.97750740619644871,0.97853587536630193,0.95866389018780085,0.91600773059189988,0.84896351714284723,0.75632823584755526,0.6374981242539921,0.49283241609579964,0.32444022447103438,0.13844981824373276,0],[0,0,0,0.014290958246870752,0.055729798380845803,0.10874156341222785,0.1719652971091761,0.24374604819288492,0.32220900997753676,0.40531032006891105,0.49087495412375381,0.57662699654700278,0.66021530577849397,0.73923649780059142,0.8112566262576677,0.87383268984980433,0.92453504575726275,0.96097192492207428,0.98081755857530306,0.98184602774515628,0.9619740425666552,0.91931788297075423,0.85227366952170158,0.75963838822640961,0.64080827663284645,0.49614256847465399,0.32775037684988872,0.14175997062258711,0]],\"type\":\"surface\",\"frame\":null}],\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.20000000000000001,\"selected\":{\"opacity\":1},\"debounce\":0},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\n\n\n\n#### Magarey's generic infection model\n\nIn the early 2000s, Magarey and collaborators [@magarey2005] proposed a generic infection model for foliar fungal pathogens, designed to predict infection periods based on limited data on temperature and wetness requirements. The model uses cardinal temperatures (minimum, optimum, maximum) and the minimum wetness duration (Wmin) necessary for infection. The model can incorporate inputs based on estimated cardinal temperatures and surface wetness duration. These values are available for numerous pathogens and can be consulted in the literature (See table 2 of the paper by @magarey2005).\n\nThe model utilizes a temperature response function, which is adjusted to the pathogen's minimum and optimum wetness duration needs, allowing it to be broadly applicable even with limited data on specific pathogens. The model was validated with data from 53 studies, showing good accuracy and adaptability, even for pathogens lacking comprehensive data [@magarey2005].\n\nThe function is given by\n\n$f(T) = \\left( \\frac{T_{\\text{max}} - T}{T_{\\text{max}} - T_{\\text{opt}}} \\right)^{\\frac{T_{\\text{opt}} - T_{\\text{min}}}{T_{\\text{max}} - T_{\\text{opt}}}} \\times \\left( \\frac{T - T_{\\text{min}}}{T_{\\text{opt}} - T_{\\text{min}}} \\right)^{\\frac{T_{\\text{opt}} - T_{\\text{min}}}{T_{\\text{opt}} - T_{\\text{min}}}}$\n\nwhere $T$ is the temperature, $T_{\\text{min}}$ is the minimum temperature, $T_{\\text{opt}}$ is the optimum temperature, and $T_{\\text{max}}$ is the maximum temperature for infection.\n\nThe wetness duration requirement is given by\n\n$W(T) = \\frac{W_{\\text{min}}}{f(T)} \\leq W_{\\text{max}}$\n\nwhere $W_{\\text{min}}$ is the minimum wetness duration requirement, and $W_{\\text{max}}$ is an optional upper limit on $W(T)$.\n\nLet's write the functions for estimating the required wetness duration at each temperature.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntemp_response <- function(T, Tmin, Topt, Tmax) {\n  if (T < Tmin || T > Tmax) {\n    return(0)\n  } else {\n    ((Tmax - T) / (Tmax - Topt))^((Topt - Tmin) / (Tmax - Topt)) * \n    ((T - Tmin) / (Topt - Tmin))^((Topt - Tmin) / (Topt - Tmin))\n  }\n}\n\n# Define the function to calculate wetness duration requirement W(T)\nwetness_duration <- function(T, Wmin, Tmin, Topt, Tmax, Wmax = Inf) {\n  f_T <- temp_response(T, Tmin, Topt, Tmax)\n  if (f_T == 0) {\n    return(0)  # Infinite duration required if outside temperature range\n  }\n  W <- Wmin / f_T\n  return(min(W, Wmax))  # Apply Wmax as an upper limit if specified\n}\n```\n:::\n\n\n\n\n\nLet's set the parameters for the fungus *Venturia inaequalis*, the cause of apple scab.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Parameters for Venturia inaequalis (apple scab)\nT <- seq(0, 35, by = 0.5) \nWmin <- 6                  \nTmin <- 1                  \nTopt <- 20                 \nTmax <- 35                 \nWmax <- 40.5                \n\n# Calculate wetness duration required at each temperature\nW_T <- sapply(T, wetness_duration, Wmin, Tmin, Topt, Tmax, Wmax)\n\ntemperature_data_applescab <- data.frame(\n  Temperature = T,\n  Wetness_Duration = W_T\n)\n```\n:::\n\n\n\n\n\nAnd now the parameters for the fungus *Phakopsora pachyrhizi*, the cause of soybean rust in soybean.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Parameters for Phakposora pachyrhizi\nT <- seq(0, 35, by = 0.5)  \nWmin <- 8                \nTmin <- 10                  \nTopt <- 23                 \nTmax <- 28                \nWmax <- 12                 \n\n# Calculate wetness duration required at each temperature\nW_T <- sapply(T, wetness_duration, Wmin, Tmin, Topt, Tmax, Wmax)\n\ntemperature_data_soyrust <- data.frame(\n  Temperature = T,\n  Wetness_Duration = W_T)\n```\n:::\n\n\n\n\n\nWe can produce the plots for each pathogen.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\napplescab <- ggplot(temperature_data_applescab, aes(x = Temperature, y = Wetness_Duration)) +\n  geom_line(color = \"black\", linewidth = 1, linetype =1) +\n  theme_r4pde(font_size = 14)+\n  labs(x = \"Temperature (¬∞C)\", y = \"Wetness Duration (hours)\", \n       subtitle = \"Venturia inaequalis\")+\n  theme(plot.subtitle = element_text(face = \"italic\"))\n\nsoyrust <- ggplot(temperature_data_soyrust, aes(x = Temperature, y = Wetness_Duration)) +\n  geom_line(color = \"black\", linewidth = 1, linetype =1) +\n  theme_r4pde(font_size = 14)+\n  labs(x = \"Temperature (¬∞C)\", y = \"Wetness Duration (hours)\", \n       subtitle = \"Phakopsora pachyrizhi\")+ \n  theme(plot.subtitle = element_text(face = \"italic\"))\n\nlibrary(patchwork)\napplescab | soyrust\n```\n\n::: {.cell-output-display}\n![](prediction-disease-modeling_files/figure-html/unnamed-chunk-27-1.png){width=672}\n:::\n:::\n\n\n\n\n\n### Latency period models\n\nThe latent period can be defined as \"the length of time between the start of the infection process by a unit of inoculum and the start of production of infectious units\" [@madden2007]. The latent period, analogous to the reproductive maturity age of nonparasitic organisms, defines the generation time between infections and is a key factor in pathogen development and epidemic progress in plant disease epidemiology [@plantdi1963]. As a critical trait of aggressiveness, especially in polycyclic diseases, it largely determines the potential number of infection cycles within a season, impacting the overall epidemic intensity [@lannou2012].\n\n#### Parabolic function\n\nThe effects of temperature on the length of the incubation and latent periods of hawthorn powdery mildew, caused by *Podosphaera clandestina*, were studied by @xu2000. In that work, the authors inoculated the leaves and, each day after inoculation, the upper surface of each leaf was examined for mildew colonies and conidiophores using a pen-microscope (√ó50). Sporulation was recorded at the leaf level, noting the number of colonies and the first appearance dates of colonies and sporulation for each leaf.\n\nThe latent period (LP) was defined as the time from inoculation to the first day of observed sporulation on the leaf. Due to the skewed distribution of LP across temperatures and inoculations, medians were used to summarize LP rather than means [@xu2000].\n\nLet's look at two plots extracted from the paper. The first, on the left-hand side, is the original number of days of the latent period of each evaluated temperature (note: the solid symbol is for constant temperature while the open circle is for fluctuating temperature). On the right-hand side, the relationship between temperature and rates of development of powdery mildew under constant temperature during the latent periods; the solid line indicates the fitted model. The rate of fungal development was calculated as the reciprocal of the corresponding observed incubation (in hours) and latent periods.\n\n![Source: @xu2000](imgs/modeling-latent.png){#fig-latent fig-align=\"center\"}\n\nThe latent period data in days for the solid black circle (constant temperature) above was extracted using the {digitize} R package.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlatent <- tibble::tribble(\n   ~T, ~days,\n  10L,   13L,\n  11L,   16L,\n  13L,    8L,\n  14L,    9L,\n  15L,    7L,\n  16L,    7L,\n  17L,    6L,\n  18L,    6L,\n  19L,    6L,\n  20L,    6L,\n  21L,    5L,\n  22L,    5L,\n  23L,    6L,\n  24L,    6L,\n  25L,    5L,\n  26L,    7L,\n  27L,    7L,\n  28L,   10L\n  )\n```\n:::\n\n\n\n\n\nLet's reproduce the two plots using the datapoints.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#|fig-width: 10\n#|fig-height: 4\nlibrary(ggplot2)\nlibrary(r4pde)\n\np_latent <- latent |> \n  ggplot(aes(T, days))+\n  geom_point()+\n  theme_r4pde()\n\nlatent_rate <- data.frame(\n  T = latent$T,  # Scale temperature\n  R = 1/latent$days/24\n)\n\np_latent_rate <- latent_rate |> \n  ggplot(aes(T, R))+\n  geom_point()+\n  theme_r4pde()\n\nlibrary(patchwork)\np_latent | p_latent_rate\n```\n\n::: {.cell-output-display}\n![](prediction-disease-modeling_files/figure-html/unnamed-chunk-29-1.png){width=672}\n:::\n:::\n\n\n\n\n\nWe will fit the parabolic function proposed by @bernard2013 which predicts a thermal response curve (developmental rate, R), which is the relationship between the inverse of latent period and temperature. We need to enter the values for optimum temperature (where latent period is shortest) and the minimum latent period. The model is given by:\n\n$R(T) = \\frac{k}{\\text{LP}_{\\text{min}} + \\text{a} \\times (T - T_{\\text{opt}})^2}$\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Load necessary package\n#library(minpack.lm)\n\n# Define the model formula\n# model_formula <- R ~ (a + b * T)^(c * T)\nLPmin <- 5 # minimum latent period\nTopt <- 21 # Optimal temperature\nmodel_formula2 <- R ~ k / (LPmin + a * (T - Topt)^2)\n\n# Set initial parameter estimates\n#start_values <- list(a = 0.1, b = 0.01, c = 0.01)\nstart_values2 <- list(a = 0.1, k = 1)\n# Fit the model\n#fit_rate <- nlsLM(model_formula, data = latent_rate, start = start_values)\nfit_rate2 <- nls(model_formula2, data = latent_rate, start = start_values2)\n\n# View the summary of the fit\nsummary(fit_rate2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nFormula: R ~ k/(LPmin + a * (T - Topt)^2)\n\nParameters:\n  Estimate Std. Error t value Pr(>|t|)    \na 0.060274   0.010705    5.63 3.76e-05 ***\nk 0.039520   0.001464   26.99 9.05e-15 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.0006936 on 16 degrees of freedom\n\nNumber of iterations to convergence: 6 \nAchieved convergence tolerance: 3.183e-06\n```\n\n\n:::\n\n```{.r .cell-code}\nfit_rate2$m$getAllPars()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n         a          k \n0.06027417 0.03952035 \n```\n\n\n:::\n\n```{.r .cell-code}\na <- fit_rate2$m$getAllPars()[1]\nk <- fit_rate2$m$getAllPars()[2]\n```\n:::\n\n\n\n\n\nNow we reproduce the plot with the fitted data. Note that the curve is not the same shown in the paper because we used a different equation.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nT <- seq(10, 29, 0.1)\n#R <- (a + b * T)^(c * T)\nR <- k / (LPmin + a * (T - Topt)^2)\ndat2 <- data.frame(T, R)\n\ndat2 |>\n  ggplot(aes(T, R)) +\n  geom_line() +\n  geom_point(data = latent_rate, aes(T, R)) +\n  theme_r4pde(font_size = 16) +\n  labs(x = \"Temperature\", y = \"Inverse of the latent period (hour -1)\", \n       title = \"\")\n```\n\n::: {.cell-output-display}\n![](prediction-disease-modeling_files/figure-html/unnamed-chunk-31-1.png){width=672}\n:::\n:::\n\n\n\n\n\n## Field data\n\nWhile pathogen inoculum, host resistance, and agronomic factors are sometimes included alongside weather in empirically derived models using field data [@shah2013; @cao2015; @mehra2017], only a few models explicitly incorporate non-weather factors [@mehra2016; @paul2004]. In most cases, these models primarily rely on weather variables as predictors [@gonz√°lez-dom√≠nguez2023]. This focus reflects the critical role of weather in driving key processes in the disease cycle, such as pathogen survival, dispersal, host infection, and reproduction [@dewolf2007]. Consequently, a primary objective for plant epidemiologists is to identify and quantify the relationships between weather conditions and measures of disease intensity [@shah2019; @eljarroudi2017; @pietravalle2003; @coakley1988; @delponte2006; @shah2013; @coakley1988a].\n\nIn modeling efforts, the disease variable can be represented either as a continuous measure (e.g., incidence or severity) or as categorical data, which may be binary (e.g., non-epidemic vs. epidemic) or multinomial (e.g., low, moderate, and high severity). This variability in response types informs the selection of suitable modeling techniques, ensuring that the model accurately captures the nature of the data and the relationships between weather variables and disease outcomes.\n\nIn this section, I will demonstrate several modeling approaches that can be applied when field data is available. These examples will cover a range of techniques, starting with variable construction, which involves transforming raw weather data into summary measures that can effectively represent conditions relevant to disease outcomes. Next, variable selection methods will be explored to identify the most influential predictors, ensuring that models are both accurate and interpretable. The focus will then shift to model fitting, showing how different models, such as linear and logistic regression, can be used to capture relationships between weather variables and disease endpoints. Finally, model evaluation will be addressed, emphasizing metrics like accuracy, sensitivity, and area under the curve (AUC), which are crucial for assessing the predictive performance and reliability of the models developed.\n\n### Variable construction\n\nVariable construction, particularly for weather-related variables, involves not only data transformation methods but also requires an understanding of how diseases respond to specific weather conditions at particular growth stages [@dec√≥l2024; @dewolf2003]. This approach ensures that the variables derived accurately capture biologically relevant processes, improving the realism and relevance of the model inputs.\n\nIn addition, data mining techniques are employed to systematically explore time-series data and identify potential weather-disease relationships [@shah2019; @pietravalle2003; @coakley1988]. These techniques involve creating lagged variables, moving averages, or window-based summaries that capture delayed or cumulative effects of weather on disease outcomes. By integrating system knowledge with data mining, researchers aim to construct variables that are both biologically meaningful and statistically robust, improving the chances of identifying predictors that enhance model accuracy and interpretability.\n\n#### Window-pane\n\nWith regards to weather variable creation for data-mining purposes, window-pane analysis, first introduced in the mid-1980s [@coakley1985], has been widely used in modeling studies in plant pathology [@pietravalle2003; @calverojr1996; @tebeest2008a; @gouache2015a; @coakley1988; @kriss2010; @dallalana2021; @coakley1988a]. This method aids in identifying weather conditions that are most strongly associated with disease outcomes by segmenting a continuous time series (e.g. daily temperature, relative humidity, and rainfall), into discrete, fixed-length windows.\n\nThe analysis involves summarizing conditions within each window (e.g., mean, sum, count) and correlating these summaries with disease outcomes, which may be expressed as continuous measures (e.g., severity) or as categorical variables (e.g., low vs. high levels). This approach allows users to set specific start and end times, as well as window lengths, enabling the exploration of different temporal relationships between weather and disease. By sliding the start and end points along the series, multiple overlapping windows are generated, making it possible to identify the most informative variables for modeling. The selected optimal fixed-time and fixed-window-length variables derived from this analysis serve as predictors in model development, helping to improve the accuracy and relevance of disease forecasting models.\n\nHere's an R code that demonstrates how the windows are defined over a 28-day period using four fixed window lengths (7, 14, 21, and 28 days), generating a total of 46 variables.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nlibrary(dplyr)\nlibrary(ggplot2)\n\n# Define total days and window lengths\nmax_days <- 28\nwindow_lengths <- c(7, 14, 21, 28)\n\n# Create an empty data frame for all sliding windows\nwindow_data <- data.frame()\n\n# Populate the data frame with start and end points for each window\nvar_id <- 1  # Variable ID for each window\n\nfor (length in sort(window_lengths)) {  # Sort window lengths from shortest to longest\n  for (start_day in 0:(max_days - length)) {\n    end_day <- start_day + length\n    window_data <- rbind(\n      window_data,\n      data.frame(\n        start = start_day,\n        end = end_day,\n        var_id = var_id,\n        window_length = length\n      )\n    )\n    var_id <- var_id + 1  # Increment variable ID\n  }\n}\n\n# Convert window_length to a factor for correct ordering in the legend\nwindow_data$window_length <- factor(window_data$window_length, levels = sort(unique(window_data$window_length)))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nwindow_data |> \n  ggplot(aes(x = start, xend = end, y = var_id, yend = var_id)) +\n  geom_segment(linewidth = 2) +  # Line segments for each window\n  scale_x_continuous(breaks = 0:max_days, limits = c(0, max_days)) +\n  scale_y_continuous(breaks = 1:var_id) +\n  labs(title = \"Window-pane\",\n    subtitle = \"Each variable of 7, 14, 21 and 28 days length over 28 days\",\n    x = \"Days\", y = \"Variable ID\", color = \"Window Length (days)\") +\n  r4pde::theme_r4pde(font_size = 14) +\n  theme(legend.position = \"right\")\n```\n\n::: {.cell-output-display}\n![](prediction-disease-modeling_files/figure-html/unnamed-chunk-33-1.png){width=768}\n:::\n:::\n\n\n\n\n\nThe window pane analysis requires a spreadsheet program [@kriss2010] or a specific algorithm that automates the creation of sliding windows at defined starting and ending times relative to a reference date. In the seminal work, software was programmed in the FORTRAN language and named WINDOW [@coakley1985]. It enabled the creation of windows and the calculation of summary statistics, including correlation with disease severity. Building on the original idea, a Genstat 6.1 algorithm was developed in the early 2000s, incorporating further adjustments such as the implementation of bootstrapping analysis to validate correlations and misclassifications identified by window pane [@pietravalle2003; @tebeest2008a]. More recently, window pane analysis including variable creation and analysis has been conducted in R using custom-made scripts [@gouache2015a; @dallalana2021].\n\nHere, I will demonstrate the `windowpane()` function of the {r4pde} package developed to facilitate the creation of variables using the window pane principles.\n\nLet's first load a dataset that contains information on the disease and also metadata including a key date that will be used as starting point for windows creation. The `BlastWheat` dataset that is included in the {r4pde} package was made available by @dec√≥l2024.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(r4pde)\ntrials <- BlastWheat\nglimpse(trials)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 143\nColumns: 10\n$ study      <dbl> 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, ‚Ä¶\n$ year       <dbl> 2012, 2012, 2012, 2012, 2012, 2013, 2013, 2013, 2013, 2014,‚Ä¶\n$ location   <chr> \"Dourados\", \"Palotina\", \"Londrina\", \"Planaltina\", \"Itaber√°\"‚Ä¶\n$ state      <chr> \"MS\", \"PR\", \"PR\", \"DF\", \"SP\", \"MS\", \"MG\", \"DF\", \"SP\", \"MG\",‚Ä¶\n$ latitude   <dbl> -22.27516, -24.35483, -23.35916, -15.60387, -24.06832, -22.‚Ä¶\n$ longitude  <dbl> -54.81640, -53.75794, -51.16476, -47.71381, -49.15575, -54.‚Ä¶\n$ heading    <chr> \"10-05-2012\", \"09-06-2012\", \"01-06-2012\", \"03-05-2012\", \"15‚Ä¶\n$ inc_mean   <dbl> 93.30, 40.50, 100.00, 35.50, 7.71, 48.70, 22.00, 46.50, 68.‚Ä¶\n$ index_mean <dbl> 68.65, 11.73, 92.86, 6.36, 0.35, 9.17, 2.91, 10.41, 41.86, ‚Ä¶\n$ yld_mean   <dbl> 1097.00, 1219.38, 495.12, 1747.44, 2148.31, 506.00, 1562.75‚Ä¶\n```\n\n\n:::\n:::\n\n\n\n\n\nWe can note that the heading date, which will be used as reference date in our analysis, is not defined as date object, which needs correction.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntrials$heading = as.Date(trials$heading, format = \"%d-%m-%Y\")\nglimpse(trials$heading)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n Date[1:143], format: \"2012-05-10\" \"2012-06-09\" \"2012-06-01\" \"2012-05-03\" \"2012-04-15\" ...\n```\n\n\n:::\n:::\n\n\n\n\n\nThe weather data for our analysis will be downloaded from NASA POWER. Because we have multiple trials with different heading dates, a wrapper function for the `get_power()` function from the {nasapower} package was created, included in {r4pde}, and named `get_nasapower()`. This function allows for the download of data over a period \"around\" the key date, which can be defined by the user. In our case, we will download data from 28 days before and after the heading date.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nweather_data <- get_nasapower(\n  data = trials,\n  days_around = 28,\n  date_col = \"heading\"\n)\n\n# save the data for faster rendering\nwrite_csv(weather_data, \"data/weather_windowpane.csv\")\n```\n:::\n\n\n\n\n\nNow we can see the weather data and join the two dataframes.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# read the data\nweather_data <- read_csv(\"data/weather_windowpane.csv\")\n\nglimpse(weather_data)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 8,151\nColumns: 14\n$ LON         <dbl> -54.8164, -54.8164, -54.8164, -54.8164, -54.8164, -54.8164‚Ä¶\n$ LAT         <dbl> -22.27516, -22.27516, -22.27516, -22.27516, -22.27516, -22‚Ä¶\n$ YEAR        <dbl> 2012, 2012, 2012, 2012, 2012, 2012, 2012, 2012, 2012, 2012‚Ä¶\n$ MM          <dbl> 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 5‚Ä¶\n$ DD          <dbl> 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26‚Ä¶\n$ DOY         <dbl> 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114‚Ä¶\n$ YYYYMMDD    <date> 2012-04-12, 2012-04-13, 2012-04-14, 2012-04-15, 2012-04-1‚Ä¶\n$ T2M         <dbl> 24.31, 25.83, 24.99, 24.15, 22.72, 23.33, 23.76, 24.83, 24‚Ä¶\n$ RH2M        <dbl> 83.69, 77.62, 81.69, 82.69, 74.62, 74.44, 70.19, 67.75, 77‚Ä¶\n$ PRECTOTCORR <dbl> 0.02, 1.13, 11.00, 0.06, 0.00, 0.04, 0.00, 0.03, 24.08, 20‚Ä¶\n$ T2M_MAX     <dbl> 28.61, 31.01, 30.01, 29.43, 30.33, 30.69, 31.51, 32.49, 30‚Ä¶\n$ T2M_MIN     <dbl> 20.82, 20.43, 21.11, 19.04, 16.31, 17.37, 17.15, 17.69, 20‚Ä¶\n$ T2MDEW      <dbl> 21.19, 21.23, 21.38, 20.75, 17.47, 18.01, 17.29, 17.85, 20‚Ä¶\n$ study       <dbl> 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1‚Ä¶\n```\n\n\n:::\n\n```{.r .cell-code}\n# apply a full join\ntrials_weather <- full_join(trials, weather_data) \n```\n:::\n\n\n\n\n\nWe are now ready to use the `windowpane` function to create the new variables. In the function, there are a few arguments. Note two date variables, the `end_date` which should be our reference for sliding the windows and the `date_col` which is the date for each day in the time series. The `summary_type` is the statistics to calculate. The `direction` is whether the sliding windows will be backward, forward or both directions relative to the end date. Finally, the `group_by` is the index variable for the study or trial.\n\nLet's create the new variables based on the mean daily temperature (T2M). Each new variable will be the mean value over each of the four window lengths (7, 14, 21 and 28) defined in `window_length` argument. We will create only variables at an earlier time relative to heading date and for this we use \"backward\" in `direction` argument.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwp <- windowpane(\n  data = trials_weather,\n  end_date_col = heading,\n  date_col = YYYYMMDD,\n  variable = T2M,  \n  summary_type = \"mean\",\n  threshold = NULL,\n  window_lengths = c(7, 14, 21, 28),\n  direction = \"backward\",\n  group_by_cols = \"study\", \n)\n\n# Check the intuitive names of the variables\nhead(wp)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 6 √ó 48\n  `length7_T2M_mean_0_-6` `length7_T2M_mean_-1_-7` `length7_T2M_mean_-2_-8`\n                    <dbl>                    <dbl>                    <dbl>\n1                    20.1                     19.4                     18.4\n2                    12.7                     13.7                     15.1\n3                    19.4                     19.1                     18.6\n4                    21.8                     22.1                     22.3\n5                    22.5                     22.5                     22.8\n6                    20.8                     21.0                     21.1\n# ‚Ñπ 45 more variables: `length7_T2M_mean_-3_-9` <dbl>,\n#   `length7_T2M_mean_-4_-10` <dbl>, `length7_T2M_mean_-5_-11` <dbl>,\n#   `length7_T2M_mean_-6_-12` <dbl>, `length7_T2M_mean_-7_-13` <dbl>,\n#   `length7_T2M_mean_-8_-14` <dbl>, `length7_T2M_mean_-9_-15` <dbl>,\n#   `length7_T2M_mean_-10_-16` <dbl>, `length7_T2M_mean_-11_-17` <dbl>,\n#   `length7_T2M_mean_-12_-18` <dbl>, `length7_T2M_mean_-13_-19` <dbl>,\n#   `length7_T2M_mean_-14_-20` <dbl>, `length7_T2M_mean_-15_-21` <dbl>, ‚Ä¶\n```\n\n\n:::\n:::\n\n\n\n\n\nTo automate the creation of new variables based on multiple weather variables, we can use the `map()` function of {purrr}. Let's continue summarizing the mean value for three other variables of temperature and relative humidity.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nvariables <- c(\"T2M_MIN\", \"T2M_MAX\", \"RH2M\")  # Add more variables as needed\n\n# Apply the function to each variable and combine the results\nwp1 <- map(variables, function(var) {\n  windowpane(\n    data = trials_weather,\n    end_date_col = heading,\n    date_col = YYYYMMDD,\n    variable = !!sym(var),   # Example variable\n    summary_type = \"mean\",\n    threshold = NULL,\n    window_lengths = c(7, 14, 21, 28),\n    direction = \"backward\",\n    group_by_cols = \"study\", # Grouping by 'study'\n  )\n})\n\n# To reduce a list to a dataframe \nwp1_df <- reduce(wp1, left_join, by = c(\"study\", \"heading\"))\n```\n:::\n\n\n\n\n\nFor rainfall, we will summarize the cumulative rainfall within each window using the \"sum\" in the `summary_type` argument.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwp3 <- windowpane(\n    data = trials_weather,\n    end_date_col = heading,\n    date_col = YYYYMMDD,\n    variable = PRECTOTCORR,   # Example variable\n    summary_type = \"sum\",\n    threshold = NULL,\n    window_lengths = c(7, 14, 21, 28),\n    direction = \"backwards\",\n    group_by_cols = \"study\", # Grouping by 'study'\n  )\n\n# Remove the heading and study variables to avoid duplication \nwp3 <- wp3 |> select(-heading, -study)\n```\n:::\n\n\n\n\n\nFinally, we will create a variable based on the count of events below a threshold. For this, we will count the number of days with T2M_MIN lower than 15 degree Celsius. \n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwp4 <- windowpane(\n    data = trials_weather,\n    end_date_col = heading,\n    date_col = YYYYMMDD,\n    variable = T2M_MIN,   # Example variable\n    summary_type = \"below_threshold\",\n    threshold = 15,\n    window_lengths = c(7, 14, 21, 28),\n    direction = \"backward\",\n    group_by_cols = \"study\", # Grouping by 'study'\n  )\n\n# remove to avoid duplication\nwp_4 <- wp4 |> select(-heading, -study)\n```\n:::\n\n\n\n\n\nNow we can join all data frames using `cbind()` function.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwp_all <- cbind(wp1, wp1_df, wp3, wp4)\n\nhead(wp_all)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  length7_T2M_MIN_mean_0_-6 length7_T2M_MIN_mean_-1_-7\n1                 13.858571                   13.26714\n2                  7.831429                    9.08000\n3                 15.524286                   15.10000\n4                 16.705714                   16.99857\n5                 18.464286                   18.39857\n6                 16.345714                   16.46857\n  length7_T2M_MIN_mean_-2_-8 length7_T2M_MIN_mean_-3_-9\n1                   12.22000                   11.06286\n2                   10.84429                   12.71571\n3                   14.72286                   14.13857\n4                   17.62000                   17.79143\n5                   18.20286                   18.07571\n6                   16.59286                   16.65143\n  length7_T2M_MIN_mean_-4_-10 length7_T2M_MIN_mean_-5_-11\n1                    10.23143                    10.05857\n2                    14.44286                    16.10571\n3                    13.48571                    12.90000\n4                    17.74714                    17.49286\n5                    17.90429                    17.58429\n6                    16.07286                    15.08286\n  length7_T2M_MIN_mean_-6_-12 length7_T2M_MIN_mean_-7_-13\n1                    10.48429                    10.83857\n2                    17.24857                    16.72571\n3                    12.85429                    12.64429\n4                    17.05714                    16.51000\n5                    17.21000                    16.67429\n6                    14.61571                    13.75143\n  length7_T2M_MIN_mean_-8_-14 length7_T2M_MIN_mean_-9_-15\n1                    11.84857                    13.70000\n2                    16.32143                    16.20143\n3                    12.35143                    12.01000\n4                    16.28286                    16.30714\n5                    16.13571                    15.77286\n6                    12.30000                    10.92857\n  length7_T2M_MIN_mean_-10_-16 length7_T2M_MIN_mean_-11_-17\n1                    15.117143                     15.86429\n2                    16.064286                     15.60571\n3                    11.925714                     11.96143\n4                    16.382857                     16.41714\n5                    15.411429                     14.33286\n6                     9.907143                     10.11571\n  length7_T2M_MIN_mean_-12_-18 length7_T2M_MIN_mean_-13_-19\n1                     16.24857                     16.56429\n2                     15.07857                     14.33143\n3                     12.20286                     12.39429\n4                     16.59714                     16.62714\n5                     13.91286                     14.43000\n6                     11.30714                     12.55000\n  length7_T2M_MIN_mean_-14_-20 length7_T2M_MIN_mean_-15_-21\n1                     17.39143                     17.41857\n2                     14.02143                     14.07571\n3                     13.29000                     13.92714\n4                     16.90143                     16.89143\n5                     14.87714                     15.22571\n6                     13.79571                     14.94000\n  length7_T2M_MIN_mean_-16_-22 length7_T2M_MIN_mean_-17_-23\n1                     17.18857                     17.36286\n2                     13.87714                     13.44286\n3                     14.02571                     14.34000\n4                     16.96571                     17.01714\n5                     15.43286                     15.93000\n6                     16.12143                     16.86714\n  length7_T2M_MIN_mean_-18_-24 length7_T2M_MIN_mean_-19_-25\n1                     17.72429                     18.22143\n2                     13.49429                     13.53571\n3                     14.48429                     14.28143\n4                     16.99429                     17.19429\n5                     17.01143                     17.30286\n6                     17.37571                     17.28286\n  length7_T2M_MIN_mean_-20_-26 length7_T2M_MIN_mean_-21_-27\n1                     18.48857                     18.44286\n2                     13.28286                     13.16571\n3                     14.00714                     13.59429\n4                     17.77000                     18.01571\n5                     16.81429                     16.40429\n6                     17.02000                     16.68714\n  length14_T2M_MIN_mean_0_-13 length14_T2M_MIN_mean_-1_-14\n1                    12.34857                     12.55786\n2                    12.27857                     12.70071\n3                    14.08429                     13.72571\n4                    16.60786                     16.64071\n5                    17.56929                     17.26714\n6                    15.04857                     14.38429\n  length14_T2M_MIN_mean_-2_-15 length14_T2M_MIN_mean_-3_-16\n1                     12.96000                     13.09000\n2                     13.52286                     14.39000\n3                     13.36643                     13.03214\n4                     16.96357                     17.08714\n5                     16.98786                     16.74357\n6                     13.76071                     13.27929\n  length14_T2M_MIN_mean_-4_-17 length14_T2M_MIN_mean_-5_-18\n1                     13.04786                     13.15357\n2                     15.02429                     15.59214\n3                     12.72357                     12.55143\n4                     17.08214                     17.04500\n5                     16.11857                     15.74857\n6                     13.09429                     13.19500\n  length14_T2M_MIN_mean_-6_-19 length14_T2M_MIN_mean_-7_-20\n1                     13.52429                     14.11500\n2                     15.79000                     15.37357\n3                     12.62429                     12.96714\n4                     16.84214                     16.70571\n5                     15.82000                     15.77571\n6                     13.58286                     13.77357\n  length14_T2M_MIN_mean_-8_-21 length14_T2M_MIN_mean_-9_-22\n1                     14.63357                     15.44429\n2                     15.19857                     15.03929\n3                     13.13929                     13.01786\n4                     16.58714                     16.63643\n5                     15.68071                     15.60286\n6                     13.62000                     13.52500\n  length14_T2M_MIN_mean_-10_-23 length14_T2M_MIN_mean_-11_-24\n1                      16.24000                      16.79429\n2                      14.75357                      14.55000\n3                      13.13286                      13.22286\n4                      16.70000                      16.70571\n5                      15.67071                      15.67214\n6                      13.38714                      13.74571\n  length14_T2M_MIN_mean_-12_-25 length14_T2M_MIN_mean_-13_-26\n1                      17.23500                      17.52643\n2                      14.30714                      13.80714\n3                      13.24214                      13.20071\n4                      16.89571                      17.19857\n5                      15.60786                      15.62214\n6                      14.29500                      14.78500\n  length14_T2M_MIN_mean_-14_-27 length21_T2M_MIN_mean_0_-20\n1                      17.91714                    14.02952\n2                      13.59357                    12.85952\n3                      13.44214                    13.81952\n4                      17.45857                    16.70571\n5                      15.64071                    16.67190\n6                      15.24143                    14.63095\n  length21_T2M_MIN_mean_-1_-21 length21_T2M_MIN_mean_-2_-22\n1                     14.17810                     14.36952\n2                     13.15905                     13.64095\n3                     13.79286                     13.58619\n4                     16.72429                     16.96429\n5                     16.58667                     16.46952\n6                     14.56952                     14.54762\n  length21_T2M_MIN_mean_-3_-23 length21_T2M_MIN_mean_-4_-24\n1                     14.51429                     14.60667\n2                     14.07429                     14.51429\n3                     13.46810                     13.31048\n4                     17.06381                     17.05286\n5                     16.47238                     16.41619\n6                     14.47524                     14.52143\n  length21_T2M_MIN_mean_-5_-25 length21_T2M_MIN_mean_-6_-26\n1                     14.84286                     15.17905\n2                     14.90667                     14.95429\n3                     13.12810                     13.08524\n4                     17.09476                     17.15143\n5                     16.26667                     16.15143\n6                     14.55762                     14.72857\n  length21_T2M_MIN_mean_-7_-27 length28_T2M_MIN_mean_0_-27 study    heading\n1                     15.55762                    15.13286     1 2012-05-10\n2                     14.63762                    12.93607     2 2012-06-09\n3                     13.17619                    13.76321     3 2012-06-01\n4                     17.14238                    17.03321     4 2012-05-03\n5                     15.98524                    16.60500     5 2012-04-15\n6                     14.74476                    15.14500     6 2013-05-22\n  length7_T2M_MAX_mean_0_-6 length7_T2M_MAX_mean_-1_-7\n1                  27.48857                   26.86571\n2                  18.16714                   19.01714\n3                  24.40429                   24.05714\n4                  27.89000                   28.01000\n5                  28.67286                   28.76429\n6                  25.99571                   26.31714\n  length7_T2M_MAX_mean_-2_-8 length7_T2M_MAX_mean_-3_-9\n1                   26.05571                   24.86286\n2                   20.02714                   21.64143\n3                   23.33429                   22.92571\n4                   27.75571                   27.65429\n5                   29.32714                   29.68857\n6                   26.40429                   26.55571\n  length7_T2M_MAX_mean_-4_-10 length7_T2M_MAX_mean_-5_-11\n1                    23.76429                    22.84000\n2                    23.15143                    25.06714\n3                    22.47286                    22.38000\n4                    27.62143                    27.53143\n5                    29.86143                    30.33286\n6                    26.77857                    27.09429\n  length7_T2M_MAX_mean_-6_-12 length7_T2M_MAX_mean_-7_-13\n1                    22.29143                    21.90857\n2                    26.05143                    25.89857\n3                    22.66143                    22.81857\n4                    27.43857                    27.26857\n5                    30.89714                    31.23000\n6                    27.22714                    27.66000\n  length7_T2M_MAX_mean_-8_-14 length7_T2M_MAX_mean_-9_-15\n1                    22.27143                    23.10286\n2                    25.38857                    25.02000\n3                    22.92571                    23.34714\n4                    27.35000                    27.57143\n5                    30.97857                    30.50286\n6                    26.83571                    26.02429\n  length7_T2M_MAX_mean_-10_-16 length7_T2M_MAX_mean_-11_-17\n1                     24.40143                     25.60000\n2                     24.59000                     23.85714\n3                     23.28000                     23.12429\n4                     27.84286                     27.90429\n5                     30.08429                     29.55000\n6                     25.30857                     24.64714\n  length7_T2M_MAX_mean_-12_-18 length7_T2M_MAX_mean_-13_-19\n1                     26.43143                     26.81429\n2                     23.63571                     23.43714\n3                     22.92429                     22.74000\n4                     27.94286                     27.91000\n5                     28.92857                     28.19000\n6                     24.91714                     25.54714\n  length7_T2M_MAX_mean_-14_-20 length7_T2M_MAX_mean_-15_-21\n1                     27.76429                     28.57000\n2                     23.58429                     23.81429\n3                     23.13429                     23.56857\n4                     27.90429                     27.79000\n5                     28.49571                     28.61000\n6                     26.37000                     27.46143\n  length7_T2M_MAX_mean_-16_-22 length7_T2M_MAX_mean_-17_-23\n1                     29.07429                     29.49714\n2                     24.15143                     24.27000\n3                     24.09571                     24.40429\n4                     27.79000                     27.30143\n5                     28.66571                     28.19714\n6                     28.63571                     29.67857\n  length7_T2M_MAX_mean_-18_-24 length7_T2M_MAX_mean_-19_-25\n1                     29.89429                     30.26571\n2                     24.55429                     24.25286\n3                     24.88143                     25.18000\n4                     26.88857                     26.45714\n5                     28.60429                     29.32857\n6                     30.14286                     30.07000\n  length7_T2M_MAX_mean_-20_-26 length7_T2M_MAX_mean_-21_-27\n1                     30.71714                     30.78143\n2                     24.04714                     23.30857\n3                     25.31571                     25.31286\n4                     26.25286                     26.50857\n5                     30.08571                     29.84429\n6                     29.79714                     29.19714\n  length14_T2M_MAX_mean_0_-13 length14_T2M_MAX_mean_-1_-14\n1                    24.69857                     24.56857\n2                    22.03286                     22.20286\n3                    23.61143                     23.49143\n4                    27.57929                     27.68000\n5                    29.95143                     29.87143\n6                    26.82786                     26.57643\n  length14_T2M_MAX_mean_-2_-15 length14_T2M_MAX_mean_-3_-16\n1                     24.57929                     24.63214\n2                     22.52357                     23.11571\n3                     23.34071                     23.10286\n4                     27.66357                     27.74857\n5                     29.91500                     29.88643\n6                     26.21429                     25.93214\n  length14_T2M_MAX_mean_-4_-17 length14_T2M_MAX_mean_-5_-18\n1                     24.68214                     24.63571\n2                     23.50429                     24.35143\n3                     22.79857                     22.65214\n4                     27.76286                     27.73714\n5                     29.70571                     29.63071\n6                     25.71286                     26.00571\n  length14_T2M_MAX_mean_-6_-19 length14_T2M_MAX_mean_-7_-20\n1                     24.55286                     24.83643\n2                     24.74429                     24.74143\n3                     22.70071                     22.97643\n4                     27.67429                     27.58643\n5                     29.54357                     29.86286\n6                     26.38714                     27.01500\n  length14_T2M_MAX_mean_-8_-21 length14_T2M_MAX_mean_-9_-22\n1                     25.42071                     26.08857\n2                     24.60143                     24.58571\n3                     23.24714                     23.72143\n4                     27.57000                     27.68071\n5                     29.79429                     29.58429\n6                     27.14857                     27.33000\n  length14_T2M_MAX_mean_-10_-23 length14_T2M_MAX_mean_-11_-24\n1                      26.94929                      27.74714\n2                      24.43000                      24.20571\n3                      23.84214                      24.00286\n4                      27.57214                      27.39643\n5                      29.14071                      29.07714\n6                      27.49357                      27.39500\n  length14_T2M_MAX_mean_-12_-25 length14_T2M_MAX_mean_-13_-26\n1                      28.34857                      28.76571\n2                      23.94429                      23.74214\n3                      24.05214                      24.02786\n4                      27.20000                      27.08143\n5                      29.12857                      29.13786\n6                      27.49357                      27.67214\n  length14_T2M_MAX_mean_-14_-27 length21_T2M_MAX_mean_0_-20\n1                      29.27286                    25.72048\n2                      23.44643                    22.55000\n3                      24.22357                    23.45238\n4                      27.20643                    27.68762\n5                      29.17000                    29.46619\n6                      27.78357                    26.67524\n  length21_T2M_MAX_mean_-1_-21 length21_T2M_MAX_mean_-2_-22\n1                     25.90238                     26.07762\n2                     22.74000                     23.06619\n3                     23.51714                     23.59238\n4                     27.71667                     27.70571\n5                     29.45095                     29.49857\n6                     26.87143                     27.02143\n  length21_T2M_MAX_mean_-3_-23 length21_T2M_MAX_mean_-4_-24\n1                     26.25381                     26.41952\n2                     23.50048                     23.85429\n3                     23.53667                     23.49286\n4                     27.59952                     27.47143\n5                     29.32333                     29.33857\n6                     27.18095                     27.18952\n  length21_T2M_MAX_mean_-5_-25 length21_T2M_MAX_mean_-6_-26\n1                     26.51238                     26.60762\n2                     24.31857                     24.51190\n3                     23.49476                     23.57238\n4                     27.31048                     27.20048\n5                     29.53000                     29.72429\n6                     27.36048                     27.52381\n  length21_T2M_MAX_mean_-7_-27 length28_T2M_MAX_mean_0_-27 study    heading\n1                     26.81810                    26.98571     1 2012-05-10\n2                     24.26381                    22.73964     2 2012-06-09\n3                     23.75524                    23.91750     3 2012-06-01\n4                     27.22714                    27.39286     4 2012-05-03\n5                     29.85667                    29.56071     5 2012-04-15\n6                     27.74238                    27.30571     6 2013-05-22\n  length7_RH2M_mean_0_-6 length7_RH2M_mean_-1_-7 length7_RH2M_mean_-2_-8\n1               76.33857                77.95571                78.35714\n2               84.78571                85.58000                85.35714\n3               86.92714                86.81857                86.82714\n4               76.49857                76.62429                78.00000\n5               81.76857                81.81286                79.34000\n6               85.73286                85.59000                85.84857\n  length7_RH2M_mean_-3_-9 length7_RH2M_mean_-4_-10 length7_RH2M_mean_-5_-11\n1                77.92857                 77.90143                 78.71429\n2                87.48286                 88.69714                 88.84857\n3                86.10429                 85.02429                 82.89143\n4                78.78571                 80.32143                 80.00000\n5                78.10714                 76.92857                 74.55429\n6                85.83000                 84.32143                 82.22286\n  length7_RH2M_mean_-6_-12 length7_RH2M_mean_-7_-13 length7_RH2M_mean_-8_-14\n1                 80.24000                 80.41000                 81.54429\n2                 88.94714                 88.99143                 87.75143\n3                 81.32000                 80.91000                 79.56286\n4                 78.22286                 77.30286                 77.27571\n5                 72.18714                 70.95571                 70.07143\n6                 80.99143                 78.54429                 77.09857\n  length7_RH2M_mean_-9_-15 length7_RH2M_mean_-10_-16 length7_RH2M_mean_-11_-17\n1                 82.99143                  83.76857                  84.09143\n2                 88.45571                  89.09000                  88.34000\n3                 77.78571                  77.92857                  78.29429\n4                 77.18571                  76.46143                  76.23000\n5                 70.91143                  71.47429                  71.68857\n6                 75.42857                  73.71429                  76.00000\n  length7_RH2M_mean_-12_-18 length7_RH2M_mean_-13_-19 length7_RH2M_mean_-14_-20\n1                  83.34143                  83.17286                  82.85000\n2                  86.48286                  84.45571                  82.39429\n3                  79.37429                  80.95571                  82.25000\n4                  75.51571                  75.95429                  76.23143\n5                  72.00000                  74.95571                  75.21429\n6                  77.32143                  78.29429                  78.83857\n  length7_RH2M_mean_-15_-21 length7_RH2M_mean_-16_-22 length7_RH2M_mean_-17_-23\n1                  79.68857                  77.37571                  76.64429\n2                  81.32286                  79.39429                  77.16143\n3                  82.48143                  81.23143                  80.47286\n4                  76.67857                  76.61571                  78.18714\n5                  75.63429                  75.82143                  77.11571\n6                  78.85571                  78.99000                  79.36571\n  length7_RH2M_mean_-18_-24 length7_RH2M_mean_-19_-25 length7_RH2M_mean_-20_-26\n1                  75.96429                  76.53571                  75.50000\n2                  76.23286                  77.12571                  78.38429\n3                  80.09857                  79.42857                  77.93714\n4                  79.58000                  82.24143                  84.06143\n5                  77.34714                  76.09714                  72.85571\n6                  78.20429                  78.02571                  78.07857\n  length7_RH2M_mean_-21_-27 length14_RH2M_mean_0_-13 length14_RH2M_mean_-1_-14\n1                  75.57143                 78.37429                  79.75000\n2                  78.21429                 86.88857                  86.66571\n3                  76.40143                 83.91857                  83.19071\n4                  84.33000                 76.90071                  76.95000\n5                  72.57000                 76.36214                  75.94214\n6                  78.45429                 82.13857                  81.34429\n  length14_RH2M_mean_-2_-15 length14_RH2M_mean_-3_-16 length14_RH2M_mean_-4_-17\n1                  80.67429                  80.84857                  80.99643\n2                  86.90643                  88.28643                  88.51857\n3                  82.30643                  82.01643                  81.65929\n4                  77.59286                  77.62357                  78.27571\n5                  75.12571                  74.79071                  74.30857\n6                  80.63857                  79.77214                  80.16071\n  length14_RH2M_mean_-5_-18 length14_RH2M_mean_-6_-19 length14_RH2M_mean_-7_-20\n1                  81.02786                  81.70643                  81.63000\n2                  87.66571                  86.70143                  85.69286\n3                  81.13286                  81.13786                  81.58000\n4                  77.75786                  77.08857                  76.76714\n5                  73.27714                  73.57143                  73.08500\n6                  79.77214                  79.64286                  78.69143\n  length14_RH2M_mean_-8_-21 length14_RH2M_mean_-9_-22\n1                  80.61643                  80.18357\n2                  84.53714                  83.92500\n3                  81.02214                  79.50857\n4                  76.97714                  76.90071\n5                  72.85286                  73.36643\n6                  77.97714                  77.20929\n  length14_RH2M_mean_-10_-23 length14_RH2M_mean_-11_-24\n1                   80.20643                   80.02786\n2                   83.12571                   82.28643\n3                   79.20071                   79.19643\n4                   77.32429                   77.90500\n5                   74.29500                   74.51786\n6                   76.54000                   77.10214\n  length14_RH2M_mean_-12_-25 length14_RH2M_mean_-13_-26\n1                   79.93857                   79.33643\n2                   81.80429                   81.42000\n3                   79.40143                   79.44643\n4                   78.87857                   80.00786\n5                   74.04857                   73.90571\n6                   77.67357                   78.18643\n  length14_RH2M_mean_-14_-27 length21_RH2M_mean_0_-20 length21_RH2M_mean_-1_-21\n1                   79.21071                 79.86619                  79.72952\n2                   80.30429                 85.39048                  84.88476\n3                   79.32571                 83.36238                  82.95429\n4                   80.28071                 76.67762                  76.85952\n5                   73.89214                 75.97952                  75.83952\n6                   78.64643                 81.03857                  80.51476\n  length21_RH2M_mean_-2_-22 length21_RH2M_mean_-3_-23 length21_RH2M_mean_-4_-24\n1                  79.57476                  79.44714                  79.31905\n2                  84.40238                  84.57810                  84.42333\n3                  81.94810                  81.50190                  81.13905\n4                  77.26714                  77.81143                  78.71048\n5                  75.35762                  75.56571                  75.32143\n6                  80.08905                  79.63667                  79.50857\n  length21_RH2M_mean_-5_-25 length21_RH2M_mean_-6_-26 length21_RH2M_mean_-7_-27\n1                  79.53048                  79.63762                  79.61048\n2                  84.15238                  83.92905                  83.20000\n3                  80.56476                  80.07095                  79.85381\n4                  79.25238                  79.41286                  79.28810\n5                  74.21714                  73.33286                  72.91333\n6                  79.19000                  79.12143                  78.61238\n  length28_RH2M_mean_0_-27 study    heading length7_T2M_MIN_mean_0_-6\n1                 78.79250     1 2012-05-10                 13.858571\n2                 83.59643     2 2012-06-09                  7.831429\n3                 81.62214     3 2012-06-01                 15.524286\n4                 78.59071     4 2012-05-03                 16.705714\n5                 75.12714     5 2012-04-15                 18.464286\n6                 80.39250     6 2013-05-22                 16.345714\n  length7_T2M_MIN_mean_-1_-7 length7_T2M_MIN_mean_-2_-8\n1                   13.26714                   12.22000\n2                    9.08000                   10.84429\n3                   15.10000                   14.72286\n4                   16.99857                   17.62000\n5                   18.39857                   18.20286\n6                   16.46857                   16.59286\n  length7_T2M_MIN_mean_-3_-9 length7_T2M_MIN_mean_-4_-10\n1                   11.06286                    10.23143\n2                   12.71571                    14.44286\n3                   14.13857                    13.48571\n4                   17.79143                    17.74714\n5                   18.07571                    17.90429\n6                   16.65143                    16.07286\n  length7_T2M_MIN_mean_-5_-11 length7_T2M_MIN_mean_-6_-12\n1                    10.05857                    10.48429\n2                    16.10571                    17.24857\n3                    12.90000                    12.85429\n4                    17.49286                    17.05714\n5                    17.58429                    17.21000\n6                    15.08286                    14.61571\n  length7_T2M_MIN_mean_-7_-13 length7_T2M_MIN_mean_-8_-14\n1                    10.83857                    11.84857\n2                    16.72571                    16.32143\n3                    12.64429                    12.35143\n4                    16.51000                    16.28286\n5                    16.67429                    16.13571\n6                    13.75143                    12.30000\n  length7_T2M_MIN_mean_-9_-15 length7_T2M_MIN_mean_-10_-16\n1                    13.70000                    15.117143\n2                    16.20143                    16.064286\n3                    12.01000                    11.925714\n4                    16.30714                    16.382857\n5                    15.77286                    15.411429\n6                    10.92857                     9.907143\n  length7_T2M_MIN_mean_-11_-17 length7_T2M_MIN_mean_-12_-18\n1                     15.86429                     16.24857\n2                     15.60571                     15.07857\n3                     11.96143                     12.20286\n4                     16.41714                     16.59714\n5                     14.33286                     13.91286\n6                     10.11571                     11.30714\n  length7_T2M_MIN_mean_-13_-19 length7_T2M_MIN_mean_-14_-20\n1                     16.56429                     17.39143\n2                     14.33143                     14.02143\n3                     12.39429                     13.29000\n4                     16.62714                     16.90143\n5                     14.43000                     14.87714\n6                     12.55000                     13.79571\n  length7_T2M_MIN_mean_-15_-21 length7_T2M_MIN_mean_-16_-22\n1                     17.41857                     17.18857\n2                     14.07571                     13.87714\n3                     13.92714                     14.02571\n4                     16.89143                     16.96571\n5                     15.22571                     15.43286\n6                     14.94000                     16.12143\n  length7_T2M_MIN_mean_-17_-23 length7_T2M_MIN_mean_-18_-24\n1                     17.36286                     17.72429\n2                     13.44286                     13.49429\n3                     14.34000                     14.48429\n4                     17.01714                     16.99429\n5                     15.93000                     17.01143\n6                     16.86714                     17.37571\n  length7_T2M_MIN_mean_-19_-25 length7_T2M_MIN_mean_-20_-26\n1                     18.22143                     18.48857\n2                     13.53571                     13.28286\n3                     14.28143                     14.00714\n4                     17.19429                     17.77000\n5                     17.30286                     16.81429\n6                     17.28286                     17.02000\n  length7_T2M_MIN_mean_-21_-27 length14_T2M_MIN_mean_0_-13\n1                     18.44286                    12.34857\n2                     13.16571                    12.27857\n3                     13.59429                    14.08429\n4                     18.01571                    16.60786\n5                     16.40429                    17.56929\n6                     16.68714                    15.04857\n  length14_T2M_MIN_mean_-1_-14 length14_T2M_MIN_mean_-2_-15\n1                     12.55786                     12.96000\n2                     12.70071                     13.52286\n3                     13.72571                     13.36643\n4                     16.64071                     16.96357\n5                     17.26714                     16.98786\n6                     14.38429                     13.76071\n  length14_T2M_MIN_mean_-3_-16 length14_T2M_MIN_mean_-4_-17\n1                     13.09000                     13.04786\n2                     14.39000                     15.02429\n3                     13.03214                     12.72357\n4                     17.08714                     17.08214\n5                     16.74357                     16.11857\n6                     13.27929                     13.09429\n  length14_T2M_MIN_mean_-5_-18 length14_T2M_MIN_mean_-6_-19\n1                     13.15357                     13.52429\n2                     15.59214                     15.79000\n3                     12.55143                     12.62429\n4                     17.04500                     16.84214\n5                     15.74857                     15.82000\n6                     13.19500                     13.58286\n  length14_T2M_MIN_mean_-7_-20 length14_T2M_MIN_mean_-8_-21\n1                     14.11500                     14.63357\n2                     15.37357                     15.19857\n3                     12.96714                     13.13929\n4                     16.70571                     16.58714\n5                     15.77571                     15.68071\n6                     13.77357                     13.62000\n  length14_T2M_MIN_mean_-9_-22 length14_T2M_MIN_mean_-10_-23\n1                     15.44429                      16.24000\n2                     15.03929                      14.75357\n3                     13.01786                      13.13286\n4                     16.63643                      16.70000\n5                     15.60286                      15.67071\n6                     13.52500                      13.38714\n  length14_T2M_MIN_mean_-11_-24 length14_T2M_MIN_mean_-12_-25\n1                      16.79429                      17.23500\n2                      14.55000                      14.30714\n3                      13.22286                      13.24214\n4                      16.70571                      16.89571\n5                      15.67214                      15.60786\n6                      13.74571                      14.29500\n  length14_T2M_MIN_mean_-13_-26 length14_T2M_MIN_mean_-14_-27\n1                      17.52643                      17.91714\n2                      13.80714                      13.59357\n3                      13.20071                      13.44214\n4                      17.19857                      17.45857\n5                      15.62214                      15.64071\n6                      14.78500                      15.24143\n  length21_T2M_MIN_mean_0_-20 length21_T2M_MIN_mean_-1_-21\n1                    14.02952                     14.17810\n2                    12.85952                     13.15905\n3                    13.81952                     13.79286\n4                    16.70571                     16.72429\n5                    16.67190                     16.58667\n6                    14.63095                     14.56952\n  length21_T2M_MIN_mean_-2_-22 length21_T2M_MIN_mean_-3_-23\n1                     14.36952                     14.51429\n2                     13.64095                     14.07429\n3                     13.58619                     13.46810\n4                     16.96429                     17.06381\n5                     16.46952                     16.47238\n6                     14.54762                     14.47524\n  length21_T2M_MIN_mean_-4_-24 length21_T2M_MIN_mean_-5_-25\n1                     14.60667                     14.84286\n2                     14.51429                     14.90667\n3                     13.31048                     13.12810\n4                     17.05286                     17.09476\n5                     16.41619                     16.26667\n6                     14.52143                     14.55762\n  length21_T2M_MIN_mean_-6_-26 length21_T2M_MIN_mean_-7_-27\n1                     15.17905                     15.55762\n2                     14.95429                     14.63762\n3                     13.08524                     13.17619\n4                     17.15143                     17.14238\n5                     16.15143                     15.98524\n6                     14.72857                     14.74476\n  length28_T2M_MIN_mean_0_-27 study    heading length7_T2M_MAX_mean_0_-6\n1                    15.13286     1 2012-05-10                  27.48857\n2                    12.93607     2 2012-06-09                  18.16714\n3                    13.76321     3 2012-06-01                  24.40429\n4                    17.03321     4 2012-05-03                  27.89000\n5                    16.60500     5 2012-04-15                  28.67286\n6                    15.14500     6 2013-05-22                  25.99571\n  length7_T2M_MAX_mean_-1_-7 length7_T2M_MAX_mean_-2_-8\n1                   26.86571                   26.05571\n2                   19.01714                   20.02714\n3                   24.05714                   23.33429\n4                   28.01000                   27.75571\n5                   28.76429                   29.32714\n6                   26.31714                   26.40429\n  length7_T2M_MAX_mean_-3_-9 length7_T2M_MAX_mean_-4_-10\n1                   24.86286                    23.76429\n2                   21.64143                    23.15143\n3                   22.92571                    22.47286\n4                   27.65429                    27.62143\n5                   29.68857                    29.86143\n6                   26.55571                    26.77857\n  length7_T2M_MAX_mean_-5_-11 length7_T2M_MAX_mean_-6_-12\n1                    22.84000                    22.29143\n2                    25.06714                    26.05143\n3                    22.38000                    22.66143\n4                    27.53143                    27.43857\n5                    30.33286                    30.89714\n6                    27.09429                    27.22714\n  length7_T2M_MAX_mean_-7_-13 length7_T2M_MAX_mean_-8_-14\n1                    21.90857                    22.27143\n2                    25.89857                    25.38857\n3                    22.81857                    22.92571\n4                    27.26857                    27.35000\n5                    31.23000                    30.97857\n6                    27.66000                    26.83571\n  length7_T2M_MAX_mean_-9_-15 length7_T2M_MAX_mean_-10_-16\n1                    23.10286                     24.40143\n2                    25.02000                     24.59000\n3                    23.34714                     23.28000\n4                    27.57143                     27.84286\n5                    30.50286                     30.08429\n6                    26.02429                     25.30857\n  length7_T2M_MAX_mean_-11_-17 length7_T2M_MAX_mean_-12_-18\n1                     25.60000                     26.43143\n2                     23.85714                     23.63571\n3                     23.12429                     22.92429\n4                     27.90429                     27.94286\n5                     29.55000                     28.92857\n6                     24.64714                     24.91714\n  length7_T2M_MAX_mean_-13_-19 length7_T2M_MAX_mean_-14_-20\n1                     26.81429                     27.76429\n2                     23.43714                     23.58429\n3                     22.74000                     23.13429\n4                     27.91000                     27.90429\n5                     28.19000                     28.49571\n6                     25.54714                     26.37000\n  length7_T2M_MAX_mean_-15_-21 length7_T2M_MAX_mean_-16_-22\n1                     28.57000                     29.07429\n2                     23.81429                     24.15143\n3                     23.56857                     24.09571\n4                     27.79000                     27.79000\n5                     28.61000                     28.66571\n6                     27.46143                     28.63571\n  length7_T2M_MAX_mean_-17_-23 length7_T2M_MAX_mean_-18_-24\n1                     29.49714                     29.89429\n2                     24.27000                     24.55429\n3                     24.40429                     24.88143\n4                     27.30143                     26.88857\n5                     28.19714                     28.60429\n6                     29.67857                     30.14286\n  length7_T2M_MAX_mean_-19_-25 length7_T2M_MAX_mean_-20_-26\n1                     30.26571                     30.71714\n2                     24.25286                     24.04714\n3                     25.18000                     25.31571\n4                     26.45714                     26.25286\n5                     29.32857                     30.08571\n6                     30.07000                     29.79714\n  length7_T2M_MAX_mean_-21_-27 length14_T2M_MAX_mean_0_-13\n1                     30.78143                    24.69857\n2                     23.30857                    22.03286\n3                     25.31286                    23.61143\n4                     26.50857                    27.57929\n5                     29.84429                    29.95143\n6                     29.19714                    26.82786\n  length14_T2M_MAX_mean_-1_-14 length14_T2M_MAX_mean_-2_-15\n1                     24.56857                     24.57929\n2                     22.20286                     22.52357\n3                     23.49143                     23.34071\n4                     27.68000                     27.66357\n5                     29.87143                     29.91500\n6                     26.57643                     26.21429\n  length14_T2M_MAX_mean_-3_-16 length14_T2M_MAX_mean_-4_-17\n1                     24.63214                     24.68214\n2                     23.11571                     23.50429\n3                     23.10286                     22.79857\n4                     27.74857                     27.76286\n5                     29.88643                     29.70571\n6                     25.93214                     25.71286\n  length14_T2M_MAX_mean_-5_-18 length14_T2M_MAX_mean_-6_-19\n1                     24.63571                     24.55286\n2                     24.35143                     24.74429\n3                     22.65214                     22.70071\n4                     27.73714                     27.67429\n5                     29.63071                     29.54357\n6                     26.00571                     26.38714\n  length14_T2M_MAX_mean_-7_-20 length14_T2M_MAX_mean_-8_-21\n1                     24.83643                     25.42071\n2                     24.74143                     24.60143\n3                     22.97643                     23.24714\n4                     27.58643                     27.57000\n5                     29.86286                     29.79429\n6                     27.01500                     27.14857\n  length14_T2M_MAX_mean_-9_-22 length14_T2M_MAX_mean_-10_-23\n1                     26.08857                      26.94929\n2                     24.58571                      24.43000\n3                     23.72143                      23.84214\n4                     27.68071                      27.57214\n5                     29.58429                      29.14071\n6                     27.33000                      27.49357\n  length14_T2M_MAX_mean_-11_-24 length14_T2M_MAX_mean_-12_-25\n1                      27.74714                      28.34857\n2                      24.20571                      23.94429\n3                      24.00286                      24.05214\n4                      27.39643                      27.20000\n5                      29.07714                      29.12857\n6                      27.39500                      27.49357\n  length14_T2M_MAX_mean_-13_-26 length14_T2M_MAX_mean_-14_-27\n1                      28.76571                      29.27286\n2                      23.74214                      23.44643\n3                      24.02786                      24.22357\n4                      27.08143                      27.20643\n5                      29.13786                      29.17000\n6                      27.67214                      27.78357\n  length21_T2M_MAX_mean_0_-20 length21_T2M_MAX_mean_-1_-21\n1                    25.72048                     25.90238\n2                    22.55000                     22.74000\n3                    23.45238                     23.51714\n4                    27.68762                     27.71667\n5                    29.46619                     29.45095\n6                    26.67524                     26.87143\n  length21_T2M_MAX_mean_-2_-22 length21_T2M_MAX_mean_-3_-23\n1                     26.07762                     26.25381\n2                     23.06619                     23.50048\n3                     23.59238                     23.53667\n4                     27.70571                     27.59952\n5                     29.49857                     29.32333\n6                     27.02143                     27.18095\n  length21_T2M_MAX_mean_-4_-24 length21_T2M_MAX_mean_-5_-25\n1                     26.41952                     26.51238\n2                     23.85429                     24.31857\n3                     23.49286                     23.49476\n4                     27.47143                     27.31048\n5                     29.33857                     29.53000\n6                     27.18952                     27.36048\n  length21_T2M_MAX_mean_-6_-26 length21_T2M_MAX_mean_-7_-27\n1                     26.60762                     26.81810\n2                     24.51190                     24.26381\n3                     23.57238                     23.75524\n4                     27.20048                     27.22714\n5                     29.72429                     29.85667\n6                     27.52381                     27.74238\n  length28_T2M_MAX_mean_0_-27 length7_RH2M_mean_0_-6 length7_RH2M_mean_-1_-7\n1                    26.98571               76.33857                77.95571\n2                    22.73964               84.78571                85.58000\n3                    23.91750               86.92714                86.81857\n4                    27.39286               76.49857                76.62429\n5                    29.56071               81.76857                81.81286\n6                    27.30571               85.73286                85.59000\n  length7_RH2M_mean_-2_-8 length7_RH2M_mean_-3_-9 length7_RH2M_mean_-4_-10\n1                78.35714                77.92857                 77.90143\n2                85.35714                87.48286                 88.69714\n3                86.82714                86.10429                 85.02429\n4                78.00000                78.78571                 80.32143\n5                79.34000                78.10714                 76.92857\n6                85.84857                85.83000                 84.32143\n  length7_RH2M_mean_-5_-11 length7_RH2M_mean_-6_-12 length7_RH2M_mean_-7_-13\n1                 78.71429                 80.24000                 80.41000\n2                 88.84857                 88.94714                 88.99143\n3                 82.89143                 81.32000                 80.91000\n4                 80.00000                 78.22286                 77.30286\n5                 74.55429                 72.18714                 70.95571\n6                 82.22286                 80.99143                 78.54429\n  length7_RH2M_mean_-8_-14 length7_RH2M_mean_-9_-15 length7_RH2M_mean_-10_-16\n1                 81.54429                 82.99143                  83.76857\n2                 87.75143                 88.45571                  89.09000\n3                 79.56286                 77.78571                  77.92857\n4                 77.27571                 77.18571                  76.46143\n5                 70.07143                 70.91143                  71.47429\n6                 77.09857                 75.42857                  73.71429\n  length7_RH2M_mean_-11_-17 length7_RH2M_mean_-12_-18 length7_RH2M_mean_-13_-19\n1                  84.09143                  83.34143                  83.17286\n2                  88.34000                  86.48286                  84.45571\n3                  78.29429                  79.37429                  80.95571\n4                  76.23000                  75.51571                  75.95429\n5                  71.68857                  72.00000                  74.95571\n6                  76.00000                  77.32143                  78.29429\n  length7_RH2M_mean_-14_-20 length7_RH2M_mean_-15_-21 length7_RH2M_mean_-16_-22\n1                  82.85000                  79.68857                  77.37571\n2                  82.39429                  81.32286                  79.39429\n3                  82.25000                  82.48143                  81.23143\n4                  76.23143                  76.67857                  76.61571\n5                  75.21429                  75.63429                  75.82143\n6                  78.83857                  78.85571                  78.99000\n  length7_RH2M_mean_-17_-23 length7_RH2M_mean_-18_-24 length7_RH2M_mean_-19_-25\n1                  76.64429                  75.96429                  76.53571\n2                  77.16143                  76.23286                  77.12571\n3                  80.47286                  80.09857                  79.42857\n4                  78.18714                  79.58000                  82.24143\n5                  77.11571                  77.34714                  76.09714\n6                  79.36571                  78.20429                  78.02571\n  length7_RH2M_mean_-20_-26 length7_RH2M_mean_-21_-27 length14_RH2M_mean_0_-13\n1                  75.50000                  75.57143                 78.37429\n2                  78.38429                  78.21429                 86.88857\n3                  77.93714                  76.40143                 83.91857\n4                  84.06143                  84.33000                 76.90071\n5                  72.85571                  72.57000                 76.36214\n6                  78.07857                  78.45429                 82.13857\n  length14_RH2M_mean_-1_-14 length14_RH2M_mean_-2_-15 length14_RH2M_mean_-3_-16\n1                  79.75000                  80.67429                  80.84857\n2                  86.66571                  86.90643                  88.28643\n3                  83.19071                  82.30643                  82.01643\n4                  76.95000                  77.59286                  77.62357\n5                  75.94214                  75.12571                  74.79071\n6                  81.34429                  80.63857                  79.77214\n  length14_RH2M_mean_-4_-17 length14_RH2M_mean_-5_-18 length14_RH2M_mean_-6_-19\n1                  80.99643                  81.02786                  81.70643\n2                  88.51857                  87.66571                  86.70143\n3                  81.65929                  81.13286                  81.13786\n4                  78.27571                  77.75786                  77.08857\n5                  74.30857                  73.27714                  73.57143\n6                  80.16071                  79.77214                  79.64286\n  length14_RH2M_mean_-7_-20 length14_RH2M_mean_-8_-21 length14_RH2M_mean_-9_-22\n1                  81.63000                  80.61643                  80.18357\n2                  85.69286                  84.53714                  83.92500\n3                  81.58000                  81.02214                  79.50857\n4                  76.76714                  76.97714                  76.90071\n5                  73.08500                  72.85286                  73.36643\n6                  78.69143                  77.97714                  77.20929\n  length14_RH2M_mean_-10_-23 length14_RH2M_mean_-11_-24\n1                   80.20643                   80.02786\n2                   83.12571                   82.28643\n3                   79.20071                   79.19643\n4                   77.32429                   77.90500\n5                   74.29500                   74.51786\n6                   76.54000                   77.10214\n  length14_RH2M_mean_-12_-25 length14_RH2M_mean_-13_-26\n1                   79.93857                   79.33643\n2                   81.80429                   81.42000\n3                   79.40143                   79.44643\n4                   78.87857                   80.00786\n5                   74.04857                   73.90571\n6                   77.67357                   78.18643\n  length14_RH2M_mean_-14_-27 length21_RH2M_mean_0_-20 length21_RH2M_mean_-1_-21\n1                   79.21071                 79.86619                  79.72952\n2                   80.30429                 85.39048                  84.88476\n3                   79.32571                 83.36238                  82.95429\n4                   80.28071                 76.67762                  76.85952\n5                   73.89214                 75.97952                  75.83952\n6                   78.64643                 81.03857                  80.51476\n  length21_RH2M_mean_-2_-22 length21_RH2M_mean_-3_-23 length21_RH2M_mean_-4_-24\n1                  79.57476                  79.44714                  79.31905\n2                  84.40238                  84.57810                  84.42333\n3                  81.94810                  81.50190                  81.13905\n4                  77.26714                  77.81143                  78.71048\n5                  75.35762                  75.56571                  75.32143\n6                  80.08905                  79.63667                  79.50857\n  length21_RH2M_mean_-5_-25 length21_RH2M_mean_-6_-26 length21_RH2M_mean_-7_-27\n1                  79.53048                  79.63762                  79.61048\n2                  84.15238                  83.92905                  83.20000\n3                  80.56476                  80.07095                  79.85381\n4                  79.25238                  79.41286                  79.28810\n5                  74.21714                  73.33286                  72.91333\n6                  79.19000                  79.12143                  78.61238\n  length28_RH2M_mean_0_-27 length7_PRECTOTCORR_sum_0_6\n1                 78.79250                       12.25\n2                 83.59643                        5.04\n3                 81.62214                        0.09\n4                 78.59071                       46.38\n5                 75.12714                       16.39\n6                 80.39250                        0.04\n  length7_PRECTOTCORR_sum_1_7 length7_PRECTOTCORR_sum_2_8\n1                       12.26                       35.21\n2                        0.51                        0.59\n3                        7.17                       28.23\n4                       46.38                       26.02\n5                       16.96                       30.79\n6                        0.06                        0.06\n  length7_PRECTOTCORR_sum_3_9 length7_PRECTOTCORR_sum_4_10\n1                       44.71                        44.65\n2                        0.20                         0.20\n3                       28.64                        29.34\n4                       16.82                        15.38\n5                       37.77                        37.81\n6                        0.04                        16.36\n  length7_PRECTOTCORR_sum_5_11 length7_PRECTOTCORR_sum_6_12\n1                        44.68                        45.35\n2                         7.43                        41.34\n3                        29.34                        29.34\n4                         8.18                         8.96\n5                        32.66                        26.82\n6                        34.13                        34.21\n  length7_PRECTOTCORR_sum_7_13 length7_PRECTOTCORR_sum_8_14\n1                        50.38                        65.96\n2                        41.79                        42.13\n3                        29.28                        22.20\n4                         9.71                         9.71\n5                        21.47                        20.95\n6                        34.22                        34.21\n  length7_PRECTOTCORR_sum_9_15 length7_PRECTOTCORR_sum_10_16\n1                        42.32                         44.95\n2                        59.02                         59.92\n3                         1.11                          0.70\n4                         9.71                          7.35\n5                         7.14                          0.16\n6                        34.21                         34.21\n  length7_PRECTOTCORR_sum_11_17 length7_PRECTOTCORR_sum_12_18\n1                         46.37                         46.35\n2                         59.95                         52.90\n3                          0.00                          0.00\n4                          6.85                          6.96\n5                          0.14                          1.04\n6                         17.89                          1.01\n  length7_PRECTOTCORR_sum_13_19 length7_PRECTOTCORR_sum_14_20\n1                         45.65                         40.62\n2                         28.47                         34.70\n3                          0.09                         27.28\n4                          6.61                          8.86\n5                          1.05                          1.03\n6                         32.32                         41.00\n  length7_PRECTOTCORR_sum_15_21 length7_PRECTOTCORR_sum_16_22\n1                         25.04                         24.62\n2                         36.42                         24.46\n3                         32.26                         32.31\n4                          8.88                         10.42\n5                         12.63                         12.86\n6                         42.75                         45.24\n  length7_PRECTOTCORR_sum_17_23 length7_PRECTOTCORR_sum_18_24\n1                          1.51                          0.09\n2                         46.73                         48.21\n3                         44.65                         45.09\n4                         12.15                         12.15\n5                         23.66                         29.12\n6                         45.25                         45.27\n  length7_PRECTOTCORR_sum_19_25 length7_PRECTOTCORR_sum_20_26\n1                          0.08                          0.07\n2                         48.77                         39.29\n3                         45.10                         45.21\n4                         11.12                          6.58\n5                         28.45                         29.10\n6                         45.90                         14.61\n  length7_PRECTOTCORR_sum_21_27 length14_PRECTOTCORR_sum_0_13\n1                          0.07                         62.63\n2                         32.66                         46.83\n3                         42.61                         29.37\n4                          3.32                         56.09\n5                         31.15                         37.86\n6                          9.67                         34.26\n  length14_PRECTOTCORR_sum_1_14 length14_PRECTOTCORR_sum_2_15\n1                         78.22                         77.53\n2                         42.64                         59.61\n3                         29.37                         29.34\n4                         56.09                         35.73\n5                         37.91                         37.93\n6                         34.27                         34.27\n  length14_PRECTOTCORR_sum_3_16 length14_PRECTOTCORR_sum_4_17\n1                         89.66                         91.02\n2                         60.12                         60.15\n3                         29.34                         29.34\n4                         24.17                         22.23\n5                         37.93                         37.95\n6                         34.25                         34.25\n  length14_PRECTOTCORR_sum_5_18 length14_PRECTOTCORR_sum_6_19\n1                         91.03                         91.00\n2                         60.33                         69.81\n3                         29.34                         29.43\n4                         15.14                         15.57\n5                         33.70                         27.87\n6                         35.14                         66.53\n  length14_PRECTOTCORR_sum_7_20 length14_PRECTOTCORR_sum_8_21\n1                         91.00                         91.00\n2                         76.49                         78.55\n3                         56.56                         54.46\n4                         18.57                         18.59\n5                         22.50                         33.58\n6                         75.22                         76.96\n  length14_PRECTOTCORR_sum_9_22 length14_PRECTOTCORR_sum_10_23\n1                         66.94                          46.46\n2                         83.48                         106.65\n3                         33.42                          45.35\n4                         20.13                          19.50\n5                         20.00                          23.82\n6                         79.45                          79.46\n  length14_PRECTOTCORR_sum_11_24 length14_PRECTOTCORR_sum_12_25\n1                          46.46                          46.43\n2                         108.16                         101.67\n3                          45.09                          45.10\n4                          19.00                          18.08\n5                          29.26                          29.49\n6                          63.16                          46.91\n  length14_PRECTOTCORR_sum_13_26 length14_PRECTOTCORR_sum_14_27\n1                          45.72                          40.69\n2                          67.76                          67.36\n3                          45.30                          69.89\n4                          13.19                          12.18\n5                          30.15                          32.18\n6                          46.93                          50.67\n  length21_PRECTOTCORR_sum_0_20 length21_PRECTOTCORR_sum_1_21\n1                        103.25                        103.26\n2                         81.53                         79.06\n3                         56.65                         61.63\n4                         64.95                         64.97\n5                         38.89                         50.54\n6                         75.26                         77.02\n  length21_PRECTOTCORR_sum_2_22 length21_PRECTOTCORR_sum_3_23\n1                        102.15                         91.17\n2                         84.07                        106.85\n3                         61.65                         73.99\n4                         46.15                         36.32\n5                         50.79                         61.59\n6                         79.51                         79.50\n  length21_PRECTOTCORR_sum_4_24 length21_PRECTOTCORR_sum_5_25\n1                         91.11                         91.11\n2                        108.36                        109.10\n3                         74.43                         74.44\n4                         34.38                         26.26\n5                         67.07                         62.15\n6                         79.52                         81.04\n  length21_PRECTOTCORR_sum_6_26 length21_PRECTOTCORR_sum_7_27\n1                         91.07                         91.07\n2                        109.10                        109.15\n3                         74.64                         99.17\n4                         22.15                         21.89\n5                         56.97                         53.65\n6                         81.14                         84.89\n  length28_PRECTOTCORR_sum_0_27 length7_T2M_MIN_below_threshold_0_-6\n1                        103.32                                    7\n2                        114.19                                    6\n3                         99.26                                    2\n4                         68.27                                    1\n5                         70.04                                    0\n6                         84.93                                    2\n  length7_T2M_MIN_below_threshold_-1_-7 length7_T2M_MIN_below_threshold_-2_-8\n1                                     7                                     7\n2                                     5                                     4\n3                                     3                                     4\n4                                     1                                     0\n5                                     0                                     0\n6                                     2                                     2\n  length7_T2M_MIN_below_threshold_-3_-9 length7_T2M_MIN_below_threshold_-4_-10\n1                                     7                                      7\n2                                     3                                      2\n3                                     5                                      6\n4                                     0                                      0\n5                                     0                                      0\n6                                     2                                      3\n  length7_T2M_MIN_below_threshold_-5_-11 length7_T2M_MIN_below_threshold_-6_-12\n1                                      7                                      6\n2                                      1                                      0\n3                                      7                                      7\n4                                      0                                      1\n5                                      0                                      1\n6                                      4                                      4\n  length7_T2M_MIN_below_threshold_-7_-13 length7_T2M_MIN_below_threshold_-8_-14\n1                                      6                                      5\n2                                      1                                      2\n3                                      7                                      7\n4                                      2                                      2\n5                                      2                                      3\n6                                      4                                      5\n  length7_T2M_MIN_below_threshold_-9_-15\n1                                      4\n2                                      3\n3                                      7\n4                                      2\n5                                      3\n6                                      6\n  length7_T2M_MIN_below_threshold_-10_-16\n1                                       3\n2                                       3\n3                                       7\n4                                       2\n5                                       3\n6                                       7\n  length7_T2M_MIN_below_threshold_-11_-17\n1                                       3\n2                                       4\n3                                       7\n4                                       2\n5                                       4\n6                                       6\n  length7_T2M_MIN_below_threshold_-12_-18\n1                                       2\n2                                       5\n3                                       7\n4                                       2\n5                                       5\n6                                       5\n  length7_T2M_MIN_below_threshold_-13_-19\n1                                       2\n2                                       6\n3                                       7\n4                                       2\n5                                       4\n6                                       4\n  length7_T2M_MIN_below_threshold_-14_-20\n1                                       1\n2                                       6\n3                                       6\n4                                       1\n5                                       3\n6                                       3\n  length7_T2M_MIN_below_threshold_-15_-21\n1                                       1\n2                                       6\n3                                       5\n4                                       1\n5                                       2\n6                                       2\n  length7_T2M_MIN_below_threshold_-16_-22\n1                                       1\n2                                       6\n3                                       5\n4                                       1\n5                                       2\n6                                       1\n  length7_T2M_MIN_below_threshold_-17_-23\n1                                       1\n2                                       7\n3                                       5\n4                                       1\n5                                       2\n6                                       0\n  length7_T2M_MIN_below_threshold_-18_-24\n1                                       0\n2                                       7\n3                                       5\n4                                       1\n5                                       1\n6                                       0\n  length7_T2M_MIN_below_threshold_-19_-25\n1                                       0\n2                                       7\n3                                       5\n4                                       1\n5                                       0\n6                                       0\n  length7_T2M_MIN_below_threshold_-20_-26\n1                                       0\n2                                       7\n3                                       5\n4                                       0\n5                                       0\n6                                       0\n  length7_T2M_MIN_below_threshold_-21_-27\n1                                       0\n2                                       7\n3                                       6\n4                                       0\n5                                       1\n6                                       1\n  length14_T2M_MIN_below_threshold_0_-13\n1                                     13\n2                                      7\n3                                      9\n4                                      3\n5                                      2\n6                                      6\n  length14_T2M_MIN_below_threshold_-1_-14\n1                                      12\n2                                       7\n3                                      10\n4                                       3\n5                                       3\n6                                       7\n  length14_T2M_MIN_below_threshold_-2_-15\n1                                      11\n2                                       7\n3                                      11\n4                                       2\n5                                       3\n6                                       8\n  length14_T2M_MIN_below_threshold_-3_-16\n1                                      10\n2                                       6\n3                                      12\n4                                       2\n5                                       3\n6                                       9\n  length14_T2M_MIN_below_threshold_-4_-17\n1                                      10\n2                                       6\n3                                      13\n4                                       2\n5                                       4\n6                                       9\n  length14_T2M_MIN_below_threshold_-5_-18\n1                                       9\n2                                       6\n3                                      14\n4                                       2\n5                                       5\n6                                       9\n  length14_T2M_MIN_below_threshold_-6_-19\n1                                       8\n2                                       6\n3                                      14\n4                                       3\n5                                       5\n6                                       8\n  length14_T2M_MIN_below_threshold_-7_-20\n1                                       7\n2                                       7\n3                                      13\n4                                       3\n5                                       5\n6                                       7\n  length14_T2M_MIN_below_threshold_-8_-21\n1                                       6\n2                                       8\n3                                      12\n4                                       3\n5                                       5\n6                                       7\n  length14_T2M_MIN_below_threshold_-9_-22\n1                                       5\n2                                       9\n3                                      12\n4                                       3\n5                                       5\n6                                       7\n  length14_T2M_MIN_below_threshold_-10_-23\n1                                        4\n2                                       10\n3                                       12\n4                                        3\n5                                        5\n6                                        7\n  length14_T2M_MIN_below_threshold_-11_-24\n1                                        3\n2                                       11\n3                                       12\n4                                        3\n5                                        5\n6                                        6\n  length14_T2M_MIN_below_threshold_-12_-25\n1                                        2\n2                                       12\n3                                       12\n4                                        3\n5                                        5\n6                                        5\n  length14_T2M_MIN_below_threshold_-13_-26\n1                                        2\n2                                       13\n3                                       12\n4                                        2\n5                                        4\n6                                        4\n  length14_T2M_MIN_below_threshold_-14_-27\n1                                        1\n2                                       13\n3                                       12\n4                                        1\n5                                        4\n6                                        4\n  length21_T2M_MIN_below_threshold_0_-20\n1                                     14\n2                                     13\n3                                     15\n4                                      4\n5                                      5\n6                                      9\n  length21_T2M_MIN_below_threshold_-1_-21\n1                                      13\n2                                      13\n3                                      15\n4                                       4\n5                                       5\n6                                       9\n  length21_T2M_MIN_below_threshold_-2_-22\n1                                      12\n2                                      13\n3                                      16\n4                                       3\n5                                       5\n6                                       9\n  length21_T2M_MIN_below_threshold_-3_-23\n1                                      11\n2                                      13\n3                                      17\n4                                       3\n5                                       5\n6                                       9\n  length21_T2M_MIN_below_threshold_-4_-24\n1                                      10\n2                                      13\n3                                      18\n4                                       3\n5                                       5\n6                                       9\n  length21_T2M_MIN_below_threshold_-5_-25\n1                                       9\n2                                      13\n3                                      19\n4                                       3\n5                                       5\n6                                       9\n  length21_T2M_MIN_below_threshold_-6_-26\n1                                       8\n2                                      13\n3                                      19\n4                                       3\n5                                       5\n6                                       8\n  length21_T2M_MIN_below_threshold_-7_-27\n1                                       7\n2                                      14\n3                                      19\n4                                       3\n5                                       6\n6                                       8\n  length28_T2M_MIN_below_threshold_0_-27 study    heading\n1                                     14     1 2012-05-10\n2                                     20     2 2012-06-09\n3                                     21     3 2012-06-01\n4                                      4     4 2012-05-03\n5                                      6     5 2012-04-15\n6                                     10     6 2013-05-22\n```\n\n\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"site_libs/htmltools-fill-0.5.8.1/fill.css\" rel=\"stylesheet\" />\n<script src=\"site_libs/htmlwidgets-1.6.4/htmlwidgets.js\"></script>\n<script src=\"site_libs/plotly-binding-4.10.4/plotly.js\"></script>\n<script src=\"site_libs/typedarray-0.1/typedarray.min.js\"></script>\n<script src=\"site_libs/jquery-3.5.1/jquery.min.js\"></script>\n<link href=\"site_libs/crosstalk-1.2.1/css/crosstalk.min.css\" rel=\"stylesheet\" />\n<script src=\"site_libs/crosstalk-1.2.1/js/crosstalk.min.js\"></script>\n<link href=\"site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css\" rel=\"stylesheet\" />\n<script src=\"site_libs/plotly-main-2.11.1/plotly-latest.min.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}