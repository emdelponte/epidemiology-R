<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.39">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>19&nbsp; Warning systems – R4PDE.net</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./prediction-disease-modeling.html" rel="next">
<link href="./yieldloss-regression-models.html" rel="prev">
<link href="./cover.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-e26003cea8cd680ca0c55a263523d882.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-183445eade4fe70077aec9335180dcde.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-5T7SZYQV79"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-5T7SZYQV79', { 'anonymize_ip': true});
</script>
<meta name="mermaid-theme" content="forest">
<script src="site_libs/quarto-diagram/mermaid.min.js"></script>
<script src="site_libs/quarto-diagram/mermaid-init.js"></script>
<link href="site_libs/quarto-diagram/mermaid.css" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./prediction-warning-systems.html">Disease prediction</a></li><li class="breadcrumb-item"><a href="./prediction-warning-systems.html"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Warning systems</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">R4PDE.net</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/emdelponte/epidemiology-R" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
    <div class="dropdown">
      <a href="" title="Share" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label="Share"><i class="bi bi-share"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://twitter.com/intent/tweet?url=|url|">
              <i class="bi bi-twitter pe-1"></i>
            Twitter
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.linkedin.com/sharing/share-offsite/?url=|url|">
              <i class="bi bi-linkedin pe-1"></i>
            LinkedIn
            </a>
          </li>
      </ul>
    </div>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cite.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">How to cite</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./author.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">About the author</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./acknowledgements.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Acknowledgements</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false">
 <span class="menu-text">Epidemic data</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-terminology.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Disease variables</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-ordinal.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Ordinal scales</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-actual-severity.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Measuring foliar severity</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-accuracy.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Reliability and accuracy</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-sads.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Standard area diagrams</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-training.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Training sessions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-remote-sensing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Remote sensing</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false">
 <span class="menu-text">Temporal analysis</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./temporal-dpc.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Disease progress curves</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./temporal-models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Population models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./temporal-fitting.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Model fitting</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false">
 <span class="menu-text">Spatial analysis</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./spatial-gradients.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Spatial gradients</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./spatial-models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Gradient models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./spatial-fitting.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Fitting gradient models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./spatial-patterns.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Spatial patterns</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./spatial-tests.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Tests for patterns</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false">
 <span class="menu-text">Epidemics and yield</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./yieldloss-concepts.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Definitions and concepts</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./yieldloss-regression-models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Statistical models</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true">
 <span class="menu-text">Disease prediction</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./prediction-warning-systems.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Warning systems</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./prediction-disease-modeling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Disease modeling</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"><span class="header-section-number">19.1</span> Introduction</a></li>
  <li><a href="#risk-assessment-and-decision-framework" id="toc-risk-assessment-and-decision-framework" class="nav-link" data-scroll-target="#risk-assessment-and-decision-framework"><span class="header-section-number">19.2</span> Risk assessment and decision framework</a></li>
  <li><a href="#when-is-a-warning-system-needed" id="toc-when-is-a-warning-system-needed" class="nav-link" data-scroll-target="#when-is-a-warning-system-needed"><span class="header-section-number">19.3</span> When is a warning system needed?</a></li>
  <li><a href="#what-types-of-systems-are-there" id="toc-what-types-of-systems-are-there" class="nav-link" data-scroll-target="#what-types-of-systems-are-there"><span class="header-section-number">19.4</span> What types of systems are there?</a>
  <ul>
  <li><a href="#disease-thresholds" id="toc-disease-thresholds" class="nav-link" data-scroll-target="#disease-thresholds"><span class="header-section-number">19.4.1</span> Disease thresholds</a>
  <ul>
  <li><a href="#bonus-app-edt-calculator" id="toc-bonus-app-edt-calculator" class="nav-link" data-scroll-target="#bonus-app-edt-calculator"><span class="header-section-number">19.4.1.1</span> Bonus app: EDT calculator</a></li>
  </ul></li>
  <li><a href="#monitoring-season-long-weather" id="toc-monitoring-season-long-weather" class="nav-link" data-scroll-target="#monitoring-season-long-weather"><span class="header-section-number">19.4.2</span> Monitoring season-long weather</a>
  <ul>
  <li><a href="#wallin-model" id="toc-wallin-model" class="nav-link" data-scroll-target="#wallin-model"><span class="header-section-number">19.4.2.1</span> Wallin model</a></li>
  <li><a href="#fast-model" id="toc-fast-model" class="nav-link" data-scroll-target="#fast-model"><span class="header-section-number">19.4.2.2</span> FAST model</a></li>
  <li><a href="#bonus-app-dashboard" id="toc-bonus-app-dashboard" class="nav-link" data-scroll-target="#bonus-app-dashboard"><span class="header-section-number">19.4.2.3</span> Bonus app: Dashboard</a></li>
  </ul></li>
  <li><a href="#infection-risk-during-defined-periods" id="toc-infection-risk-during-defined-periods" class="nav-link" data-scroll-target="#infection-risk-during-defined-periods"><span class="header-section-number">19.4.3</span> Infection risk during defined periods</a>
  <ul>
  <li><a href="#logistic-regression-ohio-fhb-models" id="toc-logistic-regression-ohio-fhb-models" class="nav-link" data-scroll-target="#logistic-regression-ohio-fhb-models"><span class="header-section-number">19.4.3.1</span> Logistic regression: Ohio FHB models</a></li>
  <li><a href="#mechanistic-models-brazilian-fhb-model" id="toc-mechanistic-models-brazilian-fhb-model" class="nav-link" data-scroll-target="#mechanistic-models-brazilian-fhb-model"><span class="header-section-number">19.4.3.2</span> Mechanistic models: Brazilian FHB model</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#practical-considerations" id="toc-practical-considerations" class="nav-link" data-scroll-target="#practical-considerations"><span class="header-section-number">19.5</span> Practical considerations</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/emdelponte/epidemiology-R/edit/main/prediction-warning-systems.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/emdelponte/epidemiology-R/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./prediction-warning-systems.html">Disease prediction</a></li><li class="breadcrumb-item"><a href="./prediction-warning-systems.html"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Warning systems</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Warning systems</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="introduction" class="level2" data-number="19.1">
<h2 data-number="19.1" class="anchored" data-anchor-id="introduction"><span class="header-section-number">19.1</span> Introduction</h2>
<p>One practical application of plant disease epidemiology is to predict disease occurrences to guide timely management interventions, reducing crop damage and rationalizing pesticide use. Since the early to mid 1900s, warning systems (synonyms: disease forecaster, predictor) have advanced considerably. More comprehensively, these systems have evolved to a Decision Support System (DSS), when they integrate expert input, models, and databases for more nuanced management recommendations, transcending simple prediction to encompass various goals within computerized frameworks. In fact, technological progress in recent decades has boosted the development and automation of DSSs, now widely available in public and private sectors, providing direct, sophisticated guidance to crop advisors and growers (<a href="#fig-dss" class="quarto-xref">Figure&nbsp;<span>19.1</span></a>).</p>
<div id="fig-dss" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-dss-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="imgs/dss.png" class="img-fluid quarto-figure quarto-figure-center figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-dss-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;19.1: Core elements of a decision support system that provides risk information for plant disease management
</figcaption>
</figure>
</div>
<p>In its core, a DSS targeting risk prediction for plant disease management are based on a disease <strong>model</strong>, or a simplified, often mathematical, representation of a system (here the pathosystem) used for making predictions or suggesting management decisions based on the risk information they provide. The models range from basic rules (e.g.&nbsp;if-then) and static thresholds to sophisticated simulation models covering entire disease epidemics. Historically, these models collect weather information from on site automatic weather stations, but can be fed with data from remote sensing (e.g.&nbsp;satellite) or data reanalysis sources.</p>
</section>
<section id="risk-assessment-and-decision-framework" class="level2" data-number="19.2">
<h2 data-number="19.2" class="anchored" data-anchor-id="risk-assessment-and-decision-framework"><span class="header-section-number">19.2</span> Risk assessment and decision framework</h2>
<p>There are basically two types of decisions related to plant disease management: tactical and strategical and these can be related to the distinct time frames of information (i.e., historical data, pre-season, growing season, and future seasons). A risk assessment and decision framework, with associated terminology, can be proposed based on such relations (<a href="#fig-timeline" class="quarto-xref">Figure&nbsp;<span>19.2</span></a>) and its components are explained next.</p>
<div id="fig-timeline" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-timeline-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="imgs/timeline.png" class="img-fluid quarto-figure quarto-figure-center figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-timeline-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;19.2: Framework and associated terminology for plant disease risk assessment
</figcaption>
</figure>
</div>
<p><strong>Historical</strong> data and prediction refers to those obtained from or simulated for previous years or seasons. This can include past observed weather patterns, observed or simulated disease outbreaks. The goal is to learn about the “normal” patterns associated with disease prevalence and severity. In the p<strong>re-season</strong> period, predictions are made before the actual planting or growing season starts. This could be based on early predictions of weather patterns for the season. During the <strong>growing season,</strong> real-time data is used to provide short-term predictions. This is the period when crops are in the fields and are actively monitored. Finally, for <strong>future seasons,</strong> projections (e.g.&nbsp;climate change scenarios) can be made for the subsequent years or decades.</p>
<p><strong>Strategical</strong> decisions are those with a long-term impact and are typically based on historical data and projections for future seasons. Examples might include choosing where to plant the crops in the next years, which cultivar to plant, and making infrastructure investments. <strong>Tactical</strong> are short-term decisions typically based on real-time data or short-term predictions, especially those relevant to the current growing season. A chief example include the timing of fungicide applications.</p>
<p>As to risk terminology, <strong>risk analysis</strong> is a comprehensive assessment of potential disease risks, considering both historical data and projections of the future. The goal is to understand and mitigate potential threats to agricultural production. <strong>Risk prediction</strong> can be broken down into a) <strong>outlook:</strong> Broad predictions or estimations about potential risks, often based on pre-season data. Example: effects that El Niño Southern Oscillation (ENSO) may have on disease patterns; b) <strong>forecasting:</strong> short-term predictions, typically for the growing season, such as critical weather events; and c) <strong>warning:</strong> Immediate alerts about imminent risks, like an upcoming risk of plant infection, crucial for tactical decisions.</p>
<p>In this chapter we will focus on warning systems that make use of disease monitoring or seasonal weather to provide risk information for tactical decisions.</p>
</section>
<section id="when-is-a-warning-system-needed" class="level2" data-number="19.3">
<h2 data-number="19.3" class="anchored" data-anchor-id="when-is-a-warning-system-needed"><span class="header-section-number">19.3</span> When is a warning system needed?</h2>
<p>The figure and the box below provide some information on their utility. In the figure, risk analysis is defined as an approach for pathogens/diseases that are not present in a target region and for which modeling can be used for risk estimation if the disease is highly damaging where it occurs. Warning systems can be used if the disease is more erratic but still damaging when occuring. If the epidemics are too frequent and no effective and economic control is available (for example, some nematodes and virus), plant host resistance is the way to go. If there are effective and economic control measures (e.g.&nbsp;fungicide sprays) during the season, farmers should follows scheduled application of treatments.</p>
<div class="cell" data-fig-width="4" data-layout-align="default">
<div class="cell-output-display">
<div id="fig-diagram2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-diagram2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div>
<pre class="mermaid mermaid-js" data-label="fig-diagram2">flowchart
    Start((Start))
    A{Disease&lt;BR&gt;present?}
    B{Highly&lt;BR&gt;damaging?}
    C[Risk Analysis]
    D{Damaging?}
    E{Frequent&lt;BR&gt;epidemics?}
    F[Scheduled treatments]
    G[Warning System]
    H{Economic&lt;BR&gt;control?}
    I[Host Resistance]

    Start --&gt; A
    A --&gt;|N| B
    B --&gt;|N| Start
    D --&gt;|N| Start
    A --&gt;|Y| D
    D --&gt;|Y| E
    E --&gt;|Y| H
    B --&gt;|Y| C
    E --&gt;|N| G
    H --&gt;|N| I
    H --&gt;|Y| F
    

</pre>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-diagram2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;19.3: Decision chart for the need of risk analysis, warning systems, schedule treatment or host resistance in disease management
</figcaption>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
When is a warning system useful?
</div>
</div>
<div class="callout-body-container callout-body">
<p>For operational and economical use, warning systems must fulfill four criteria to be practical. A more comprehensive discussion on this topic is presented in <span class="citation" data-cites="Campbell1990">(<a href="references.html#ref-Campbell1990" role="doc-biblioref">Campbell and Madden. L. 1990</a>)</span>:</p>
<ol type="1">
<li><p>The targeted disease must be economically damaging to crop yield or quality. Minor diseases with negligible effects on yield or quality are unlikely to gain attention from growers and advisors.</p></li>
<li><p>The diseases should exhibit variability across seasons in terms of onset, epidemic growth rate, severity, or another aspect, creating uncertainty in decision-making. Diseases with predictable patterns provide minimal information and little management advantage, reducing the relevance of warning systems.</p></li>
<li><p>Users should be capable of acting on the system’s alerts, necessitating available and effective control measures and sufficient response time to prevent crop damage. Systems are unhelpful if practitioners can’t adapt their strategies promptly.</p></li>
<li><p>The system must encompass comprehensive knowledge about the disease, synthesizing accurate risk estimates. Understanding the specific interactions between host, pathogen, and environment is crucial for the system’s effectiveness and relevance.</p></li>
</ol>
</div>
</div>
</section>
<section id="what-types-of-systems-are-there" class="level2" data-number="19.4">
<h2 data-number="19.4" class="anchored" data-anchor-id="what-types-of-systems-are-there"><span class="header-section-number">19.4</span> What types of systems are there?</h2>
<p>These systems vary significantly in structure and design, reflecting the multitude of plant diseases, objectives, available data, control strategies, developer preferences, and operational infrastructures. Usually, warning system are based on weather inputs, but they might leverage other inputs like host, pathogen, and economic factors, catering to the complexities of disease prediction.</p>
<p>Disease warning systems can include static or dynamic disease thresholds, direct detection of inoculum, simple rules of thumb (e.g.&nbsp;if-then) based on weather, infection risk during defined periods (risk models), or complex simulation models that estimate all phases of an epidemic. Let’s see some examples of these systems together with a possible implementation in R.</p>
<section id="disease-thresholds" class="level3" data-number="19.4.1">
<h3 data-number="19.4.1" class="anchored" data-anchor-id="disease-thresholds"><span class="header-section-number">19.4.1</span> Disease thresholds</h3>
<p>Damaging thresholds, integral to integrated pest management in entomology, can serve as a basic disease warning system. They involve economic injury levels, denoting pest abundance that equates control costs with incurred losses, and economic or action thresholds, indicating when action is necessary to avoid reaching injury levels <span class="citation" data-cites="pedigo1986">(<a href="references.html#ref-pedigo1986" role="doc-biblioref">Pedigo et al. 1986</a>)</span>. These concepts, while straightforward, can be quite complex in practical scenarios.</p>
<p>Though less prevalent than in arthropod management, thresholds guide actions like fungicide application in plant diseases, especially those directly impacting yield through photosynthetic area reduction <span class="citation" data-cites="leiminger2012 nutter1993terms">(<a href="references.html#ref-leiminger2012" role="doc-biblioref">Leiminger and Hausladen 2012</a>; <a href="references.html#ref-nutter1993terms" role="doc-biblioref">Nutter et al. 1993</a>)</span>. However, their application is challenging for rapid, recurrent diseases affecting high-value crops, requiring prompt intervention even at minimal disease levels. With potato late blight, for instance, the first fungicide application may need to be applied by the time disease severity reaches as low as 0.1% of the foliage. Hence, disease monitoring for detection and quantification is vital for this system. In reality, for some rapid spreading and highly damaging diseases one cannot wait to “see” the disease to start protecting the crops, for which yield protection is best when applications are made preventatively.</p>
<p>However, the concept of <strong>economic damage threshold</strong> (EDT) may be used as a criteria do indicate when to start with fungicide sprays. By definition, EDT is the amount of disease intensity (e.g.&nbsp;severity when dealing with foliar diseases) that corresponds to an economic loss that equates the control cost to combat the disease. A formula for the EDT was proposed by Mumford and Norton <span class="citation" data-cites="mumford1984">(<a href="references.html#ref-mumford1984" role="doc-biblioref">Mumford and Norton 1984</a>)</span> and further modified by Reis <span class="citation" data-cites="reis2002modelo">(<a href="references.html#ref-reis2002modelo" role="doc-biblioref">Reis et al. 2002</a>)</span> for use in foliar fungal diseases, as described in Equation 3:</p>
<p><span class="math inline">\(EDT = \frac{F_C}{C_P . D_C} . C_e\)</span> ,</p>
<p>where EDT is the disease intensity, <span class="math inline">\(F_C\)</span> is the fungicide cost (USD/ha), <span class="math inline">\(C_P\)</span> is the crop selling price (USD/ton), <span class="math inline">\(D_C\)</span> is the damage coefficient (adjusted to potential yield) and <span class="math inline">\(C_e\)</span> is the control efficacy of the fungicide (proportion of disease reduction relative to non-treated). In practice, sprays should be applied prior to reaching the EDT, which gives rise to the ADT (action damage threshold).</p>
<p>In a study on northern corn leaf blight in Argentina, the following values were used to calculate the EDT <span class="citation" data-cites="derossi2022">(<a href="references.html#ref-derossi2022" role="doc-biblioref">De Rossi et al. 2022</a>)</span>. Note that the authors adjusted the Dc to potential yield by multiplying by the potential yield value (8.5 ton.ha) in metric tons, since the Dc is normalized to one metric ton. More about Dc in the dedicated chapter on <a href="yieldloss-regression-models.html#damage-coefficients">yield loss</a>. The action damage threshold (ADT) was defined in that study as 20% reduction of the EDT.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>calculate_EDT <span class="ot">&lt;-</span> <span class="cf">function</span>(Fc, Cp, Dc, Ec) {</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  EDT <span class="ot">&lt;-</span> (Fc <span class="sc">/</span> (Cp <span class="sc">*</span> Dc)) <span class="sc">*</span> Ce</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(EDT)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>Fc <span class="ot">&lt;-</span> <span class="dv">30</span>      <span class="co"># fixed cost of control is 30 USD/ha.</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>Cp <span class="ot">&lt;-</span> <span class="dv">112</span>     <span class="co"># fixed crop price is 112 USD/ton.</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>Dc <span class="ot">&lt;-</span> <span class="fl">0.1712</span>  <span class="co"># for potential yield of 8.5 t/ha so 8.5 x 0.02015 = 0.1712.</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>Ce <span class="ot">&lt;-</span> <span class="fl">0.70</span>    <span class="co"># control efficacy of fungicide is 70%.</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>EDT_value <span class="ot">&lt;-</span> <span class="fu">calculate_EDT</span>(Fc, Cp, Dc, Ce)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(EDT_value)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.09521</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>ADT <span class="ot">=</span> EDT_value <span class="sc">*</span> <span class="fl">0.80</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>ADT</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8761682</code></pre>
</div>
</div>
<p>As we can see, the EDT is variable depending on these four parameters. But how does the EDT varies according to variations on each of the parameters individually? Let’s perform some simulations with vary values of the parameter.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(r4pde)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="co"># vary Crop price</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>Cp_values <span class="ot">=</span> <span class="fu">seq</span>(<span class="dv">100</span>, <span class="dv">500</span>, <span class="at">by =</span> <span class="dv">5</span>)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>EDT_values <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">"numeric"</span>, <span class="fu">length</span>(Cp_values))  </span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">seq_along</span>(Cp_values)) {</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>  Cp <span class="ot">=</span> Cp_values[i]</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>  EDT_values[i] <span class="ot">&lt;-</span> <span class="fu">calculate_EDT</span>(Fc, Cp, Dc, Ce)</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>p_cp <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(Cp_values, EDT_values) <span class="sc">|&gt;</span> </span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(Cp_values, EDT_values))<span class="sc">+</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Crop price (US$/ton)"</span>,</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"EDT"</span>)<span class="sc">+</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_r4pde</span>(<span class="at">font_size =</span><span class="dv">14</span>)</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Vary fungicide price</span></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>Fc_values <span class="ot">=</span> <span class="fu">seq</span>(<span class="dv">10</span>, <span class="dv">100</span>, <span class="at">by =</span> <span class="dv">5</span>)</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>EDT_values <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">"numeric"</span>, <span class="fu">length</span>(Fc_values))  </span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">seq_along</span>(Fc_values)) {</span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>  Fc <span class="ot">=</span> Fc_values[i]</span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>  EDT_values[i] <span class="ot">&lt;-</span> <span class="fu">calculate_EDT</span>(Fc, Cp, Dc, Ce)</span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>p_fc <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(Fc_values, EDT_values) <span class="sc">|&gt;</span> </span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(Fc_values, EDT_values))<span class="sc">+</span></span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Control cost (US$/ha)"</span>,</span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"EDT"</span>)<span class="sc">+</span></span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_r4pde</span>(<span class="at">font_size =</span><span class="dv">14</span>)</span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Vary damage coefficient</span></span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a>Dc_values <span class="ot">=</span> <span class="fu">seq</span>(<span class="fl">0.001</span>, <span class="fl">0.01</span>, <span class="at">by =</span> <span class="fl">0.0001</span>)</span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a>EDT_values <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">"numeric"</span>, <span class="fu">length</span>(Dc_values))  </span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">seq_along</span>(Dc_values)) {</span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true" tabindex="-1"></a>  Dc <span class="ot">=</span> Dc_values[i]</span>
<span id="cb5-38"><a href="#cb5-38" aria-hidden="true" tabindex="-1"></a>  EDT_values[i] <span class="ot">&lt;-</span> <span class="fu">calculate_EDT</span>(Fc, Cp, Dc, Ce)</span>
<span id="cb5-39"><a href="#cb5-39" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-40"><a href="#cb5-40" aria-hidden="true" tabindex="-1"></a>p_dc <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(Dc_values, EDT_values) <span class="sc">|&gt;</span> </span>
<span id="cb5-41"><a href="#cb5-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(Dc_values, EDT_values))<span class="sc">+</span></span>
<span id="cb5-42"><a href="#cb5-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb5-43"><a href="#cb5-43" aria-hidden="true" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Damage coefficient"</span>,</span>
<span id="cb5-44"><a href="#cb5-44" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"EDT"</span>)<span class="sc">+</span></span>
<span id="cb5-45"><a href="#cb5-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_r4pde</span>(<span class="at">font_size =</span><span class="dv">14</span>)</span>
<span id="cb5-46"><a href="#cb5-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-47"><a href="#cb5-47" aria-hidden="true" tabindex="-1"></a><span class="co"># Vary Control efficacy</span></span>
<span id="cb5-48"><a href="#cb5-48" aria-hidden="true" tabindex="-1"></a>Ce_values <span class="ot">=</span> <span class="fu">seq</span>(<span class="fl">0.2</span>, <span class="dv">1</span>, <span class="at">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb5-49"><a href="#cb5-49" aria-hidden="true" tabindex="-1"></a>EDT_values <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">"numeric"</span>, <span class="fu">length</span>(Ce_values))  </span>
<span id="cb5-50"><a href="#cb5-50" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">seq_along</span>(Ce_values)) {</span>
<span id="cb5-51"><a href="#cb5-51" aria-hidden="true" tabindex="-1"></a>  Ce <span class="ot">=</span> Ce_values[i]</span>
<span id="cb5-52"><a href="#cb5-52" aria-hidden="true" tabindex="-1"></a>  EDT_values[i] <span class="ot">&lt;-</span> <span class="fu">calculate_EDT</span>(Fc, Cp, Dc, Ce)</span>
<span id="cb5-53"><a href="#cb5-53" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-54"><a href="#cb5-54" aria-hidden="true" tabindex="-1"></a>p_ce <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(Ce_values, EDT_values) <span class="sc">|&gt;</span> </span>
<span id="cb5-55"><a href="#cb5-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(Ce_values, EDT_values))<span class="sc">+</span></span>
<span id="cb5-56"><a href="#cb5-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb5-57"><a href="#cb5-57" aria-hidden="true" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Control efficacy (%)"</span>,</span>
<span id="cb5-58"><a href="#cb5-58" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"EDT"</span>)<span class="sc">+</span></span>
<span id="cb5-59"><a href="#cb5-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_r4pde</span>(<span class="at">font_size =</span><span class="dv">14</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>(p_cp <span class="sc">|</span> p_fc) <span class="sc">/</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  (p_dc <span class="sc">|</span> p_ce)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-edt" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-edt-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="prediction-warning-systems_files/figure-html/fig-edt-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-edt-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;19.4: Variation of the economic damage threshold (EDT) according to fluctuations on each parameter in the formula for its calculation
</figcaption>
</figure>
</div>
</div>
</div>
<section id="bonus-app-edt-calculator" class="level4" data-number="19.4.1.1">
<h4 data-number="19.4.1.1" class="anchored" data-anchor-id="bonus-app-edt-calculator"><span class="header-section-number">19.4.1.1</span> Bonus app: EDT calculator</h4>
<p>The scenario for EDT calculation is intricate, influenced by fluctuations in several parameters. To streamline these computations, a Shiny application called <a href="https://epidemiologiaufv.shinyapps.io/EDTCalculator/">EDT Calculator</a> was developed, enabling users to specify each parameter and assess EDT (and respective 95% CI) under uncertainties in variables such as crop price and fungicide costs.</p>
<div id="fig-EDT" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-EDT-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="https://epidemiologiaufv.shinyapps.io/EDTCalculator/"><img src="imgs/EDT_calculator.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-EDT-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;19.5: Screenshot of the EDT calculator, a Shiny app for interactive calculation of economic damage threshold (EDT)
</figcaption>
</figure>
</div>
</section>
</section>
<section id="monitoring-season-long-weather" class="level3" data-number="19.4.2">
<h3 data-number="19.4.2" class="anchored" data-anchor-id="monitoring-season-long-weather"><span class="header-section-number">19.4.2</span> Monitoring season-long weather</h3>
<p>Disease warning systems frequently predict conditions conducive to infection of the plant by the pathogen, with wetness and temperature being key variables for many foliar diseases <span class="citation" data-cites="bourke1970">(<a href="references.html#ref-bourke1970" role="doc-biblioref">Bourke 1970</a>)</span>. BLITECAST, the first computerized system <span class="citation" data-cites="krause1975blitecast">(<a href="references.html#ref-krause1975blitecast" role="doc-biblioref">Krause et al. 1975</a>)</span> (which combined the Wallin and Hyre systems) provided the means of performing necessary calculations accurately and quickly and issuing recommendations to growers, is an example of successful automated warning system <span class="citation" data-cites="krause1975">(<a href="references.html#ref-krause1975" role="doc-biblioref">Krause and Massie 1975</a>)</span>. While initial inoculum is often undetectable, the presence of inoculum of the pathogen is assumed in many weather-based warning systems. Predictions of an outbreak are possible by tracking environmental conditions favorable for disease development.</p>
<p>Weather-based disease warning systems, like FAST (Forecasting <em>Alternaria solani</em> on tomatoes) and Wallin <span class="citation" data-cites="madden1978 wallin1962">(<a href="references.html#ref-madden1978" role="doc-biblioref">Madden 1978</a>; <a href="references.html#ref-wallin1962" role="doc-biblioref">Wallin 1962</a>)</span>, continuously monitor moisture and temperature for various crop diseases. These systems calculate weather favorability from environmental data, predicting infection and disease severity. They serve to guide growers on optimal spraying schedules, initiating treatments or determining application intervals based on accumulated severity values over time.</p>
<section id="wallin-model" class="level4" data-number="19.4.2.1">
<h4 data-number="19.4.2.1" class="anchored" data-anchor-id="wallin-model"><span class="header-section-number">19.4.2.1</span> Wallin model</h4>
<p>J.R. Wallin developed a model in the mid-20th century focusing on forecasting potato late blight, detailed across several publications <span class="citation" data-cites="wallin1962">(<a href="references.html#ref-wallin1962" role="doc-biblioref">Wallin 1962</a>)</span>. The model tracks hourly relative humidity and temperature, emphasizing periods with relative humidity of 90% or more. It calculates the number of high-humidity hours and the corresponding average temperature during the wet period. By accumulating ‘disease severity values’ (DSV) from plant emergence throughout the season, based on humidity and temperature measures, the model predicts the initial onset and subsequent spread of potato late blight. The table below summarizes the way the DSVs are obtained based on combinations of hours of relative humdity &gt; 90% and the air temperature within the wet period.</p>
<p><strong>Table.</strong> Relationship of temperature and relative humidity (RH) periods as used in the Wallin late blight forecasting system to predict disease severity values (0 to 4).</p>
<table class="caption-top table">
<tbody>
<tr class="odd">
<td></td>
<td>Daily</td>
<td>severity</td>
<td>value</td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>Average Temperature Range</td>
<td>0</td>
<td>1</td>
<td>2</td>
<td>3</td>
<td>4</td>
</tr>
<tr class="odd">
<td>7.2 - 11.6 C</td>
<td>15</td>
<td>16-18</td>
<td>19-21</td>
<td>22-24</td>
<td>&gt;25</td>
</tr>
<tr class="even">
<td>11.7 - 15.0 C</td>
<td>12</td>
<td>13-15</td>
<td>16-18</td>
<td>19-21</td>
<td>&gt;22</td>
</tr>
<tr class="odd">
<td>15.1 - 26.6 C</td>
<td>9</td>
<td>10-12</td>
<td>13-15</td>
<td>16-18</td>
<td>&gt;19</td>
</tr>
</tbody>
</table>
<p>Let’s calculate DVS in R based on Wallin’s system. But first we need to download hourly weather data from NASA Power project using {nasapower} R package for the locality of Viçosa, MG, Brazil during the month of March 2022.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nasapower)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>weather <span class="ot">&lt;-</span> <span class="fu">get_power</span>(</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">community =</span> <span class="st">"ag"</span>,</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">lonlat =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">42.88</span>, <span class="sc">-</span><span class="fl">20.7561</span>),</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">pars =</span> <span class="fu">c</span>(<span class="st">"RH2M"</span>, <span class="st">"T2M"</span>),</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">dates =</span> <span class="fu">c</span>(<span class="st">"2022-03-02"</span>, <span class="st">"2022-03-31"</span>),</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">temporal_api =</span> <span class="st">"hourly"</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(weather)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>NASA/POWER CERES/MERRA2 Native Resolution Hourly Data  
 Dates (month/day/year): 03/02/2022 through 03/31/2022  
 Location: Latitude  -20.7561   Longitude -42.88  
 Elevation from MERRA-2: Average for 0.5 x 0.625 degree lat/lon region = 665.27 meters 
 The value for missing source data that cannot be computed or is outside of the sources availability range: NA  
 Parameter(s):  
 
 Parameters: 
 RH2M     MERRA-2 Relative Humidity at 2 Meters (%) ;
 T2M      MERRA-2 Temperature at 2 Meters (C)  
 
# A tibble: 6 × 8
    LON   LAT  YEAR    MO    DY    HR  RH2M   T2M
  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 -42.9 -20.8  2022     3     2     0  96.3  19.4
2 -42.9 -20.8  2022     3     2     1  97.2  19.0
3 -42.9 -20.8  2022     3     2     2  98.1  18.8
4 -42.9 -20.8  2022     3     2     3  99.1  18.6
5 -42.9 -20.8  2022     3     2     4  98.9  18.6
6 -42.9 -20.8  2022     3     2     5  98.6  18.6</code></pre>
</div>
</div>
<p>We now need to obtain the wet period (let’s call it leaf wetness, or LW) based on hours of relative humidity &gt;90% and then the average temperature during the LW period for each day. We can obtain these by grouping the variables by year, month and day and use <code>mutate()</code> and <code>summarise()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>weather2 <span class="ot">&lt;-</span> weather <span class="sc">|&gt;</span> </span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>      <span class="fu">group_by</span>(YEAR, MO, DY) <span class="sc">|&gt;</span> </span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">LW =</span> <span class="fu">case_when</span>(RH2M <span class="sc">&gt;</span> <span class="dv">90</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>                            <span class="cn">TRUE</span> <span class="sc">~</span> <span class="dv">0</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(LW <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">|&gt;</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">summarise</span>(<span class="at">Air_LWD =</span> <span class="fu">mean</span>(T2M, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>                <span class="at">LWD =</span> <span class="fu">n</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now we are ready to calculate the daily DSV based on Wallin’s rules on the table and inspect the first 6 rows of the new table called <code>df_wallin</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>df_wallin <span class="ot">&lt;-</span> weather2 <span class="sc">|&gt;</span> </span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">DSV =</span> <span class="fu">case_when</span>(</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>          <span class="co"># Temperature Range: 7.2 - 11.6 C</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>          Air_LWD <span class="sc">&gt;=</span> <span class="fl">7.2</span> <span class="sc">&amp;</span> Air_LWD <span class="sc">&lt;=</span> <span class="fl">11.7</span> <span class="sc">&amp;</span> LWD <span class="sc">&lt;=</span> <span class="dv">15</span> <span class="sc">~</span> <span class="dv">0</span>,</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>          Air_LWD <span class="sc">&gt;=</span> <span class="fl">7.2</span> <span class="sc">&amp;</span> Air_LWD <span class="sc">&lt;=</span> <span class="fl">11.7</span> <span class="sc">&amp;</span> LWD <span class="sc">&gt;</span> <span class="dv">15</span> <span class="sc">&amp;</span> LWD <span class="sc">&lt;=</span> <span class="dv">18</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>          Air_LWD <span class="sc">&gt;=</span> <span class="fl">7.2</span> <span class="sc">&amp;</span> Air_LWD <span class="sc">&lt;=</span> <span class="fl">11.7</span> <span class="sc">&amp;</span> LWD <span class="sc">&gt;</span> <span class="dv">18</span> <span class="sc">&amp;</span> LWD <span class="sc">&lt;=</span> <span class="dv">21</span> <span class="sc">~</span> <span class="dv">2</span>,</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>          Air_LWD <span class="sc">&gt;=</span> <span class="fl">7.2</span> <span class="sc">&amp;</span> Air_LWD <span class="sc">&lt;=</span> <span class="fl">11.7</span> <span class="sc">&amp;</span> LWD <span class="sc">&gt;</span> <span class="dv">21</span> <span class="sc">&amp;</span> LWD <span class="sc">&lt;=</span> <span class="dv">24</span> <span class="sc">~</span> <span class="dv">3</span>,</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>          Air_LWD <span class="sc">&gt;=</span> <span class="fl">7.2</span> <span class="sc">&amp;</span> Air_LWD <span class="sc">&lt;=</span> <span class="fl">11.7</span> <span class="sc">&amp;</span> LWD <span class="sc">&gt;</span> <span class="dv">24</span> <span class="sc">~</span> <span class="dv">4</span>,</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>          <span class="co"># Temperature Range: 11.7 - 15.0 C</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>          Air_LWD <span class="sc">&gt;</span> <span class="fl">11.7</span> <span class="sc">&amp;</span> Air_LWD <span class="sc">&lt;=</span> <span class="fl">15.1</span> <span class="sc">&amp;</span> LWD <span class="sc">&lt;=</span> <span class="dv">12</span> <span class="sc">~</span> <span class="dv">0</span>,</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>          Air_LWD <span class="sc">&gt;</span> <span class="fl">11.7</span> <span class="sc">&amp;</span> Air_LWD <span class="sc">&lt;=</span> <span class="fl">15.1</span> <span class="sc">&amp;</span> LWD <span class="sc">&gt;</span> <span class="dv">12</span> <span class="sc">&amp;</span> LWD <span class="sc">&lt;=</span> <span class="dv">15</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>          Air_LWD <span class="sc">&gt;</span> <span class="fl">11.7</span> <span class="sc">&amp;</span> Air_LWD <span class="sc">&lt;=</span> <span class="fl">15.1</span> <span class="sc">&amp;</span> LWD <span class="sc">&gt;</span> <span class="dv">15</span> <span class="sc">&amp;</span> LWD <span class="sc">&lt;=</span> <span class="dv">18</span> <span class="sc">~</span> <span class="dv">2</span>,</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>          Air_LWD <span class="sc">&gt;</span> <span class="fl">11.7</span> <span class="sc">&amp;</span> Air_LWD <span class="sc">&lt;=</span> <span class="fl">15.1</span> <span class="sc">&amp;</span> LWD <span class="sc">&gt;</span> <span class="dv">18</span> <span class="sc">&amp;</span> LWD <span class="sc">&lt;=</span> <span class="dv">21</span> <span class="sc">~</span> <span class="dv">3</span>,</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>          Air_LWD <span class="sc">&gt;</span> <span class="fl">11.7</span> <span class="sc">&amp;</span> Air_LWD <span class="sc">&lt;=</span> <span class="fl">15.1</span> <span class="sc">&amp;</span> LWD <span class="sc">&gt;</span> <span class="dv">21</span> <span class="sc">~</span> <span class="dv">4</span>,</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>          <span class="co"># Temperature Range: 15.1 - 26.6 C</span></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>          Air_LWD <span class="sc">&gt;</span> <span class="fl">15.1</span> <span class="sc">&amp;</span> Air_LWD <span class="sc">&lt;=</span> <span class="fl">26.6</span> <span class="sc">&amp;</span> LWD <span class="sc">&lt;=</span> <span class="dv">9</span> <span class="sc">~</span> <span class="dv">0</span>,</span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>          Air_LWD <span class="sc">&gt;</span> <span class="fl">15.1</span> <span class="sc">&amp;</span> Air_LWD <span class="sc">&lt;=</span> <span class="fl">26.6</span> <span class="sc">&amp;</span> LWD <span class="sc">&gt;</span> <span class="dv">9</span> <span class="sc">&amp;</span> LWD <span class="sc">&lt;=</span> <span class="dv">12</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>          Air_LWD <span class="sc">&gt;</span> <span class="fl">15.1</span> <span class="sc">&amp;</span> Air_LWD <span class="sc">&lt;=</span> <span class="fl">26.6</span> <span class="sc">&amp;</span> LWD <span class="sc">&gt;</span> <span class="dv">12</span> <span class="sc">&amp;</span> LWD <span class="sc">&lt;=</span> <span class="dv">15</span> <span class="sc">~</span> <span class="dv">2</span>,</span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>          Air_LWD <span class="sc">&gt;</span> <span class="fl">15.1</span> <span class="sc">&amp;</span> Air_LWD <span class="sc">&lt;=</span> <span class="fl">26.6</span> <span class="sc">&amp;</span> LWD <span class="sc">&gt;</span> <span class="dv">15</span> <span class="sc">&amp;</span> LWD <span class="sc">&lt;=</span> <span class="dv">18</span> <span class="sc">~</span> <span class="dv">3</span>,</span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>          Air_LWD <span class="sc">&gt;</span> <span class="fl">15.1</span> <span class="sc">&amp;</span> Air_LWD <span class="sc">&lt;=</span> <span class="fl">26.6</span> <span class="sc">&amp;</span> LWD <span class="sc">&gt;</span> <span class="dv">18</span> <span class="sc">~</span> <span class="dv">4</span>,</span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a>          <span class="co"># Default (For temperatures out of the specified ranges or any other scenarios)</span></span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a>          <span class="cn">TRUE</span> <span class="sc">~</span> <span class="dv">0</span>  <span class="co"># Assigning a default value of 0</span></span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">head</span>(df_wallin)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 6
# Groups:   YEAR, MO [1]
   YEAR    MO    DY Air_LWD   LWD   DSV
  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt; &lt;int&gt; &lt;dbl&gt;
1  2022     3     2    19.2    10     1
2  2022     3     3    19.7    12     1
3  2022     3     4    19.9    10     1
4  2022     3     5    19.5     7     0
5  2022     3     6    19.0     9     0
6  2022     3     7    18.4     7     0</code></pre>
</div>
</div>
<p>We can visualize the daily and cumulative DSV for the monthly period after transforming the date format using <code>as.Date()</code> function. The dashed horizontal line in the plot indicates the action threshold of 20 cumulative DSV points, or when a spray should be applied. Please note that in real systems, the DSV is reduced to zero and another DSV counting is initiated after the spray.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>df_wallin2 <span class="ot">&lt;-</span> df_wallin <span class="sc">|&gt;</span> </span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">DSV2 =</span> <span class="fu">cumsum</span>(DSV),</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">date =</span> <span class="fu">as.Date</span>(<span class="fu">sprintf</span>(<span class="st">'%04d-%02d-%02d'</span>, YEAR, MO, DY)))</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>df_wallin2 <span class="sc">|&gt;</span> </span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(date, DSV))<span class="sc">+</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">fill =</span> <span class="st">"darkred"</span>)<span class="sc">+</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(date, DSV2))<span class="sc">+</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">20</span>, <span class="at">linetype =</span> <span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"text"</span>, <span class="at">x =</span> <span class="fu">as.Date</span>(<span class="st">"2022-03-04"</span>), <span class="at">y =</span> <span class="fl">20.5</span>, <span class="at">label =</span> <span class="st">"Action threshold"</span>)<span class="sc">+</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>  r4pde<span class="sc">::</span><span class="fu">theme_r4pde</span>()<span class="sc">+</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Date"</span>, <span class="at">y =</span> <span class="st">"Daily and cumulative DSV"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="prediction-warning-systems_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="fast-model" class="level4" data-number="19.4.2.2">
<h4 data-number="19.4.2.2" class="anchored" data-anchor-id="fast-model"><span class="header-section-number">19.4.2.2</span> FAST model</h4>
<p>Here is a code to calculate daily DSV values based on the FAST table <span class="citation" data-cites="madden1978">(<a href="references.html#ref-madden1978" role="doc-biblioref">Madden 1978</a>)</span> that relates the hours of relative humidity &gt; 90% (wet period) and temperature during the wet period during a 24-hour period.</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Mean temp (°C)</th>
<th>0</th>
<th>1</th>
<th>2</th>
<th>3</th>
<th>4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>13-17</td>
<td>0-6</td>
<td>7-15</td>
<td>16-20</td>
<td>21+</td>
<td>23+</td>
</tr>
<tr class="even">
<td>18-20</td>
<td>0-3</td>
<td>4-8</td>
<td>9-15</td>
<td>16-22</td>
<td>23+</td>
</tr>
<tr class="odd">
<td>21-25</td>
<td>0-2</td>
<td>3-5</td>
<td>6-12</td>
<td>13-20</td>
<td>21+</td>
</tr>
<tr class="even">
<td>26-29</td>
<td>0-3</td>
<td>4-8</td>
<td>9-15</td>
<td>16-22</td>
<td>23+</td>
</tr>
</tbody>
</table>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a> df_fast <span class="ot">&lt;-</span> weather2 <span class="sc">%&gt;%</span> </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">DSV =</span> <span class="fu">case_when</span>(</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>          <span class="co"># Temperature Range: 13 &lt;= T &lt; 18</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>          Air_LWD <span class="sc">&gt;=</span> <span class="dv">13</span> <span class="sc">&amp;</span> Air_LWD <span class="sc">&lt;</span> <span class="dv">18</span> <span class="sc">&amp;</span> LWD <span class="sc">&gt;=</span> <span class="dv">0</span> <span class="sc">&amp;</span> LWD <span class="sc">&lt;=</span> <span class="dv">6</span> <span class="sc">~</span> <span class="dv">0</span>,</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>          Air_LWD <span class="sc">&gt;=</span> <span class="dv">13</span> <span class="sc">&amp;</span> Air_LWD <span class="sc">&lt;</span> <span class="dv">18</span> <span class="sc">&amp;</span> LWD <span class="sc">&gt;=</span> <span class="dv">7</span> <span class="sc">&amp;</span> LWD <span class="sc">&lt;=</span> <span class="dv">15</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>          Air_LWD <span class="sc">&gt;=</span> <span class="dv">13</span> <span class="sc">&amp;</span> Air_LWD <span class="sc">&lt;</span> <span class="dv">18</span> <span class="sc">&amp;</span> LWD <span class="sc">&gt;=</span> <span class="dv">16</span> <span class="sc">&amp;</span> LWD <span class="sc">&lt;=</span> <span class="dv">20</span> <span class="sc">~</span> <span class="dv">2</span>,</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>          Air_LWD <span class="sc">&gt;=</span> <span class="dv">13</span> <span class="sc">&amp;</span> Air_LWD <span class="sc">&lt;</span> <span class="dv">18</span> <span class="sc">&amp;</span> LWD <span class="sc">&gt;</span> <span class="dv">20</span> <span class="sc">~</span> <span class="dv">3</span>,</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>          <span class="co"># Temperature Range: 18 &lt;= T &lt; 21</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>          Air_LWD <span class="sc">&gt;=</span> <span class="dv">18</span> <span class="sc">&amp;</span> Air_LWD <span class="sc">&lt;</span> <span class="dv">21</span> <span class="sc">&amp;</span> LWD <span class="sc">&gt;=</span> <span class="dv">0</span> <span class="sc">&amp;</span> LWD <span class="sc">&lt;=</span> <span class="dv">3</span> <span class="sc">~</span> <span class="dv">0</span>,</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>          Air_LWD <span class="sc">&gt;=</span> <span class="dv">18</span> <span class="sc">&amp;</span> Air_LWD <span class="sc">&lt;</span> <span class="dv">21</span> <span class="sc">&amp;</span> LWD <span class="sc">&gt;=</span> <span class="dv">4</span> <span class="sc">&amp;</span> LWD <span class="sc">&lt;=</span> <span class="dv">8</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>          Air_LWD <span class="sc">&gt;=</span> <span class="dv">18</span> <span class="sc">&amp;</span> Air_LWD <span class="sc">&lt;</span> <span class="dv">21</span> <span class="sc">&amp;</span> LWD <span class="sc">&gt;=</span> <span class="dv">9</span> <span class="sc">&amp;</span> LWD <span class="sc">&lt;=</span> <span class="dv">15</span> <span class="sc">~</span> <span class="dv">2</span>,</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>          Air_LWD <span class="sc">&gt;=</span> <span class="dv">18</span> <span class="sc">&amp;</span> Air_LWD <span class="sc">&lt;</span> <span class="dv">21</span> <span class="sc">&amp;</span> LWD <span class="sc">&gt;=</span> <span class="dv">16</span> <span class="sc">&amp;</span> LWD <span class="sc">&lt;=</span> <span class="dv">22</span> <span class="sc">~</span> <span class="dv">3</span>,</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>          Air_LWD <span class="sc">&gt;=</span> <span class="dv">18</span> <span class="sc">&amp;</span> Air_LWD <span class="sc">&lt;</span> <span class="dv">21</span> <span class="sc">&amp;</span> LWD <span class="sc">&gt;</span> <span class="dv">22</span> <span class="sc">~</span> <span class="dv">4</span>,</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>          <span class="co"># Temperature Range: 21 &lt;= T &lt; 26</span></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>          Air_LWD <span class="sc">&gt;=</span> <span class="dv">21</span> <span class="sc">&amp;</span> Air_LWD <span class="sc">&lt;</span> <span class="dv">26</span> <span class="sc">&amp;</span> LWD <span class="sc">&gt;=</span> <span class="dv">0</span> <span class="sc">&amp;</span> LWD <span class="sc">&lt;=</span> <span class="dv">2</span> <span class="sc">~</span> <span class="dv">0</span>,</span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>          Air_LWD <span class="sc">&gt;=</span> <span class="dv">21</span> <span class="sc">&amp;</span> Air_LWD <span class="sc">&lt;</span> <span class="dv">26</span> <span class="sc">&amp;</span> LWD <span class="sc">&gt;=</span> <span class="dv">3</span> <span class="sc">&amp;</span> LWD <span class="sc">&lt;=</span> <span class="dv">5</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>          Air_LWD <span class="sc">&gt;=</span> <span class="dv">21</span> <span class="sc">&amp;</span> Air_LWD <span class="sc">&lt;</span> <span class="dv">26</span> <span class="sc">&amp;</span> LWD <span class="sc">&gt;=</span> <span class="dv">6</span> <span class="sc">&amp;</span> LWD <span class="sc">&lt;=</span> <span class="dv">12</span> <span class="sc">~</span> <span class="dv">2</span>,</span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>          Air_LWD <span class="sc">&gt;=</span> <span class="dv">21</span> <span class="sc">&amp;</span> Air_LWD <span class="sc">&lt;</span> <span class="dv">26</span> <span class="sc">&amp;</span> LWD <span class="sc">&gt;=</span> <span class="dv">13</span> <span class="sc">&amp;</span> LWD <span class="sc">&lt;=</span> <span class="dv">20</span> <span class="sc">~</span> <span class="dv">3</span>,</span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>          Air_LWD <span class="sc">&gt;=</span> <span class="dv">21</span> <span class="sc">&amp;</span> Air_LWD <span class="sc">&lt;</span> <span class="dv">26</span> <span class="sc">&amp;</span> LWD <span class="sc">&gt;</span> <span class="dv">20</span> <span class="sc">~</span> <span class="dv">4</span>,</span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>          <span class="co"># Temperature Range: 26 &lt;= T &lt; 30</span></span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>          Air_LWD <span class="sc">&gt;=</span> <span class="dv">26</span> <span class="sc">&amp;</span> Air_LWD <span class="sc">&lt;</span> <span class="dv">30</span> <span class="sc">&amp;</span> LWD <span class="sc">&gt;=</span> <span class="dv">0</span> <span class="sc">&amp;</span> LWD <span class="sc">&lt;=</span> <span class="dv">3</span> <span class="sc">~</span> <span class="dv">0</span>,</span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a>          Air_LWD <span class="sc">&gt;=</span> <span class="dv">26</span> <span class="sc">&amp;</span> Air_LWD <span class="sc">&lt;</span> <span class="dv">30</span> <span class="sc">&amp;</span> LWD <span class="sc">&gt;=</span> <span class="dv">4</span> <span class="sc">&amp;</span> LWD <span class="sc">&lt;=</span> <span class="dv">8</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a>          Air_LWD <span class="sc">&gt;=</span> <span class="dv">26</span> <span class="sc">&amp;</span> Air_LWD <span class="sc">&lt;</span> <span class="dv">30</span> <span class="sc">&amp;</span> LWD <span class="sc">&gt;=</span> <span class="dv">9</span> <span class="sc">&amp;</span> LWD <span class="sc">&lt;=</span> <span class="dv">15</span> <span class="sc">~</span> <span class="dv">2</span>,</span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a>          Air_LWD <span class="sc">&gt;=</span> <span class="dv">26</span> <span class="sc">&amp;</span> Air_LWD <span class="sc">&lt;</span> <span class="dv">30</span> <span class="sc">&amp;</span> LWD <span class="sc">&gt;=</span> <span class="dv">16</span> <span class="sc">&amp;</span> LWD <span class="sc">&lt;=</span> <span class="dv">22</span> <span class="sc">~</span> <span class="dv">3</span>,</span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a>          Air_LWD <span class="sc">&gt;=</span> <span class="dv">26</span> <span class="sc">&amp;</span> Air_LWD <span class="sc">&lt;</span> <span class="dv">30</span> <span class="sc">&amp;</span> LWD <span class="sc">&gt;</span> <span class="dv">22</span> <span class="sc">~</span> <span class="dv">4</span>,</span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a>          <span class="co"># Default (For temperatures out of the specified ranges or any other scenarios)</span></span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a>          <span class="cn">TRUE</span> <span class="sc">~</span> <span class="dv">0</span>  <span class="co"># Assigning a default value of 0</span></span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb13-34"><a href="#cb13-34" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb13-35"><a href="#cb13-35" aria-hidden="true" tabindex="-1"></a>df_fast</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 30 × 6
# Groups:   YEAR, MO [1]
    YEAR    MO    DY Air_LWD   LWD   DSV
   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt; &lt;int&gt; &lt;dbl&gt;
 1  2022     3     2    19.2    10     2
 2  2022     3     3    19.7    12     2
 3  2022     3     4    19.9    10     2
 4  2022     3     5    19.5     7     1
 5  2022     3     6    19.0     9     2
 6  2022     3     7    18.4     7     1
 7  2022     3     8    19.2    10     2
 8  2022     3     9    19.6    12     2
 9  2022     3    10    19.6    13     2
10  2022     3    11    19.7    12     2
# ℹ 20 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>df_fast2 <span class="ot">&lt;-</span> df_fast <span class="sc">|&gt;</span> </span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">DSV2 =</span> <span class="fu">cumsum</span>(DSV),</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">date =</span> <span class="fu">as.Date</span>(<span class="fu">sprintf</span>(<span class="st">'%04d-%02d-%02d'</span>, YEAR, MO, DY)))</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>df_fast2 <span class="sc">|&gt;</span> </span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(date, DSV))<span class="sc">+</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">fill =</span> <span class="st">"darkred"</span>)<span class="sc">+</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(date, DSV2))<span class="sc">+</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">20</span>, <span class="at">linetype =</span> <span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"text"</span>, <span class="at">x =</span> <span class="fu">as.Date</span>(<span class="st">"2022-03-04"</span>), <span class="at">y =</span> <span class="fl">21.5</span>, <span class="at">label =</span> <span class="st">"Action threshold"</span>)<span class="sc">+</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>  r4pde<span class="sc">::</span><span class="fu">theme_r4pde</span>()<span class="sc">+</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Date"</span>, <span class="at">y =</span> <span class="st">"Daily and cumulative DSV"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="prediction-warning-systems_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="bonus-app-dashboard" class="level4" data-number="19.4.2.3">
<h4 data-number="19.4.2.3" class="anchored" data-anchor-id="bonus-app-dashboard"><span class="header-section-number">19.4.2.3</span> Bonus app: Dashboard</h4>
<p>For educational purposes, an interactive dashboard was developed using R Shiny. This <a href="https://epidemiologiaufv.shinyapps.io/warning-systems/">app</a> demonstrates the application of the Wallin (forecast for late blight of potato) and FAST (Forecast for <em>Alternaria solani</em> on Tomatoes) rules for calculating DSV, determining the appropriate timing for fungicide sprays (based on a defined threshold), and counting the total sprays during a selected period (<a href="#fig-ws_systems" class="quarto-xref">Figure&nbsp;<span>19.6</span></a>).</p>
<p>To utilize the system, users should select the model, input the latitude and longitude (or choose a location from the map), and specify the time period for the simulation, such as from plant emergence to harvest. The weather data for this simulation is sourced from the NASA Power project via the {nasapower} R package.</p>
<div id="fig-ws_systems" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ws_systems-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="https://epidemiologiaufv.shinyapps.io/warning-systems/"><img src="imgs/ws_systems.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ws_systems-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;19.6: Screenshot of a web-based warning system for plant diseases based on Wallin's and FAST rules
</figcaption>
</figure>
</div>
</section>
</section>
<section id="infection-risk-during-defined-periods" class="level3" data-number="19.4.3">
<h3 data-number="19.4.3" class="anchored" data-anchor-id="infection-risk-during-defined-periods"><span class="header-section-number">19.4.3</span> Infection risk during defined periods</h3>
<p>Many diseases like late blight of potatoes and early blight of tomatoes, as seen in the previous section, require continuous (season long) risk monitoring to indicate multiple fungicide sprays. However, some warning systems assess risk at only at one time points, such as those crops that are most vulnerable to diseases during specific growth phases. In these cases, a single warning is issued, such as the risk of disease occurrence or occurrence at a intensity above a threshold (e.g.&nbsp;incidence &gt; 30%).</p>
<p>Some of these systems use statistical (risk algorithms) to predict probabilities of occurrence of the event (yes/no situation) based on weather variables that occur over specific periods of time, usually when primary infections take place. For example, Fusarium head blight (FHB, caused by <em>Fusarium graminearum</em>) disease depends on weather events that occur around the flowering stage, when the crop is most vulnerable. This is also the case of <em>Sclerotinia</em> (white mold) diseases that affect flowers and the presence/absence of apothecia is key for risk assessment<span class="citation" data-cites="willbur2018">(<a href="references.html#ref-willbur2018" role="doc-biblioref">Willbur et al. 2018</a>)</span>. Such events of binary nature can be predicted using risk algorithms that consider weather variables, cultivar susceptibility, soil moisture, etc. A commonly used algorithm is the logistic regression model which deals with a binary classification.</p>
<section id="logistic-regression-ohio-fhb-models" class="level4" data-number="19.4.3.1">
<h4 data-number="19.4.3.1" class="anchored" data-anchor-id="logistic-regression-ohio-fhb-models"><span class="header-section-number">19.4.3.1</span> Logistic regression: Ohio FHB models</h4>
<p>FHB risk models were developed in the United States in the early 2000s to predict the risk of an epidemic, or when disease severity in the field was greater than 10% <span class="citation" data-cites="dewolf2003">(<a href="references.html#ref-dewolf2003" role="doc-biblioref">De Wolf et al. 2003</a>)</span>. In the paper, the epidemic cases were classified as 0 and 1, according to that threshold, and several logistic regression models were fitted to the data using a summary of weather-related variables from two defined periods: seven days prior to flowering date and 10 days following flowering date (50% of wheat heads with anthers).</p>
<p>Among several models, the authors found that a single variable model (model A) exhibited a good accuracy (0.83). The selected variable consisted of a combination of temperature and humidity for the 10-day period after flowering. Named TRH9010, it corresponds to the total number of hours, within the 10-day post-flowering period, when the temperature (T) was &gt;=15 and &lt;= 30 <sup>o</sup>C and relative humidity (RH) was &gt;90%.</p>
<p>Let’s implement this model in R and calculate the probability of infection. As usual, we first need to download hourly data from NASA Power project for a period of three years. Let’s work with data from Wooster, OH, United States.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nasapower)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>weather <span class="ot">&lt;-</span> <span class="fu">get_power</span>(</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">community =</span> <span class="st">"ag"</span>,</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">lonlat =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">81.9399</span>, <span class="fl">40.7982</span>),</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">pars =</span> <span class="fu">c</span>(<span class="st">"RH2M"</span>, <span class="st">"T2M"</span>, <span class="st">"PRECTOTCORR"</span>),</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">dates =</span> <span class="fu">c</span>(<span class="st">"2020-01-01"</span>, <span class="st">"2022-12-31"</span>),</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">temporal_api =</span> <span class="st">"hourly"</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(weather)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>NASA/POWER CERES/MERRA2 Native Resolution Hourly Data  
 Dates (month/day/year): 01/01/2020 through 12/31/2022  
 Location: Latitude  40.7982   Longitude -81.9399  
 Elevation from MERRA-2: Average for 0.5 x 0.625 degree lat/lon region = 309.08 meters 
 The value for missing source data that cannot be computed or is outside of the sources availability range: NA  
 Parameter(s):  
 
 Parameters: 
 RH2M            MERRA-2 Relative Humidity at 2 Meters (%) ;
 T2M             MERRA-2 Temperature at 2 Meters (C) ;
 PRECTOTCORR     MERRA-2 Precipitation Corrected (mm/hour)  
 
# A tibble: 6 × 9
    LON   LAT  YEAR    MO    DY    HR  RH2M   T2M PRECTOTCORR
  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;       &lt;dbl&gt;
1 -81.9  40.8  2020     1     1     0  86.4 -3.55        0.01
2 -81.9  40.8  2020     1     1     1  88.8 -3.92        0.01
3 -81.9  40.8  2020     1     1     2  88.3 -3.74        0.01
4 -81.9  40.8  2020     1     1     3  85.3 -3.49        0   
5 -81.9  40.8  2020     1     1     4  80.2 -3.18        0   
6 -81.9  40.8  2020     1     1     5  75.6 -3.06        0   </code></pre>
</div>
</div>
<p>We can then create a function named <code>calculate_TRH9010()</code>. This function calculates the number of hours when specified condition is met (i.e., hours when 15 &lt;= T &lt;= 30 &amp; RH &gt; 90), the probability (<em>p</em>) of infection, and the classification of the epidemic (<em>epi</em>) as 0 or 1 based on a defined threshold for p (0.36 in this case) <span class="citation" data-cites="dewolf2003">(<a href="references.html#ref-dewolf2003" role="doc-biblioref">De Wolf et al. 2003</a>)</span>. The function’s arguments are the weather data frame, YEAR, MO, and DY, allowing us to estimate the risk for a specific day (the flowering date) within the downloaded period. It’s important to note that, in the original model, the variables were normalized (its value divided by the maximum observed value). Thus, the hour count for TRH9010 should be divided by the constant 136.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>calculate_TRH9010 <span class="ot">&lt;-</span> <span class="cf">function</span>(data, YEAR, MO, DY){</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  start_row <span class="ot">&lt;-</span> <span class="fu">which</span>(data<span class="sc">$</span>YEAR <span class="sc">==</span> YEAR <span class="sc">&amp;</span> data<span class="sc">$</span>MO <span class="sc">==</span> MO <span class="sc">&amp;</span> data<span class="sc">$</span>DY <span class="sc">==</span> DY <span class="sc">&amp;</span> data<span class="sc">$</span>HR <span class="sc">==</span> <span class="dv">0</span>)[<span class="dv">1</span>] </span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> ((<span class="fu">nrow</span>(data) <span class="sc">-</span> start_row) <span class="sc">&lt;</span> <span class="dv">9</span> <span class="sc">*</span> <span class="dv">24</span>){ </span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">TRH9010 =</span> <span class="cn">NA</span>, <span class="at">y =</span> <span class="cn">NA</span>, <span class="at">p =</span> <span class="cn">NA</span>, <span class="at">epi =</span> <span class="cn">NA</span>))</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>  subset_data <span class="ot">&lt;-</span> data[start_row<span class="sc">:</span>(start_row <span class="sc">+</span> <span class="dv">9</span> <span class="sc">*</span> <span class="dv">24</span> <span class="sc">-</span> <span class="dv">1</span>),] </span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>  condition_met <span class="ot">&lt;-</span> <span class="fu">with</span>(subset_data, T2M <span class="sc">&gt;=</span> <span class="dv">15</span> <span class="sc">&amp;</span> T2M <span class="sc">&lt;=</span> <span class="dv">30</span> <span class="sc">&amp;</span> RH2M <span class="sc">&gt;</span> <span class="dv">90</span>)</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>  total_hours <span class="ot">&lt;-</span> <span class="fu">sum</span>(condition_met)</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">3.3756</span> <span class="sc">+</span> <span class="fl">6.8128</span> <span class="sc">*</span> (total_hours <span class="sc">/</span> <span class="dv">136</span>) <span class="co"># divide by maximum of 136 as in the paper</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">exp</span>(y) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(y))</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>  epi <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(p <span class="sc">&gt;</span> <span class="fl">0.36</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">TRH9010 =</span> total_hours, <span class="at">p =</span> p, <span class="at">epi =</span> epi))</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now we apply the function for the 1st of June 2021 as flowering date. The output is the hour count, the probability and the epidemic classification.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">calculate_TRH9010</span>(weather, <span class="at">YEAR =</span> <span class="dv">2021</span>, <span class="at">MO =</span> <span class="dv">6</span>, <span class="at">DY =</span> <span class="dv">1</span>)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>results</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$TRH9010
[1] 62

$p
[1] 0.4329649

$epi
[1] 1</code></pre>
</div>
</div>
<p>We may want to apply the function for a series of days within a given month. Let’s write code to predict the risk for the 15 days of June using a <code>for()</code> loop which will store the results in a list, but we can further transform to a dataframe using <code>map_dfr()</code> function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>num_days <span class="ot">&lt;-</span> <span class="dv">15</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>all_results <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(day <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>num_days){</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  all_results[[<span class="fu">paste0</span>(<span class="st">""</span>, day)]] <span class="ot">&lt;-</span> <span class="fu">calculate_TRH9010</span>(weather, <span class="at">YEAR =</span> <span class="dv">2021</span>, <span class="at">MO =</span> <span class="dv">6</span>, <span class="at">DY =</span> day)</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="co"># transform results to a dataframe</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> all_results <span class="sc">%&gt;%</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map_dfr</span>(<span class="sc">~</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(.)), <span class="at">.id =</span> <span class="st">"day"</span>)</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Change variables  to numeric </span></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>p <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(df<span class="sc">$</span>p)</span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>day <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(df<span class="sc">$</span>day)</span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>epi <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(df<span class="sc">$</span>epi)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Finally we plot the results.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(day, p, <span class="at">fill =</span> <span class="fu">factor</span>(epi))) <span class="sc">+</span> </span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>()<span class="sc">+</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">n.breaks =</span> <span class="dv">15</span>)<span class="sc">+</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"grey60"</span>, <span class="st">"darkred"</span>))<span class="sc">+</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.36</span>, <span class="at">linetype =</span> <span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>  r4pde<span class="sc">::</span><span class="fu">theme_r4pde</span>(<span class="at">font_size =</span> <span class="dv">12</span>)<span class="sc">+</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>,<span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)<span class="sc">+</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Wheat flowering day in june 2021"</span>, <span class="at">y =</span> <span class="st">"Risk probability"</span>,</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Epidemic classification"</span>,</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"FHB risk by Ohio (TRH9010) model"</span>,</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Location: Wooster, Ohio"</span>,</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"Model source: De Wolf et al. (2002)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="prediction-warning-systems_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="mechanistic-models-brazilian-fhb-model" class="level4" data-number="19.4.3.2">
<h4 data-number="19.4.3.2" class="anchored" data-anchor-id="mechanistic-models-brazilian-fhb-model"><span class="header-section-number">19.4.3.2</span> Mechanistic models: Brazilian FHB model</h4>
<p>Different from the previous approach, where statistical models are fitted to data, some models are called mechanistic, dynamic or process-based. These are designed based on the knowledge of the processes of the disease cycle and the factors that affect these processes <span class="citation" data-cites="gonzález-domínguez2023">(<a href="references.html#ref-gonzález-domínguez2023" role="doc-biblioref">González-Domínguez et al. 2023</a>)</span>. These usually operate in a hourly to daily basis and can be quite complex and sophisticated with numerous examples being found in the literature <span class="citation" data-cites="salotti2023 rossi2014 salotti2022 caffi2010 caffi2007">(<a href="references.html#ref-caffi2007" role="doc-biblioref">Caffi et al. 2007</a>, <a href="references.html#ref-caffi2010" role="doc-biblioref">2010</a>; <a href="references.html#ref-rossi2014" role="doc-biblioref">Rossi et al. 2014</a>; <a href="references.html#ref-salotti2022" role="doc-biblioref">Salotti et al. 2022</a>; <a href="references.html#ref-salotti2023" role="doc-biblioref">Salotti and Rossi 2023</a>)</span>.</p>
<p>One example is a mechanistic model for FHB developed in Brazil. In its core, the model is based on the daily simulation of the flowering process, the most vulnerable phase of the wheat crop, and events that contribute to infect the flowers. The original model <span class="citation" data-cites="delponte2005">(<a href="references.html#ref-delponte2005" role="doc-biblioref">Del Ponte et al. 2005</a>)</span> integrates several sub models that estimate the daily proportion of flowers, a density of inoculum in a “spore cloud” and a proportion of infected flowers - all these variables being driven by daily variables of temperature and wetness variables such as rainfall and relative humidity.</p>
<p>A modified, simplified version of the model that takes into account only the flowering process and weather-variables that drives infection, was written in R and is presented here for illustration.</p>
<div id="fig-fhbdiagram" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fhbdiagram-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="imgs/FHB_diagram.png" class="img-fluid quarto-figure quarto-figure-center figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fhbdiagram-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;19.7: A simplified version of a mechanistic Fusarium head blight model that takes into account the amount of flowers on each day which will be infected depending on rules that define a wet period and temperature during the wet period.
</figcaption>
</figure>
</div>
<p>The function <code>simulate_FHB()</code> requires a starting date and weather data frame (adapted here to use NASA Power data set) to run a simulation during 20 days.</p>
<p>Among the several simplifications, which were based on the simulated results of the original model, flowering dynamics was assumed to follow a normal distribution over 10 days, and is adjusted to ensure that the peak in the proportion of anthers is set to 0.8. An adjustment is made so that anthers are set to 0 after the 10th day.</p>
<p><span class="math inline">\([ \text{antherproportions} = \left\{ \begin{array}{ll} \frac{1}{\sigma\sqrt{2\pi}} \exp\left(-\frac{1}{2} \left(\frac{x-\mu}{\sigma}\right)^2\right) &amp; \text{for } x = 1, \ldots, 10 \\ 0 &amp; \text{for } x = 11, \ldots, 20 \end{array} \right. ]\)</span> ,</p>
<p>where <span class="math inline">\(𝞵\)</span> = 6 and <span class="math inline">\(𝝈\)</span> = 2.</p>
<p>The probability of the infection of the flowers is calculated as in the paper. It is based on an equation that considers daily temperature (T) and gives the proportion of flowers getting infected on any given day when a <strong>condition for infection</strong> is met.</p>
<p><span class="math inline">\(INF=0.001029×exp(0.1957×T)\)</span></p>
<p>There are three conditions for an infection event, similar to what is described in the article <span class="citation" data-cites="delponte2005">(<a href="references.html#ref-delponte2005" role="doc-biblioref">Del Ponte et al. 2005</a>)</span>:</p>
<ul>
<li><p><strong>Continuous 2-day Rain &amp; High Humidity</strong>: There should be rain (&gt; 0.5 mm) and the average humidity over two consecutive days should be high (&gt; 80%).</p></li>
<li><p><strong>Rain Followed by Dry Day &amp; High Humidity</strong>: Rain and high humidity (&gt; 80%), followed by a day without rain but still with high humidity (&gt; 85%).</p></li>
<li><p><strong>Dry Day &amp; High Humidity Followed by Rain</strong>: A day without rain but with high humidity (&gt; 85%), followed by a day with both rain and high humidity (&gt; 80%).</p></li>
</ul>
<p>Infection then occurs when any of the above conditions are met. In this simpler version (without the inoculum factor), the proportion of infected spikelets, assuming that infected anthers will give rise to infected spikelets, is given by</p>
<p><span class="math inline">\(InfectedSpikelets = AntherProportions×INF\)</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>simulate_FHB <span class="ot">&lt;-</span> <span class="cf">function</span>(start_date, weather_data) {</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  start_date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(start_date, <span class="at">format =</span> <span class="st">"%Y-%m-%d"</span>)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract weather data for 30 days starting from the provided start_date</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>  weather_subset <span class="ot">&lt;-</span> <span class="fu">subset</span>(weather_data, YYYYMMDD <span class="sc">&gt;=</span> start_date <span class="sc">&amp;</span> YYYYMMDD <span class="sc">&lt;</span> start_date <span class="sc">+</span> <span class="dv">20</span>)</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Simulation for 20 days</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">20</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Normal distribution formula for 10 days using fixed peak day (mu) and spread (sigma)</span></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>  mu <span class="ot">&lt;-</span> <span class="dv">6</span></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>  sigma <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>anther_proportions <span class="ot">&lt;-</span> <span class="fu">c</span>((<span class="dv">1</span> <span class="sc">/</span> (sigma <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="dv">2</span> <span class="sc">*</span> pi))) <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="fl">0.5</span> <span class="sc">*</span> ((x[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>] <span class="sc">-</span> mu) <span class="sc">/</span> sigma)<span class="sc">^</span><span class="dv">2</span>), <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">10</span>))</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Adjust the values to have a peak of 0.8</span></span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a> max_value <span class="ot">&lt;-</span> <span class="fu">max</span>(anther_proportions)</span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>scaling_factor <span class="ot">&lt;-</span> <span class="fl">0.8</span> <span class="sc">/</span> max_value</span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a>anther_proportions <span class="ot">&lt;-</span> anther_proportions <span class="sc">*</span> scaling_factor <span class="co"># This scales the entire vector</span></span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Zero out the anthers after the day they should be zero</span></span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a>  anther_proportions[<span class="dv">11</span><span class="sc">:</span><span class="dv">20</span>] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb23-24"><a href="#cb23-24" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate the INF value</span></span>
<span id="cb23-25"><a href="#cb23-25" aria-hidden="true" tabindex="-1"></a>  INF <span class="ot">&lt;-</span> <span class="fl">0.001029</span> <span class="sc">*</span> <span class="fu">exp</span>(<span class="fl">0.1957</span> <span class="sc">*</span> weather_subset<span class="sc">$</span>T2M)</span>
<span id="cb23-26"><a href="#cb23-26" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb23-27"><a href="#cb23-27" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate average RH for two consecutive days</span></span>
<span id="cb23-28"><a href="#cb23-28" aria-hidden="true" tabindex="-1"></a>  avg_RH2M_2days <span class="ot">&lt;-</span> (weather_subset<span class="sc">$</span>RH2M <span class="sc">+</span> <span class="fu">c</span>(weather_subset<span class="sc">$</span>RH2M[<span class="sc">-</span><span class="dv">1</span>], <span class="cn">NA</span>)) <span class="sc">/</span> <span class="dv">2</span></span>
<span id="cb23-29"><a href="#cb23-29" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb23-30"><a href="#cb23-30" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Check conditions for infection</span></span>
<span id="cb23-31"><a href="#cb23-31" aria-hidden="true" tabindex="-1"></a>  condition1 <span class="ot">&lt;-</span> (weather_subset<span class="sc">$</span>PRECTOTCORR <span class="sc">&gt;</span> <span class="fl">0.3</span>) <span class="sc">&amp;</span> (avg_RH2M_2days <span class="sc">&gt;</span> <span class="dv">80</span>)</span>
<span id="cb23-32"><a href="#cb23-32" aria-hidden="true" tabindex="-1"></a>  consecutive_rain_high_humidity <span class="ot">&lt;-</span> condition1 <span class="sc">&amp;</span> <span class="fu">c</span>(<span class="cn">FALSE</span>, <span class="fu">head</span>(condition1, <span class="sc">-</span><span class="dv">1</span>))</span>
<span id="cb23-33"><a href="#cb23-33" aria-hidden="true" tabindex="-1"></a>  preceded_condition <span class="ot">&lt;-</span> (weather_subset<span class="sc">$</span>PRECTOTCORR <span class="sc">&gt;</span> <span class="fl">0.3</span>) <span class="sc">&amp;</span> (avg_RH2M_2days <span class="sc">&gt;</span> <span class="dv">80</span>) <span class="sc">&amp;</span></span>
<span id="cb23-34"><a href="#cb23-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(<span class="cn">FALSE</span>, <span class="fu">head</span>(weather_subset<span class="sc">$</span>RH2M, <span class="sc">-</span><span class="dv">1</span>) <span class="sc">&gt;</span> <span class="dv">85</span>) <span class="sc">&amp;</span></span>
<span id="cb23-35"><a href="#cb23-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(<span class="fu">head</span>(weather_subset<span class="sc">$</span>PRECTOTCORR, <span class="sc">-</span><span class="dv">1</span>) <span class="sc">&lt;=</span> <span class="fl">0.3</span>, <span class="cn">FALSE</span>)</span>
<span id="cb23-36"><a href="#cb23-36" aria-hidden="true" tabindex="-1"></a>  succeeded_condition <span class="ot">&lt;-</span> (weather_subset<span class="sc">$</span>PRECTOTCORR <span class="sc">&gt;</span> <span class="fl">0.3</span>) <span class="sc">&amp;</span> (avg_RH2M_2days <span class="sc">&gt;</span> <span class="dv">80</span>) <span class="sc">&amp;</span></span>
<span id="cb23-37"><a href="#cb23-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(<span class="fu">tail</span>(weather_subset<span class="sc">$</span>RH2M, <span class="sc">-</span><span class="dv">1</span>) <span class="sc">&gt;</span> <span class="dv">85</span>, <span class="cn">FALSE</span>) <span class="sc">&amp;</span></span>
<span id="cb23-38"><a href="#cb23-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(<span class="cn">FALSE</span>, <span class="fu">tail</span>(weather_subset<span class="sc">$</span>PRECTOTCORR, <span class="sc">-</span><span class="dv">1</span>) <span class="sc">&lt;=</span> <span class="fl">0.3</span>)</span>
<span id="cb23-39"><a href="#cb23-39" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb23-40"><a href="#cb23-40" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Combine conditions</span></span>
<span id="cb23-41"><a href="#cb23-41" aria-hidden="true" tabindex="-1"></a>  infection_trigger <span class="ot">&lt;-</span> consecutive_rain_high_humidity <span class="sc">==</span> <span class="dv">1</span> <span class="sc">|</span> preceded_condition <span class="sc">|</span> succeeded_condition</span>
<span id="cb23-42"><a href="#cb23-42" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb23-43"><a href="#cb23-43" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate infected anthers based on conditions</span></span>
<span id="cb23-44"><a href="#cb23-44" aria-hidden="true" tabindex="-1"></a>  infected_spikelets <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(infection_trigger, anther_proportions <span class="sc">*</span> INF, <span class="dv">0</span>)</span>
<span id="cb23-45"><a href="#cb23-45" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb23-46"><a href="#cb23-46" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Cumulative infected anthers</span></span>
<span id="cb23-47"><a href="#cb23-47" aria-hidden="true" tabindex="-1"></a>  cumulative_infected_spikelets <span class="ot">&lt;-</span> <span class="fu">cumsum</span>(infected_spikelets)</span>
<span id="cb23-48"><a href="#cb23-48" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb23-49"><a href="#cb23-49" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Compile results</span></span>
<span id="cb23-50"><a href="#cb23-50" aria-hidden="true" tabindex="-1"></a>  result_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb23-51"><a href="#cb23-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">Date =</span> weather_subset<span class="sc">$</span>YYYYMMDD,</span>
<span id="cb23-52"><a href="#cb23-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">T2M =</span> weather_subset<span class="sc">$</span>T2M,</span>
<span id="cb23-53"><a href="#cb23-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">RAIN =</span> weather_subset<span class="sc">$</span>PRECTOTCORR,</span>
<span id="cb23-54"><a href="#cb23-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">RH2M =</span> weather_subset<span class="sc">$</span>RH2M,</span>
<span id="cb23-55"><a href="#cb23-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">Flowers =</span> <span class="fu">round</span>(anther_proportions,<span class="dv">3</span>),</span>
<span id="cb23-56"><a href="#cb23-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">InfSpikelets =</span> <span class="fu">round</span>(infected_spikelets,<span class="dv">3</span>),</span>
<span id="cb23-57"><a href="#cb23-57" aria-hidden="true" tabindex="-1"></a>    <span class="at">CumInfSpikelets =</span> <span class="fu">round</span>(cumulative_infected_spikelets, <span class="dv">3</span>)</span>
<span id="cb23-58"><a href="#cb23-58" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb23-59"><a href="#cb23-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(result_df)</span>
<span id="cb23-60"><a href="#cb23-60" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s download the data again for the location of Wooster, Ohio during a 9-year period.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nasapower)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>wooster <span class="ot">&lt;-</span> <span class="fu">get_power</span>(</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">community =</span> <span class="st">"ag"</span>,</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">lonlat =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">81.9399</span>, <span class="fl">40.7982</span>),</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">pars =</span> <span class="fu">c</span>(<span class="st">"RH2M"</span>, <span class="st">"T2M"</span>, <span class="st">"PRECTOTCORR"</span>),</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">dates =</span> <span class="fu">c</span>(<span class="st">"2015-01-01"</span>, <span class="st">"2023-09-30"</span>),</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">temporal_api =</span> <span class="st">"daily"</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>wooster</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>NASA/POWER CERES/MERRA2 Native Resolution Daily Data  
 Dates (month/day/year): 01/01/2015 through 09/30/2023  
 Location: Latitude  40.7982   Longitude -81.9399  
 Elevation from MERRA-2: Average for 0.5 x 0.625 degree lat/lon region = 309.08 meters 
 The value for missing source data that cannot be computed or is outside of the sources availability range: NA  
 Parameter(s):  
 
 Parameters: 
 RH2M            MERRA-2 Relative Humidity at 2 Meters (%) ;
 T2M             MERRA-2 Temperature at 2 Meters (C) ;
 PRECTOTCORR     MERRA-2 Precipitation Corrected (mm/day)  
 
# A tibble: 3,195 × 10
     LON   LAT  YEAR    MM    DD   DOY YYYYMMDD    RH2M    T2M PRECTOTCORR
   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;date&gt;     &lt;dbl&gt;  &lt;dbl&gt;       &lt;dbl&gt;
 1 -81.9  40.8  2015     1     1     1 2015-01-01  67.4  -5.04        0   
 2 -81.9  40.8  2015     1     2     2 2015-01-02  79.8  -2.1         0   
 3 -81.9  40.8  2015     1     3     3 2015-01-03  94     1.96       25.7 
 4 -81.9  40.8  2015     1     4     4 2015-01-04  88.9   3.89        8.65
 5 -81.9  40.8  2015     1     5     5 2015-01-05  63.1  -9.22        0.54
 6 -81.9  40.8  2015     1     6     6 2015-01-06  76.6  -9.92        2.3 
 7 -81.9  40.8  2015     1     7     7 2015-01-07  70.9 -12.3         0.58
 8 -81.9  40.8  2015     1     8     8 2015-01-08  72.2 -13.7         0.54
 9 -81.9  40.8  2015     1     9     9 2015-01-09  75.6 -10.8         1.41
10 -81.9  40.8  2015     1    10    10 2015-01-10  78.6 -14.2         0.02
# ℹ 3,185 more rows</code></pre>
</div>
</div>
<p>Now that we have the data, we can simulate FHB for a specific start flowering date.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>start_date <span class="ot">&lt;-</span> <span class="st">"2018-05-15"</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">simulate_FHB</span>(start_date, wooster)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(result, <span class="dv">15</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         Date   T2M  RAIN  RH2M Flowers InfSpikelets CumInfSpikelets
1  2018-05-15 19.08  4.11 88.19   0.035        0.000           0.000
2  2018-05-16 17.19  0.09 84.75   0.108        0.000           0.000
3  2018-05-17 18.76  0.05 80.50   0.260        0.000           0.000
4  2018-05-18 18.50  0.15 82.75   0.485        0.000           0.000
5  2018-05-19 19.95  9.49 86.50   0.706        0.000           0.000
6  2018-05-20 16.60  1.43 87.38   0.800        0.021           0.021
7  2018-05-21 17.75 15.55 83.50   0.706        0.023           0.045
8  2018-05-22 19.94  9.70 87.06   0.485        0.025           0.069
9  2018-05-23 16.47  0.05 76.00   0.260        0.000           0.069
10 2018-05-24 20.43  0.00 60.81   0.108        0.000           0.069
11 2018-05-25 21.20  0.03 68.94   0.000        0.000           0.069
12 2018-05-26 21.05  9.51 86.19   0.000        0.000           0.069
13 2018-05-27 23.13  0.60 80.81   0.000        0.000           0.069
14 2018-05-28 25.53  0.01 73.81   0.000        0.000           0.069
15 2018-05-29 24.91  0.01 80.69   0.000        0.000           0.069</code></pre>
</div>
</div>
<p>Finally we can plot the dynamics of the flowering and the percent of infected spikelets during the period of 20 days after first flowers appear in the field.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting the data</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> result <span class="sc">|&gt;</span> </span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Date)) <span class="sc">+</span> </span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="fu">aes</span>(<span class="at">y =</span> Flowers,  </span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">color =</span> <span class="st">"Proportion of flowers"</span>),</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">linewidth =</span> <span class="dv">1</span>, <span class="at">fill =</span> <span class="st">"yellow"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> CumInfSpikelets, </span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>                <span class="at">color =</span> <span class="st">"Cum. Infected Spikelets"</span>), </span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">linewidth =</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"FHB simulation model"</span>,</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">"% Infected spikelets = "</span>, </span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">round</span>(<span class="fu">max</span>(result<span class="sc">$</span>CumInfSpikelets<span class="sc">*</span><span class="dv">100</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),<span class="dv">2</span>), <span class="st">"%"</span>),</span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Proportion"</span>, <span class="at">x =</span> <span class="st">"Date"</span>, <span class="at">color =</span> <span class="st">"Legend"</span>) <span class="sc">+</span></span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>  r4pde<span class="sc">::</span><span class="fu">theme_r4pde</span>(<span class="at">font_size =</span> <span class="dv">12</span>)<span class="sc">+</span></span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> result <span class="sc">|&gt;</span> </span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Date))<span class="sc">+</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">x =</span> Date, <span class="at">y =</span> RAIN))<span class="sc">+</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> T2M))<span class="sc">+</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> RH2M), <span class="at">linetype =</span> <span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Value"</span>, </span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Rain, T and RH"</span>)<span class="sc">+</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>  r4pde<span class="sc">::</span><span class="fu">theme_r4pde</span>(<span class="at">font_size =</span> <span class="dv">12</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">/</span> p2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="prediction-warning-systems_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>As in the previous section, we can apply the function for a series of days and see how the percent of infected spikelets fluctuates over time considering each day as a starting day for flowering.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Vector of dates</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>dates_vector <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">as.Date</span>(<span class="st">"2019-05-15"</span>), <span class="fu">as.Date</span>(<span class="st">"2019-05-30"</span>), <span class="at">by=</span><span class="st">"days"</span>)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply function and extract max cumulative infection</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>max_cumulative_infections <span class="ot">&lt;-</span> <span class="fu">sapply</span>(dates_vector, <span class="cf">function</span>(date) {</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>  result <span class="ot">&lt;-</span> <span class="fu">simulate_FHB</span>(date, wooster)</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">max</span>(result<span class="sc">$</span>CumInfSpikelets, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>df_results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">Date =</span> dates_vector,</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">MaxCumulativeInfection =</span> max_cumulative_infections</span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the results</span></span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>df_results <span class="sc">|&gt;</span> </span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(Date, MaxCumulativeInfection<span class="sc">*</span><span class="dv">100</span>))<span class="sc">+</span></span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">fill =</span> <span class="st">"darkred"</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>)<span class="sc">+</span></span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"FHB simulation model"</span>, </span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Wooster, Ohio - 2019"</span>,</span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">"Starting day of flowering"</span>, <span class="at">y =</span> <span class="st">"% Infected Spikelets"</span>)<span class="sc">+</span></span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a>  r4pde<span class="sc">::</span><span class="fu">theme_r4pde</span>(<span class="at">font_size =</span> <span class="dv">14</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="prediction-warning-systems_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="practical-considerations" class="level2" data-number="19.5">
<h2 data-number="19.5" class="anchored" data-anchor-id="practical-considerations"><span class="header-section-number">19.5</span> Practical considerations</h2>
<p>While initial disease warning systems faced underuse, this was attributed to their primary deployment by advisors rather than growers directly, and an evolution where users, through experience, develop simplified rules that diminish the need for constant system consultation. Notable examples, such as the CPO in Denmark and FARMSCAPE in Australia, have documented this learning process, leading to less reliance on such tools. Growers often favor ‘good enough’ solutions that evolve from system use, which may reduce the need for direct interaction with the system over time.</p>
<p>However, certain diseases with specific control timing requirements, regulatory pressures, or those affecting high-value crops necessitate direct engagement with warning systems. In these scenarios, growers prioritize yield consistency and economic security over reduced pesticide usage, especially when faced with asymmetric risks associated with incorrect management decisions. It has been suggested that disease warning systems might be more beneficial and accepted for crops of intermediate or lower value, where the cost of mismanagement is more balanced. Essential to the success and adoption of these systems is the active involvement of end-users throughout the development process to ensure the system’s features align with their practical farming goals and constraints.</p>


<div id="refs" class="references csl-bib-body" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-bourke1970" class="csl-entry" role="listitem">
Bourke, P. M. A. 1970. Use of Weather Information in the Prediction of Plant Disease Epiphytotics. Annual Review of Phytopathology 8:345–370. <a href="https://doi.org/10.1146/annurev.py.08.090170.002021">https://doi.org/10.1146/annurev.py.08.090170.002021</a>.
</div>
<div id="ref-caffi2007" class="csl-entry" role="listitem">
Caffi, T., Rossi, V., Cossu, A., and Fronteddu, F. 2007. Empirical vs. mechanistic models for primary infections of <span> <em>Plasmopara viticola</em></span>*. EPPO Bulletin 37:261–271. <a href="https://doi.org/10.1111/j.1365-2338.2007.01120.x">https://doi.org/10.1111/j.1365-2338.2007.01120.x</a>.
</div>
<div id="ref-caffi2010" class="csl-entry" role="listitem">
Caffi, T., Rossi, V., Legler, S. E., and Bugiani, R. 2010. A mechanistic model simulating ascosporic infections by <span><em>Erysiphe necator</em></span>, the powdery mildew fungus of grapevine. Plant Pathology 60:522–531. <a href="https://doi.org/10.1111/j.1365-3059.2010.02395.x">https://doi.org/10.1111/j.1365-3059.2010.02395.x</a>.
</div>
<div id="ref-Campbell1990" class="csl-entry" role="listitem">
Campbell, C. L., and Madden. L., V. 1990. <em>Introduction to plant disease epidemiology</em>. Wiley.
</div>
<div id="ref-derossi2022" class="csl-entry" role="listitem">
De Rossi, R. L., Guerra, F. A., Plazas, M. C., Vuletic, E. E., Brücher, E., Guerra, G. D., and Reis, E. M. 2022. Crop damage, economic losses, and the economic damage threshold for northern corn leaf blight. Crop Protection 154:105901. <a href="https://doi.org/10.1016/j.cropro.2021.105901">https://doi.org/10.1016/j.cropro.2021.105901</a>.
</div>
<div id="ref-dewolf2003" class="csl-entry" role="listitem">
De Wolf, E. D., Madden, L. V., and Lipps, P. E. 2003. Risk Assessment Models for Wheat Fusarium Head Blight Epidemics Based on Within-Season Weather Data. Phytopathology® 93:428–435. <a href="https://doi.org/10.1094/phyto.2003.93.4.428">https://doi.org/10.1094/phyto.2003.93.4.428</a>.
</div>
<div id="ref-delponte2005" class="csl-entry" role="listitem">
Del Ponte, E. M., Fernandes, J. M. C., and Pavan, W. 2005. A risk infection simulation model for fusarium head blight of wheat. Fitopatologia Brasileira 30:634–642. <a href="https://doi.org/10.1590/s0100-41582005000600011">https://doi.org/10.1590/s0100-41582005000600011</a>.
</div>
<div id="ref-gonzález-domínguez2023" class="csl-entry" role="listitem">
González-Domínguez, E., Caffi, T., Rossi, V., Salotti, I., and Fedele, G. 2023. Plant Disease Models and Forecasting: Changes in Principles and Applications over the Last 50 Years. Phytopathology® 113:678–693. <a href="https://doi.org/10.1094/phyto-10-22-0362-kd">https://doi.org/10.1094/phyto-10-22-0362-kd</a>.
</div>
<div id="ref-krause1975" class="csl-entry" role="listitem">
Krause, R. A., and Massie, L. B. 1975. Predictive Systems: Modern Approaches to Disease Control. Annual Review of Phytopathology 13:31–47. <a href="https://doi.org/10.1146/annurev.py.13.090175.000335">https://doi.org/10.1146/annurev.py.13.090175.000335</a>.
</div>
<div id="ref-krause1975blitecast" class="csl-entry" role="listitem">
Krause, R. A., Massie, L. B., and Hyre, R. A. 1975. BLITECAST: A computerized forecast of potato late blight. The Plant Disease Reporter 59:95.
</div>
<div id="ref-leiminger2012" class="csl-entry" role="listitem">
Leiminger, J. H., and Hausladen, H. 2012. Early Blight Control in Potato Using Disease-Orientated Threshold Values. Plant Disease 96:124–130. <a href="https://doi.org/10.1094/pdis-05-11-0431">https://doi.org/10.1094/pdis-05-11-0431</a>.
</div>
<div id="ref-madden1978" class="csl-entry" role="listitem">
Madden, L. 1978. FAST, a forecast system for alternaria solani on tomato. Phytopathology 68:1354. <a href="https://doi.org/10.1094/phyto-68-1354">https://doi.org/10.1094/phyto-68-1354</a>.
</div>
<div id="ref-mumford1984" class="csl-entry" role="listitem">
Mumford, J. D., and Norton, G. A. 1984. Economics of Decision Making in Pest Management. Annual Review of Entomology 29:157–174. <a href="https://doi.org/10.1146/annurev.en.29.010184.001105">https://doi.org/10.1146/annurev.en.29.010184.001105</a>.
</div>
<div id="ref-nutter1993terms" class="csl-entry" role="listitem">
Nutter, F., Teng, P., and Royer, M. 1993. <a href="http://doi.org/10.1094/PD-77-211">Terms and concepts for yield, crop loss, and disease thresholds</a>. Plant Disease 77:193–211.
</div>
<div id="ref-pedigo1986" class="csl-entry" role="listitem">
Pedigo, L. P., Hutchins, S. H., and Higley, L. G. 1986. Economic Injury Levels in Theory and Practice. Annual Review of Entomology 31:341–368. <a href="https://doi.org/10.1146/annurev.en.31.010186.002013">https://doi.org/10.1146/annurev.en.31.010186.002013</a>.
</div>
<div id="ref-reis2002modelo" class="csl-entry" role="listitem">
Reis, E. M., Hoffmann, L. L., and Blum, M. 2002. Modelo de ponto crítico para estimar os danos causados pelo oídio em cevada. Fitopatologia Brasileira 27:644–646.
</div>
<div id="ref-rossi2014" class="csl-entry" role="listitem">
Rossi, V., Onesti, G., Legler, S. E., and Caffi, T. 2014. Use of systems analysis to develop plant disease models based on literature data: grape black-rot as a case-study. European Journal of Plant Pathology 141:427–444. <a href="https://doi.org/10.1007/s10658-014-0553-z">https://doi.org/10.1007/s10658-014-0553-z</a>.
</div>
<div id="ref-salotti2022" class="csl-entry" role="listitem">
Salotti, I., Bove, F., and Rossi, V. 2022. Development and validation of a mechanistic, weather-based model for predicting puccinia graminis f. Sp. Tritici infections and stem rust progress in wheat. Frontiers in Plant Science 13. <a href="https://doi.org/10.3389/fpls.2022.897680">https://doi.org/10.3389/fpls.2022.897680</a>.
</div>
<div id="ref-salotti2023" class="csl-entry" role="listitem">
Salotti, I., and Rossi, V. 2023. A Mechanistic Model Accounting for the Effect of Soil Moisture, Weather, and Host Growth Stage on the Development of <span><em>Sclerotinia sclerotiorum</em></span>. Plant Disease 107:514–533. <a href="https://doi.org/10.1094/pdis-12-21-2743-re">https://doi.org/10.1094/pdis-12-21-2743-re</a>.
</div>
<div id="ref-wallin1962" class="csl-entry" role="listitem">
Wallin, J. R. 1962. Summary of recent progress in predicting late blight epidemics in United States and Canada. American Potato Journal 39:306–312. <a href="https://doi.org/10.1007/bf02862155">https://doi.org/10.1007/bf02862155</a>.
</div>
<div id="ref-willbur2018" class="csl-entry" role="listitem">
Willbur, J. F., Fall, M. L., Bloomingdale, C., Byrne, A. M., Chapman, S. A., Isard, S. A., Magarey, R. D., McCaghey, M. M., Mueller, B. D., Russo, J. M., Schlegel, J., Chilvers, M. I., Mueller, D. S., Kabbage, M., and Smith, D. L. 2018. Weather-Based Models for Assessing the Risk of <span><em>Sclerotinia sclerotiorum</em></span> Apothecial Presence in Soybean (<span><em>Glycine max</em></span>) Fields. Plant Disease 102:73–84. <a href="https://doi.org/10.1094/pdis-04-17-0504-re">https://doi.org/10.1094/pdis-04-17-0504-re</a>.
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./yieldloss-regression-models.html" class="pagination-link" aria-label="Statistical models">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Statistical models</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./prediction-disease-modeling.html" class="pagination-link" aria-label="Disease modeling">
        <span class="nav-page-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Disease modeling</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>R4PDE - R for Plant Disease Epidemiology is written by Emerson Del Ponte</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/emdelponte/epidemiology-R/edit/main/prediction-warning-systems.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/emdelponte/epidemiology-R/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
<p>This book was built with <a href="https://quarto.org/">Quarto</a>.</p>
</div>
  </div>
</footer>




</body></html>