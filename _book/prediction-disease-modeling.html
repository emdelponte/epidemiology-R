<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.39">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>20&nbsp; Disease modeling – R4PDE.net</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./references.html" rel="next">
<link href="./prediction-warning-systems.html" rel="prev">
<link href="./cover.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-e26003cea8cd680ca0c55a263523d882.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-183445eade4fe70077aec9335180dcde.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-5T7SZYQV79"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-5T7SZYQV79', { 'anonymize_ip': true});
</script>
<link href="site_libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="site_libs/htmlwidgets-1.6.3/htmlwidgets.js"></script>
<script src="site_libs/plotly-binding-4.10.4/plotly.js"></script>
<script src="site_libs/typedarray-0.1/typedarray.min.js"></script>
<script src="site_libs/jquery-3.5.1/jquery.min.js"></script>
<link href="site_libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet">
<script src="site_libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="site_libs/plotly-main-2.11.1/plotly-latest.min.js"></script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./prediction-warning-systems.html">Disease prediction</a></li><li class="breadcrumb-item"><a href="./prediction-disease-modeling.html"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Disease modeling</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">R4PDE.net</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/emdelponte/epidemiology-R" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
    <div class="dropdown">
      <a href="" title="Share" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label="Share"><i class="bi bi-share"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://twitter.com/intent/tweet?url=|url|">
              <i class="bi bi-twitter pe-1"></i>
            Twitter
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.linkedin.com/sharing/share-offsite/?url=|url|">
              <i class="bi bi-linkedin pe-1"></i>
            LinkedIn
            </a>
          </li>
      </ul>
    </div>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cite.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">How to cite</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./author.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">About the author</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./acknowledgements.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Acknowledgements</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false">
 <span class="menu-text">Epidemic data</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-terminology.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Disease variables</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-ordinal.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Ordinal scales</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-actual-severity.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Measuring foliar severity</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-accuracy.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Reliability and accuracy</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-sads.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Standard area diagrams</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-training.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Training sessions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-remote-sensing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Remote sensing</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false">
 <span class="menu-text">Temporal analysis</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./temporal-dpc.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Disease progress curves</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./temporal-models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Population models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./temporal-fitting.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Model fitting</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false">
 <span class="menu-text">Spatial analysis</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./spatial-gradients.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Spatial gradients</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./spatial-models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Gradient models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./spatial-fitting.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Fitting gradient models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./spatial-patterns.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Spatial patterns</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./spatial-tests.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Tests for patterns</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false">
 <span class="menu-text">Epidemics and yield</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./yieldloss-concepts.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Definitions and concepts</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./yieldloss-regression-models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Statistical models</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true">
 <span class="menu-text">Disease prediction</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./prediction-warning-systems.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Warning systems</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./prediction-disease-modeling.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Disease modeling</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"><span class="header-section-number">20.1</span> Introduction</a></li>
  <li><a href="#controlled-environment" id="toc-controlled-environment" class="nav-link" data-scroll-target="#controlled-environment"><span class="header-section-number">20.2</span> Controlled environment</a>
  <ul>
  <li><a href="#infection-based-models" id="toc-infection-based-models" class="nav-link" data-scroll-target="#infection-based-models"><span class="header-section-number">20.2.1</span> Infection-based models</a>
  <ul>
  <li><a href="#temperature-effects" id="toc-temperature-effects" class="nav-link" data-scroll-target="#temperature-effects"><span class="header-section-number">20.2.1.1</span> Temperature effects</a>
  <ul class="collapse">
  <li><a href="#generalized-beta-function" id="toc-generalized-beta-function" class="nav-link" data-scroll-target="#generalized-beta-function"><span class="header-section-number">20.2.1.1.1</span> Generalized beta-function</a></li>
  <li><a href="#analytis-beta-function" id="toc-analytis-beta-function" class="nav-link" data-scroll-target="#analytis-beta-function"><span class="header-section-number">20.2.1.1.2</span> Analytis beta function</a></li>
  </ul></li>
  <li><a href="#moisture-effects" id="toc-moisture-effects" class="nav-link" data-scroll-target="#moisture-effects"><span class="header-section-number">20.2.1.2</span> Moisture effects</a>
  <ul class="collapse">
  <li><a href="#monomolecular-function" id="toc-monomolecular-function" class="nav-link" data-scroll-target="#monomolecular-function"><span class="header-section-number">20.2.1.2.1</span> Monomolecular function</a></li>
  <li><a href="#weibull-function" id="toc-weibull-function" class="nav-link" data-scroll-target="#weibull-function"><span class="header-section-number">20.2.1.2.2</span> Weibull function</a></li>
  </ul></li>
  <li><a href="#integrating-temperature-and-wetness-effects" id="toc-integrating-temperature-and-wetness-effects" class="nav-link" data-scroll-target="#integrating-temperature-and-wetness-effects"><span class="header-section-number">20.2.1.3</span> Integrating temperature and wetness effects</a></li>
  <li><a href="#magareys-generic-infection-model" id="toc-magareys-generic-infection-model" class="nav-link" data-scroll-target="#magareys-generic-infection-model"><span class="header-section-number">20.2.1.4</span> Magarey’s generic infection model</a></li>
  </ul></li>
  <li><a href="#latency-period-models" id="toc-latency-period-models" class="nav-link" data-scroll-target="#latency-period-models"><span class="header-section-number">20.2.2</span> Latency period models</a>
  <ul>
  <li><a href="#parabolic-function" id="toc-parabolic-function" class="nav-link" data-scroll-target="#parabolic-function"><span class="header-section-number">20.2.2.1</span> Parabolic function</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#field-data" id="toc-field-data" class="nav-link" data-scroll-target="#field-data"><span class="header-section-number">20.3</span> Field data</a>
  <ul>
  <li><a href="#variable-creation-and-selection" id="toc-variable-creation-and-selection" class="nav-link" data-scroll-target="#variable-creation-and-selection"><span class="header-section-number">20.3.1</span> Variable creation and selection</a>
  <ul>
  <li><a href="#window-pane" id="toc-window-pane" class="nav-link" data-scroll-target="#window-pane"><span class="header-section-number">20.3.1.1</span> Window-pane</a>
  <ul class="collapse">
  <li><a href="#variable-construction" id="toc-variable-construction" class="nav-link" data-scroll-target="#variable-construction"><span class="header-section-number">20.3.1.1.1</span> Variable construction</a></li>
  <li><a href="#correlations-and-multiple-hypothesis-test" id="toc-correlations-and-multiple-hypothesis-test" class="nav-link" data-scroll-target="#correlations-and-multiple-hypothesis-test"><span class="header-section-number">20.3.1.1.2</span> Correlations and multiple hypothesis test</a></li>
  </ul></li>
  <li><a href="#functional-data-analysis" id="toc-functional-data-analysis" class="nav-link" data-scroll-target="#functional-data-analysis"><span class="header-section-number">20.3.1.2</span> Functional data analysis</a>
  <ul class="collapse">
  <li><a href="#function-on-scalar-regression" id="toc-function-on-scalar-regression" class="nav-link" data-scroll-target="#function-on-scalar-regression"><span class="header-section-number">20.3.1.2.1</span> Function-on-scalar regression</a></li>
  <li><a href="#interval-test-procedure" id="toc-interval-test-procedure" class="nav-link" data-scroll-target="#interval-test-procedure"><span class="header-section-number">20.3.1.2.2</span> Interval test procedure</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#model-fitting" id="toc-model-fitting" class="nav-link" data-scroll-target="#model-fitting"><span class="header-section-number">20.3.2</span> Model fitting</a>
  <ul>
  <li><a href="#logistic-regression-models" id="toc-logistic-regression-models" class="nav-link" data-scroll-target="#logistic-regression-models"><span class="header-section-number">20.3.2.1</span> Logistic regression models</a>
  <ul class="collapse">
  <li><a href="#data-preparation" id="toc-data-preparation" class="nav-link" data-scroll-target="#data-preparation"><span class="header-section-number">20.3.2.1.1</span> Data preparation</a></li>
  <li><a href="#model-fitting-1" id="toc-model-fitting-1" class="nav-link" data-scroll-target="#model-fitting-1"><span class="header-section-number">20.3.2.1.2</span> Model fitting</a></li>
  <li><a href="#model-evaluation" id="toc-model-evaluation" class="nav-link" data-scroll-target="#model-evaluation"><span class="header-section-number">20.3.2.1.3</span> Model evaluation</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/emdelponte/epidemiology-R/edit/main/prediction-disease-modeling.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/emdelponte/epidemiology-R/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./prediction-warning-systems.html">Disease prediction</a></li><li class="breadcrumb-item"><a href="./prediction-disease-modeling.html"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Disease modeling</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Disease modeling</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="introduction" class="level2" data-number="20.1">
<h2 data-number="20.1" class="anchored" data-anchor-id="introduction"><span class="header-section-number">20.1</span> Introduction</h2>
<p>As seen in the previous chapter, plant disease modeling is a crucial tool for predicting disease dynamics and informing management decisions when integrated into decision support systems. By leveraging models, researchers and practitioners can anticipate disease outbreaks, assess potential risks, and implement timely interventions to mitigate losses <span class="citation" data-cites="savary2018 rossi2010a">(<a href="references.html#ref-rossi2010a" role="doc-biblioref">Rossi et al. 2010</a>; <a href="references.html#ref-savary2018" role="doc-biblioref">Savary et al. 2018</a>)</span>.</p>
<p>Mathematical modeling involves representing empirical phenomena and experimental outcomes using mathematical functions. The data used for these models may be collected specifically for modeling purposes or drawn from existing experiments and observations originally conducted to address different research questions, with such data often found in the literature <span class="citation" data-cites="hau1990">(<a href="references.html#ref-hau1990" role="doc-biblioref">Hau and Kranz 1990</a>)</span>.</p>
<p>Mathematical models integrating plant, disease, and environmental - in most cases weather-based variables - factors have been developed since the mid-1900s (See recent review by <span class="citation" data-cites="gonzález-domínguez2023">González-Domínguez et al. (<a href="references.html#ref-gonzález-domínguez2023" role="doc-biblioref">2023</a>)</span> ). Dynamic modeling of disease epidemics gained traction in the early 1960s with foundational work by Vanderplank and Zadoks, setting the stage for future advancements. Since then, researchers have contributed extensively to model development, mainly focusing on the plant disease cycle which outline pathogen development stages, such as dormancy, reproduction, dispersal, and pathogenesis, driven by interactions among host, pathogen, and environmental factors <span class="citation" data-cites="dewolf2007">(<a href="references.html#ref-dewolf2007" role="doc-biblioref">De Wolf and Isard 2007</a>)</span>.</p>
<p>A systematic map by <span class="citation" data-cites="fedele2022a">Fedele et al. (<a href="references.html#ref-fedele2022a" role="doc-biblioref">2022</a>)</span> identified over 750 papers on plant disease models, primarily aimed at understanding system interactions (n = 680). This map revealed that while most models focus on system understanding, fewer are devoted to tactical management (n = 40), strategic planning (n = 38), or scenario analysis (n = 9).</p>
<p>In terms of model development, we can classify the models into two main groups based on the approach taken <span class="citation" data-cites="gonzález-domínguez2023">(<a href="references.html#ref-gonzález-domínguez2023" role="doc-biblioref">González-Domínguez et al. 2023</a>)</span>: Empirical or mechanistic approaches, which differ fundamentally in their basis, complexity and application (<a href="#fig-approaches_modeling" class="quarto-xref">Figure&nbsp;<span>20.1</span></a>).</p>
<div id="fig-approaches_modeling" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-approaches_modeling-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="imgs/modeling-fig1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="614">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-approaches_modeling-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;20.1: Steps of model development from data collection to modeling based on statistical relationships (data-driven) between data collected from field or controlled environment to mechanistic approach based on the elements of the disease cycles (concept-driven).
</figcaption>
</figure>
</div>
<p><strong>Empirical models</strong>, which emerged in the mid-20th century, rely on data-driven statistical relationships between variables collected under varying field or controlled environments. These models often lack cause-effect understanding, making them less robust and requiring rigorous validation and calibration when applied in diverse environments, especially in regions that did not provide data for model construction. The parameters of the model change every time new data are incorporated during model development.</p>
<p>In contrast, <strong>mechanistic models</strong>, developed from a deep understanding of biological and epidemiological processes, explain disease dynamics based on known system behaviors in response to external variables—a concept-driven approach. These dynamic models quantitatively characterize the state of the pathosystem over time, offering generally more robust predictions by utilizing mathematical equations to describe how epidemics evolve under varying environmental conditions.</p>
<p>Both empirical and mechanistic approaches are valid methodologies extensively used in plant pathology research. The choice between these approaches depends on several factors, including data availability, urgency in model development, and, frequently, the researcher’s experience or preference. Empirical models focus on statistical relationships derived directly from data, whereas mechanistic models aim to represent the biological processes of disease progression through linked mathematical equations.</p>
<p>In mechanistic modeling, the equations used to predict specific disease components—such as infection frequency or the latency period—are often empirically derived from controlled experiments. For example, an infection frequency equation is typically based on data collected under specific environmental conditions, with models fitted to accurately describe observed patterns. These process-based models are then built by integrating empirically-derived equations or rules, which collectively simulate the disease cycle. Data and equations are sourced from published studies or generated from new experiments conducted by researchers.</p>
<p>Beyond their practical predictive value, mechanistic models are valuable tools for organizing existing knowledge about a particular disease, helping to identify gaps and guide future research efforts. An example of such work is the extensive collection of comprehensive mechanistic models developed for various plant diseases by the research group led by Prof.&nbsp;Vittorio Rossi in Italy <span class="citation" data-cites="rossi2008 rossi2014 salotti2023 salotti2022">(<a href="references.html#ref-rossi2008" role="doc-biblioref">Rossi et al. 2008</a>, <a href="references.html#ref-rossi2014" role="doc-biblioref">2014</a>; <a href="references.html#ref-salotti2022" role="doc-biblioref">Salotti et al. 2022</a>; <a href="references.html#ref-salotti2023" role="doc-biblioref">Salotti and Rossi 2023</a>)</span>.</p>
<p>This chapter focuses mainly on empirical modeling. We begin by examining the types of data utilized in model development, focusing on those collected under controlled conditions, such as replicated laboratory or growth chamber experiments, as well as field data collected from several locations and years. We will also analyze real-world case studies, drawing on examples from the literature to replicate and understand model applications. Through these examples, we aim to illustrate the process of fitting models to data and underscore the role of modeling in advancing plant disease management practices.</p>
</section>
<section id="controlled-environment" class="level2" data-number="20.2">
<h2 data-number="20.2" class="anchored" data-anchor-id="controlled-environment"><span class="header-section-number">20.2</span> Controlled environment</h2>
<p>In this section, we will demonstrate, using examples from the literature, how statistical models can be fitted to data that represent various stages of the disease cycle.</p>
<p>Research on disease-environment interactions under controlled conditions - such as laboratory or growth chamber studies - lays the groundwork for building foundational models, including infection-based models and sub-models for specific processes like dormancy, dispersal, infection, and latency <span class="citation" data-cites="krause1975 magarey2005 dewolf2007">(<a href="references.html#ref-dewolf2007" role="doc-biblioref">De Wolf and Isard 2007</a>; <a href="references.html#ref-krause1975" role="doc-biblioref">Krause and Massie 1975</a>; <a href="references.html#ref-magarey2005" role="doc-biblioref">Magarey et al. 2005</a>)</span>.</p>
<p>Growth chambers and phytotrons are essential for testing the effects of individual variables, though these controlled results may not fully replicate field conditions. Anyway, laboratory experiments help clarify specific questions by isolating interactions, unlike complex field trials where host, pathogen, and environment factors interact. Polycyclic or “mini epidemic” experiments enable observation of disease dynamics under targeted conditions <span class="citation" data-cites="hau1990 rotem1988">(<a href="references.html#ref-hau1990" role="doc-biblioref">Hau and Kranz 1990</a>; <a href="references.html#ref-rotem1988" role="doc-biblioref">Rotem 1988</a>)</span>.</p>
<p>Once developed, these sub-models can be incorporated into larger mechanistic models that simulate the entire disease cycle, thereby mimicking disease progression over time <span class="citation" data-cites="rossi2008 salotti2023">(<a href="references.html#ref-rossi2008" role="doc-biblioref">Rossi et al. 2008</a>; <a href="references.html#ref-salotti2023" role="doc-biblioref">Salotti and Rossi 2023</a>)</span>. Alternatively, sub-models can also be used in stand-alone predictive systems where the process being modeled - such as infection - is the key factor in determining disease occurrence <span class="citation" data-cites="machardy1989 magarey2007">(<a href="references.html#ref-machardy1989" role="doc-biblioref">MacHardy 1989</a>; <a href="references.html#ref-magarey2007" role="doc-biblioref">Magarey and Sutton 2007</a>)</span>. For example, infection sub-models can be integrated into prediction systems that help schedule crop protection measures by forecasting when infection risk is highest.</p>
<section id="infection-based-models" class="level3" data-number="20.2.1">
<h3 data-number="20.2.1" class="anchored" data-anchor-id="infection-based-models"><span class="header-section-number">20.2.1</span> Infection-based models</h3>
<p>To model infection potential based on environmental factors, simple rules can be used with daily weather data, such as temperature and rainfall thresholds <span class="citation" data-cites="magarey2002">(<a href="references.html#ref-magarey2002" role="doc-biblioref">Magarey et al. 2002</a>)</span>. Simple decision aids, such as charts and graphs, also exist to help model infection potential by using combinations of daily average temperature and hours of wetness. These tools offer a straightforward approach to evaluate infection risks based on readily available weather data, supporting decision-making without complex modeling <span class="citation" data-cites="seem1984">(<a href="references.html#ref-seem1984" role="doc-biblioref">Seem 1984</a>)</span>. However, for many pathogens, hourly data is needed, requiring complex models that track favorable conditions hour by hour. These models start with specific triggers and can reset due to conditions like dryness or low humidity, simulating a biological clock for infection risk assessment <span class="citation" data-cites="magarey2007">(<a href="references.html#ref-magarey2007" role="doc-biblioref">Magarey and Sutton 2007</a>)</span>.</p>
<p>Modeling approaches vary based on available data and model goals. A common method is the matrix approach, like the Wallin potato late blight model, which uses rows for temperature and columns for moisture duration to estimate disease severity <span class="citation" data-cites="krause1975">(<a href="references.html#ref-krause1975" role="doc-biblioref">Krause and Massie 1975</a>)</span> (see previous chapter on <a href="https://r4pde.net/prediction-warning-systems">warning systems</a>). Bailey enhanced this with an interactive matrix that combines temperature, relative humidity, and duration to assess infection risk across pathogens, making it versatile for various modeling needs <span class="citation" data-cites="bailey1999">(<a href="references.html#ref-bailey1999" role="doc-biblioref">Bailey 1999</a>)</span>.</p>
<p>When infection responses are measured at various temperature and wetness combinations, regression models can be developed to predict infection rates. These models often use polynomial, logistic, or complex three-dimensional response surface equations to represent the relationship between environmental conditions and infection potential. In an excellent review title “<em>How to create and deploy infection models for plant pathogen</em>s” <span class="citation" data-cites="magarey2007">Magarey and Sutton (<a href="references.html#ref-magarey2007" role="doc-biblioref">2007</a>)</span> discusses that many modeling approaches lack biological foundations and are not generic, making them unsuitable for developing a unified set of disease forecast models. While three-dimensional response surfaces, such as those created with sufficient temperature-moisture observations, offer detailed infection responses, they are often too complex and data-intensive for widespread use (seeTable 1 adapted from <span class="citation" data-cites="magarey2007">Magarey and Sutton (<a href="references.html#ref-magarey2007" role="doc-biblioref">2007</a>)</span>).</p>
<table class="caption-top table">
<caption>Comparison of different infection modeling approaches. Source: <span class="citation" data-cites="magarey2007">Magarey and Sutton (<a href="references.html#ref-magarey2007" role="doc-biblioref">2007</a>)</span></caption>
<colgroup>
<col style="width: 26%">
<col style="width: 41%">
<col style="width: 31%">
</colgroup>
<thead>
<tr class="header">
<th>Approach</th>
<th>Strengths</th>
<th>Weaknesses</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Matrix <span class="citation" data-cites="krause1975 mills1944 windels1998">(<a href="references.html#ref-krause1975" role="doc-biblioref">Krause and Massie 1975</a>; <a href="references.html#ref-mills1944" role="doc-biblioref">Mills 1944</a>; <a href="references.html#ref-windels1998" role="doc-biblioref">Windels et al. 1998</a>)</span></td>
<td>Easy; converts moisture/temperature combinations into severity values or risk categories. Tried and true approach.</td>
<td>Data to populate matrix may not be readily available.</td>
</tr>
<tr class="even">
<td>Regression:<br>– Polynomial <span class="citation" data-cites="evans1992">(<a href="references.html#ref-evans1992" role="doc-biblioref">Evans 1992</a>)</span><br>– Logistic <span class="citation" data-cites="bulger1987">(<a href="references.html#ref-bulger1987" role="doc-biblioref">Bulger 1987</a>)</span></td>
<td>Widely used in plant pathology. Available for many economically important pathogens.</td>
<td>Parameters not biologically based. Requires dataset for development.</td>
</tr>
<tr class="odd">
<td>Three-dimensional response surface <span class="citation" data-cites="duthie1997">(<a href="references.html#ref-duthie1997" role="doc-biblioref">Duthie 1997</a>)</span></td>
<td>Describes infection response in detail.</td>
<td>Parameters not biologically based. Complex, requires extensive data and processing time.</td>
</tr>
<tr class="even">
<td>Degree wet hours <span class="citation" data-cites="pfender2003">(<a href="references.html#ref-pfender2003" role="doc-biblioref">Pfender 2003</a>)</span></td>
<td>Simple; based on degree hours, commonly used in entomology. Requires only Tmin and Tmax</td>
<td>Recently developed; assumes linear thermal response.</td>
</tr>
<tr class="odd">
<td>Temperature-moisture response function <span class="citation" data-cites="magarey2005">(<a href="references.html#ref-magarey2005" role="doc-biblioref">Magarey et al. 2005</a>)</span></td>
<td>Simple; based on crop modeling functions, requires only Tmin, Topt and Tmax</td>
<td>Recently developed.</td>
</tr>
</tbody>
</table>
<p>In the following sections, I will demonstrate how various biologically meaningful models fit infection data, using temperature, wetness duration, or a combination of both as predictors.</p>
<section id="temperature-effects" class="level4" data-number="20.2.1.1">
<h4 data-number="20.2.1.1" class="anchored" data-anchor-id="temperature-effects"><span class="header-section-number">20.2.1.1</span> Temperature effects</h4>
<section id="generalized-beta-function" class="level5" data-number="20.2.1.1.1">
<h5 data-number="20.2.1.1.1" class="anchored" data-anchor-id="generalized-beta-function"><span class="header-section-number">20.2.1.1.1</span> Generalized beta-function</h5>
<p>Among several non-linear models that can be fitted to infection responses to temperature, the generalized beta-function is an interesting alternative <span class="citation" data-cites="hau1990">(<a href="references.html#ref-hau1990" role="doc-biblioref">Hau and Kranz 1990</a>)</span>. This is a nonlinear model with five parameters. Two of them, namely <span class="math inline">\(b\)</span> and <span class="math inline">\(c\)</span> , have a biological meaning because they are estimates of the minimum and maximum temperature of the biological process under consideration.</p>
<p>We will use a subset of the data obtained from a study conducted under controlled conditions that aimed to assess the influence of temperature on the symptom development of citrus canker in sweet orange <span class="citation" data-cites="dallapria2006">(<a href="references.html#ref-dallapria2006" role="doc-biblioref">Dalla Pria et al. 2006</a>)</span>. The data used here is only for severity on the cultivar Hamlin (plot a in <a href="#fig-temperature" class="quarto-xref">Figure&nbsp;<span>20.2</span></a>). The data was extracted using the R package {digitize} as shown <a href="https://twitter.com/edelponte/status/1580320409794539520?s=20&amp;t=KqjJPmwzFVKm8Gu7Ss-P6A">here on this tweet</a>.</p>
<div id="fig-temperature" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-temperature-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="imgs/modeling-fig_temperature.gif" class="img-fluid quarto-figure quarto-figure-center figure-img" width="441">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-temperature-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;20.2: Effect of temperature (12, 15, 20, 25, 30, 35 or 40°C) on disease severity of citrus canker on sweet orange cvs Hamlin (a), Natal (b), Pera (c) and Valencia (d) with a leaf wetness duration of 24 h. Each point represents the mean of three repetitions. Vertical bars represent standard errors. Lines show the generalized beta function fitted to data. Source: <span class="citation" data-cites="dallapria2006">Dalla Pria et al. (<a href="references.html#ref-dallapria2006" role="doc-biblioref">2006</a>)</span>
</figcaption>
</figure>
</div>
<p>Let’s enter the data manually. Where <span class="math inline">\(t\)</span> is the temperature and <span class="math inline">\(y\)</span> is the severity on leaves.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>temp <span class="ot">&lt;-</span> tibble<span class="sc">::</span><span class="fu">tribble</span>(</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="sc">~</span>t, <span class="sc">~</span>y,</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fl">12.0</span>, <span class="fl">0.00</span>,</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fl">15.0</span>, <span class="fl">0.1</span>,</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fl">20.0</span>, <span class="fl">0.5</span>,</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fl">25.0</span>, <span class="fl">1.2</span>,</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fl">30.0</span>, <span class="fl">1.5</span>,</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fl">35.0</span>, <span class="fl">1.2</span>,</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fl">40.0</span>, <span class="fl">0.1</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Fit the generalized beta-function <span class="citation" data-cites="hau1990">(<a href="references.html#ref-hau1990" role="doc-biblioref">Hau and Kranz 1990</a>)</span>. The model can be written as:</p>
<p><span class="math display">\[
y = a*((t - b )^d)*((c - t)^e)
\]</span></p>
<p>where <span class="math inline">\(b\)</span> and <span class="math inline">\(c\)</span> represent minimum and maximum temperatures, respectively, for the development of the disease, <span class="math inline">\(a\)</span>, <span class="math inline">\(d\)</span> and <span class="math inline">\(e\)</span> are parameters to be estimated, <span class="math inline">\(t\)</span> is the temperature and <span class="math inline">\(y\)</span> is disease severity. We need the {minpack.lm} library to avoid parameterization issues.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(minpack.lm)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>fit_temp <span class="ot">&lt;-</span> <span class="fu">nlsLM</span>(</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  y <span class="sc">~</span> a <span class="sc">*</span> ((t <span class="sc">-</span> b) <span class="sc">^</span> d) <span class="sc">*</span> ((c <span class="sc">-</span> t) <span class="sc">^</span> e),</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">start =</span> <span class="fu">list</span>(</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">a =</span> <span class="dv">0</span>,</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">b =</span> <span class="dv">10</span>,</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">c =</span> <span class="dv">40</span>,</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">d =</span> <span class="fl">1.5</span>,</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">e =</span> <span class="dv">1</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">algorithm =</span> <span class="st">"port"</span>,</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> temp</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_temp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Formula: y ~ a * ((t - b)^d) * ((c - t)^e)

Parameters:
   Estimate Std. Error t value Pr(&gt;|t|)    
a  0.001303   0.006295   0.207    0.855    
b 11.999999   4.875414   2.461    0.133    
c 40.137236   0.346763 115.748 7.46e-05 ***
d  1.760101   1.193017   1.475    0.278    
e  0.830868   0.445213   1.866    0.203    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.1121 on 2 degrees of freedom

Algorithm "port", convergence message: Relative error between `par' and the solution is at most `ptol'.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>modelr<span class="sc">::</span><span class="fu">rsquare</span>(fit_temp, temp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9898275</code></pre>
</div>
</div>
<p>Store the model parameters in objects.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>fit_temp<span class="sc">$</span>m<span class="sc">$</span><span class="fu">getAllPars</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          a           b           c           d           e 
 0.00130259 11.99999931 40.13723602  1.76010097  0.83086798 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> fit_temp<span class="sc">$</span>m<span class="sc">$</span><span class="fu">getAllPars</span>()[<span class="dv">1</span>]</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> fit_temp<span class="sc">$</span>m<span class="sc">$</span><span class="fu">getAllPars</span>()[<span class="dv">2</span>]</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>c <span class="ot">&lt;-</span> fit_temp<span class="sc">$</span>m<span class="sc">$</span><span class="fu">getAllPars</span>()[<span class="dv">3</span>]</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> fit_temp<span class="sc">$</span>m<span class="sc">$</span><span class="fu">getAllPars</span>()[<span class="dv">4</span>]</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>e <span class="ot">&lt;-</span> fit_temp<span class="sc">$</span>m<span class="sc">$</span><span class="fu">getAllPars</span>()[<span class="dv">5</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Create a data frame for predictions at each temperature unit from 10 to 45 degree Celsius.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">10</span>, <span class="dv">45</span>, <span class="fl">0.1</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> a <span class="sc">*</span> ((t <span class="sc">-</span> b) <span class="sc">^</span> d) <span class="sc">*</span> ((c <span class="sc">-</span> t) <span class="sc">^</span> e)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(t, y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Plot the observed and predicted data using {ggplot2} package.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(r4pde)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>dat <span class="sc">|&gt;</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(t, y)) <span class="sc">+</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> temp, <span class="fu">aes</span>(t, y)) <span class="sc">+</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_r4pde</span>(<span class="at">font_size =</span> <span class="dv">16</span>) <span class="sc">+</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Temperature"</span>, <span class="at">y =</span> <span class="st">"Severity"</span>,</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Generalized beta-function"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="prediction-disease-modeling_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="analytis-beta-function" class="level5" data-number="20.2.1.1.2">
<h5 data-number="20.2.1.1.2" class="anchored" data-anchor-id="analytis-beta-function"><span class="header-section-number">20.2.1.1.2</span> Analytis beta function</h5>
<p><span class="citation" data-cites="ji2023a">Ji et al. (<a href="references.html#ref-ji2023a" role="doc-biblioref">2023</a>)</span> tested and compared various mathematical equations to describe the response of mycelial growth to temperature for several fungi associated with Grapevine trunk diseases. The authors found that the beta equation <span class="citation" data-cites="analytis1977">(<a href="references.html#ref-analytis1977" role="doc-biblioref">Analytis 1977</a>)</span> provided the best fit and, therefore, was considered the most suitable for all fungi.</p>
<p>The model equation for re-scaled severity (0 to 1) as a function of temperature is given by:</p>
<p><span class="math inline">\(Y = \left( a \cdot T_{eq}^b \cdot (1 - T_{eq}) \right)^c \quad ; \quad \text{if } Y &gt; 1, \text{ then } Y = 1\)</span></p>
<p>where</p>
<p><span class="math inline">\(T_{eq} = \frac{T - T_{\text{min}}}{T_{\text{max}} - T_{\text{min}}}\)</span></p>
<p><span class="math inline">\(T\)</span> is the temperature in degrees Celsius. <span class="math inline">\(T_{\text{min}}\)</span> is the minimum temperature, <span class="math inline">\(T_{\text{max}}\)</span> is the maximum temperature for severity. The <span class="math inline">\(a\)</span> , <span class="math inline">\(b\)</span> , and <span class="math inline">\(c\)</span> are parameters that define the top, symmetry, and size of the unimodal curve.</p>
<p>Let’s rescale (0 to 1) the data on the citrus canker using the function rescale of the {scales} package.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'scales'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:purrr':

    discard</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:readr':

    col_factor</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>temp<span class="sc">$</span>yscaled <span class="ot">&lt;-</span> <span class="fu">rescale</span>(temp<span class="sc">$</span>y)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>temp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7 × 3
      t     y yscaled
  &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;
1    12   0    0     
2    15   0.1  0.0667
3    20   0.5  0.333 
4    25   1.2  0.8   
5    30   1.5  1     
6    35   1.2  0.8   
7    40   0.1  0.0667</code></pre>
</div>
</div>
<p>Now we can fit the model using the same <code>nlsLM</code> function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the minimum and maximum temperatures</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>Tmin <span class="ot">&lt;-</span> <span class="dv">12</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>Tmax <span class="ot">&lt;-</span> <span class="dv">40</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(minpack.lm)</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>fit_temp2 <span class="ot">&lt;-</span> <span class="fu">nlsLM</span>(</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>  yscaled <span class="sc">~</span> (a <span class="sc">*</span> ((t <span class="sc">-</span> Tmin) <span class="sc">/</span> (Tmax <span class="sc">-</span> Tmin))<span class="sc">^</span>b <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> ((t <span class="sc">-</span> Tmin) <span class="sc">/</span> (Tmax <span class="sc">-</span> Tmin))))<span class="sc">^</span>c,</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> temp,</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">start =</span> <span class="fu">list</span>(<span class="at">a =</span> <span class="dv">1</span>, <span class="at">b =</span> <span class="dv">2</span>, <span class="at">c =</span> <span class="dv">3</span>), <span class="co"># Initial guesses for parameters</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">algorithm =</span> <span class="st">"port"</span> </span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_temp2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Formula: yscaled ~ (a * ((t - Tmin)/(Tmax - Tmin))^b * (1 - ((t - Tmin)/(Tmax - 
    Tmin))))^c

Parameters:
  Estimate Std. Error t value Pr(&gt;|t|)    
a   6.7625     0.3218  21.013 3.03e-05 ***
b   1.9648     0.1030  19.072 4.45e-05 ***
c   1.1607     0.1507   7.701  0.00153 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.03955 on 4 degrees of freedom

Algorithm "port", convergence message: Relative error in the sum of squares is at most `ftol'.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>modelr<span class="sc">::</span><span class="fu">rsquare</span>(fit_temp2, temp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9948325</code></pre>
</div>
</div>
<p>Lets’s store the model parameters in objects.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>fit_temp2<span class="sc">$</span>m<span class="sc">$</span><span class="fu">getAllPars</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       a        b        c 
6.762509 1.964817 1.160702 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> fit_temp2<span class="sc">$</span>m<span class="sc">$</span><span class="fu">getAllPars</span>()[<span class="dv">1</span>]</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> fit_temp2<span class="sc">$</span>m<span class="sc">$</span><span class="fu">getAllPars</span>()[<span class="dv">2</span>]</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>c <span class="ot">&lt;-</span> fit_temp2<span class="sc">$</span>m<span class="sc">$</span><span class="fu">getAllPars</span>()[<span class="dv">3</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Again, we create a data frame for predictions at each temperature unit from 10 to 45 degree Celsius.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>Tmin <span class="ot">&lt;-</span> <span class="dv">12</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>Tmax <span class="ot">&lt;-</span> <span class="dv">40</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">10</span>, <span class="dv">45</span>, <span class="fl">0.1</span>)</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> (a <span class="sc">*</span> ((t <span class="sc">-</span> Tmin) <span class="sc">/</span> (Tmax <span class="sc">-</span> Tmin))<span class="sc">^</span>b <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> ((t <span class="sc">-</span> Tmin) <span class="sc">/</span> (Tmax <span class="sc">-</span> Tmin))))<span class="sc">^</span>c</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>dat2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(t, y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>And now we can plot the observed and predicted data using {ggplot2} package.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(r4pde)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>dat2 <span class="sc">|&gt;</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(t, y)) <span class="sc">+</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> temp, <span class="fu">aes</span>(t, yscaled)) <span class="sc">+</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_r4pde</span>(<span class="at">font_size =</span> <span class="dv">16</span>) <span class="sc">+</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Temperature"</span>, <span class="at">y =</span> <span class="st">"Scaled severity"</span>, </span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Analytis beta function"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="prediction-disease-modeling_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="moisture-effects" class="level4" data-number="20.2.1.2">
<h4 data-number="20.2.1.2" class="anchored" data-anchor-id="moisture-effects"><span class="header-section-number">20.2.1.2</span> Moisture effects</h4>
<section id="monomolecular-function" class="level5" data-number="20.2.1.2.1">
<h5 data-number="20.2.1.2.1" class="anchored" data-anchor-id="monomolecular-function"><span class="header-section-number">20.2.1.2.1</span> Monomolecular function</h5>
<p>For this example, we will use a subset of the data obtained from a study conducted under controlled conditions that aimed to assess the effects of moisture duration on the symptom development of citrus canker in sweet orange <span class="citation" data-cites="dallapria2006">(<a href="references.html#ref-dallapria2006" role="doc-biblioref">Dalla Pria et al. 2006</a>)</span>. As in the previous example for temperature effects, the data used here is only for severity on the cultivar Hamlin (plot a in <a href="#fig-moisture" class="quarto-xref">Figure&nbsp;<span>20.3</span></a>). The data was also extracted using the R package digitize.</p>
<p>Let’s look at the original data and the predictions by the model fitted in the paper.</p>
<div id="fig-moisture" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-moisture-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="imgs/modeling-fig2.gif" class="img-fluid quarto-figure quarto-figure-center figure-img" width="516">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-moisture-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;20.3: Effect of leaf wetness duration (0, 4, 8, 12, 16, 20 or 24 h) on disease severity of citrus canker on sweet orange cvs Hamlin (a), Natal (b), Pera (c) and Valencia (d) at 30°C. Each point represents the mean of three repetitions. Vertical bars represent standard errors. Lines show the monomolecular model fitted to data. Source: <span class="citation" data-cites="dallapria2006">Dalla Pria et al. (<a href="references.html#ref-dallapria2006" role="doc-biblioref">2006</a>)</span>
</figcaption>
</figure>
</div>
<p>For this pattern in the data, we will fit a three-parameter asymptotic regression model. These models describe a limited growth, where y approaches an horizontal asymptote as x tends to infinity. This equation is also known as Monomolecular Growth, Mitscherlich law or von Bertalanffy law. See <a href="https://www.statforbiology.com/nonlinearregression/usefulequations">this tutorial</a> for comprehensive information about fitting several non-linear regression models in R.</p>
<p>Again, we enter the data manually. The 𝑥x is wetness duration in hours and 𝑦y is severity.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>wet <span class="ot">&lt;-</span> tibble<span class="sc">::</span><span class="fu">tribble</span>(<span class="sc">~</span> x, <span class="sc">~</span> y,</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>                       <span class="dv">0</span> ,  <span class="dv">0</span>,</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>                       <span class="dv">4</span> ,  <span class="fl">0.50</span>,</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>                       <span class="dv">8</span> ,  <span class="fl">0.81</span>,</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>                       <span class="dv">12</span>,  <span class="fl">1.50</span>,</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>                       <span class="dv">16</span>,  <span class="fl">1.26</span>,</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>                       <span class="dv">20</span>,  <span class="fl">2.10</span>,</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>                       <span class="dv">24</span>,  <span class="fl">1.45</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The model can be written as:</p>
<p><span class="math inline">\(y = c1 + (d1-c1)*(1-exp(-x/e1))\)</span></p>
<p>where <span class="math inline">\(c\)</span> is the lower limit (at <span class="math inline">\(x = 0\)</span>), the parameter <span class="math inline">\(d\)</span> is the upper limit and the parameter <span class="math inline">\(e\)</span> (greater than 0) is determining the steepness of the increase as <span class="math inline">\(x\)</span>.</p>
<p>We will solve the model again using the <code>nlsLM</code> function. We should provide initial values for the three parameters.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>fit_wet <span class="ot">&lt;-</span> <span class="fu">nlsLM</span>(y <span class="sc">~</span> c1 <span class="sc">+</span> (d1 <span class="sc">-</span> c1) <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span>x <span class="sc">/</span> e1)),</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">start =</span> <span class="fu">list</span>(<span class="at">c1 =</span> <span class="fl">0.5</span>,</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>                              <span class="at">d1 =</span> <span class="dv">3</span>,</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>                              <span class="at">e1 =</span> <span class="dv">1</span>),</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> wet)</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_wet)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Formula: y ~ c1 + (d1 - c1) * (1 - exp(-x/e1))

Parameters:
   Estimate Std. Error t value Pr(&gt;|t|)  
c1 -0.04898    0.31182  -0.157   0.8828  
d1  2.00746    0.70594   2.844   0.0467 *
e1 11.63694    9.33183   1.247   0.2804  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.3296 on 4 degrees of freedom

Number of iterations to convergence: 7 
Achieved convergence tolerance: 1.49e-08</code></pre>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>modelr<span class="sc">::</span><span class="fu">rsquare</span>(fit_wet, wet)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8532282</code></pre>
</div>
</div>
<p>Store the value of the parameters in the respective object.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>HW <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">24</span>, <span class="fl">0.1</span>)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>c1 <span class="ot">&lt;-</span>  fit_wet<span class="sc">$</span>m<span class="sc">$</span><span class="fu">getAllPars</span>()[<span class="dv">1</span>]</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>d1 <span class="ot">&lt;-</span> fit_wet<span class="sc">$</span>m<span class="sc">$</span><span class="fu">getAllPars</span>()[<span class="dv">2</span>]</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>e1 <span class="ot">&lt;-</span> fit_wet<span class="sc">$</span>m<span class="sc">$</span><span class="fu">getAllPars</span>()[<span class="dv">3</span>]</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span>  (c1 <span class="sc">+</span> (d1 <span class="sc">-</span> c1) <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span>HW <span class="sc">/</span> e1)))</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>dat2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(HW, y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now we can plot the predictions and the original data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>dat2 <span class="sc">|&gt;</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(HW, y)) <span class="sc">+</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> wet, <span class="fu">aes</span>(x, y)) <span class="sc">+</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_r4pde</span>(<span class="at">font_size =</span> <span class="dv">16</span>) <span class="sc">+</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Wetness duration"</span>, <span class="at">y =</span> <span class="st">"Severity"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="prediction-disease-modeling_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="weibull-function" class="level5" data-number="20.2.1.2.2">
<h5 data-number="20.2.1.2.2" class="anchored" data-anchor-id="weibull-function"><span class="header-section-number">20.2.1.2.2</span> Weibull function</h5>
<p>In the study by <span class="citation" data-cites="ji2021 ji2023a">(<a href="references.html#ref-ji2021" role="doc-biblioref">Ji et al. 2021</a>, <a href="references.html#ref-ji2023a" role="doc-biblioref">2023</a>)</span>, a Weibull model was fitted to the re-scaled data (0 to 1) on the effect of moisture duration on spore germination or infection. Let’s keep working with the re-scaled data on the citrus canker.</p>
<p>The model is given by:</p>
<p><span class="math inline">\(y = 1 - \exp(-(a \cdot x)^b)\)</span></p>
<p>where <span class="math inline">\(y\)</span> is the response variable, <span class="math inline">\(x\)</span> is the moist duration, <span class="math inline">\(a\)</span> is the scale parameter influencing the rate of infection and <span class="math inline">\(b\)</span> is the shape parameter affecting the curve’s shape and acceleration</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>wet<span class="sc">$</span>yscaled <span class="ot">&lt;-</span> <span class="fu">rescale</span>(wet<span class="sc">$</span>y) </span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>wet</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7 × 3
      x     y yscaled
  &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;
1     0  0      0    
2     4  0.5    0.238
3     8  0.81   0.386
4    12  1.5    0.714
5    16  1.26   0.6  
6    20  2.1    1    
7    24  1.45   0.690</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>fit_wet2 <span class="ot">&lt;-</span> <span class="fu">nlsLM</span>(</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>  yscaled <span class="sc">~</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span>(a <span class="sc">*</span> x)<span class="sc">^</span>b),</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> wet,</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">start =</span> <span class="fu">list</span>(<span class="at">a =</span> <span class="dv">1</span>, <span class="at">b =</span> <span class="dv">2</span>),  <span class="co"># Initial guesses for parameters a and b</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_wet2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Formula: yscaled ~ 1 - exp(-(a * x)^b)

Parameters:
  Estimate Std. Error t value Pr(&gt;|t|)   
a  0.07684    0.01296    5.93  0.00195 **
b  1.07610    0.37103    2.90  0.03378 * 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.1404 on 5 degrees of freedom

Number of iterations to convergence: 26 
Achieved convergence tolerance: 1.49e-08</code></pre>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>modelr<span class="sc">::</span><span class="fu">rsquare</span>(fit_wet2, wet)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8534077</code></pre>
</div>
</div>
<p>Set the value of the parameters in the respective objects</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">24</span>, <span class="fl">0.1</span>)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span>  fit_wet2<span class="sc">$</span>m<span class="sc">$</span><span class="fu">getAllPars</span>()[<span class="dv">1</span>]</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> fit_wet2<span class="sc">$</span>m<span class="sc">$</span><span class="fu">getAllPars</span>()[<span class="dv">2</span>]</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span>  <span class="dv">1</span> <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span>(a <span class="sc">*</span> x)<span class="sc">^</span>b)</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>dat3 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(x, y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>dat3 <span class="sc">|&gt;</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(x, y)) <span class="sc">+</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> wet, <span class="fu">aes</span>(x, yscaled)) <span class="sc">+</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_r4pde</span>(<span class="at">font_size =</span> <span class="dv">16</span>) <span class="sc">+</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Wetness duration"</span>, <span class="at">y =</span> <span class="st">"Scaled severity"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="prediction-disease-modeling_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="integrating-temperature-and-wetness-effects" class="level4" data-number="20.2.1.3">
<h4 data-number="20.2.1.3" class="anchored" data-anchor-id="integrating-temperature-and-wetness-effects"><span class="header-section-number">20.2.1.3</span> Integrating temperature and wetness effects</h4>
<p>The equations developed for the separate effects can be integrated to create a surface response curve or a simple contour plot. Let’s first integrate the generalized beta and the monomolecular models for the original severity data for the citrus canker experiment.</p>
<p>First, we need a data frame for the interaction between temperature <span class="math inline">\(t\)</span> and hours of wetness <span class="math inline">\(hw\)</span>. Then, we obtain the disease value for each combination of <span class="math inline">\(t\)</span> and <span class="math inline">\(hw\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">40</span>, <span class="dv">40</span>)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>hw <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">40</span>, <span class="at">each =</span> <span class="dv">40</span>)</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a><span class="co"># let's fit the two models again and store the parameters in objects</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Temperature effects</span></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>fit_temp <span class="ot">&lt;-</span> <span class="fu">nlsLM</span>(</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>  y <span class="sc">~</span> a <span class="sc">*</span> ((t <span class="sc">-</span> b) <span class="sc">^</span> d) <span class="sc">*</span> ((c <span class="sc">-</span> t) <span class="sc">^</span> e),</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">start =</span> <span class="fu">list</span>(</span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">a =</span> <span class="dv">0</span>,</span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">b =</span> <span class="dv">10</span>,</span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">c =</span> <span class="dv">40</span>,</span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">d =</span> <span class="fl">1.5</span>,</span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">e =</span> <span class="dv">1</span></span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">algorithm =</span> <span class="st">"port"</span>,</span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> temp</span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb41-18"><a href="#cb41-18" aria-hidden="true" tabindex="-1"></a>fit_temp<span class="sc">$</span>m<span class="sc">$</span><span class="fu">getAllPars</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          a           b           c           d           e 
 0.00130259 11.99999931 40.13723602  1.76010097  0.83086798 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> fit_temp<span class="sc">$</span>m<span class="sc">$</span><span class="fu">getAllPars</span>()[<span class="dv">1</span>]</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> fit_temp<span class="sc">$</span>m<span class="sc">$</span><span class="fu">getAllPars</span>()[<span class="dv">2</span>]</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>c <span class="ot">&lt;-</span> fit_temp<span class="sc">$</span>m<span class="sc">$</span><span class="fu">getAllPars</span>()[<span class="dv">3</span>]</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> fit_temp<span class="sc">$</span>m<span class="sc">$</span><span class="fu">getAllPars</span>()[<span class="dv">4</span>]</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>e <span class="ot">&lt;-</span> fit_temp<span class="sc">$</span>m<span class="sc">$</span><span class="fu">getAllPars</span>()[<span class="dv">5</span>]</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a><span class="do">## Moist duration effects</span></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>fit_wet <span class="ot">&lt;-</span> <span class="fu">nlsLM</span>(y <span class="sc">~</span> c1 <span class="sc">+</span> (d1 <span class="sc">-</span> c1) <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span>x <span class="sc">/</span> e1)),</span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>                 <span class="at">start =</span> <span class="fu">list</span>(<span class="at">c1 =</span> <span class="fl">0.5</span>,</span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>                              <span class="at">d1 =</span> <span class="dv">3</span>,</span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>                              <span class="at">e1 =</span> <span class="dv">1</span>),</span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> wet)</span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a>c1 <span class="ot">&lt;-</span>  fit_wet<span class="sc">$</span>m<span class="sc">$</span><span class="fu">getAllPars</span>()[<span class="dv">1</span>]</span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a>d1 <span class="ot">&lt;-</span> fit_wet<span class="sc">$</span>m<span class="sc">$</span><span class="fu">getAllPars</span>()[<span class="dv">2</span>]</span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a>e1 <span class="ot">&lt;-</span> fit_wet<span class="sc">$</span>m<span class="sc">$</span><span class="fu">getAllPars</span>()[<span class="dv">3</span>]</span>
<span id="cb43-17"><a href="#cb43-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-18"><a href="#cb43-18" aria-hidden="true" tabindex="-1"></a>dis <span class="ot">&lt;-</span></span>
<span id="cb43-19"><a href="#cb43-19" aria-hidden="true" tabindex="-1"></a>  (a <span class="sc">*</span> (t <span class="sc">-</span> b) <span class="sc">^</span> d) <span class="sc">*</span> ((c <span class="sc">-</span> t) <span class="sc">^</span> e) <span class="sc">*</span> (c1 <span class="sc">+</span> (d1 <span class="sc">-</span> c1) <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span> hw <span class="sc">/</span> e1)))</span>
<span id="cb43-20"><a href="#cb43-20" aria-hidden="true" tabindex="-1"></a>validation <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(t, hw, dis)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now the contour plot can be visualized using {ggplot2} and {geomtextpath} packages.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(geomtextpath)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(validation, <span class="fu">aes</span>(t, hw, <span class="at">z =</span> dis)) <span class="sc">+</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_contour_filled</span>(<span class="at">bins =</span> <span class="dv">8</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_textcontour</span>(<span class="at">bins =</span> <span class="dv">8</span>,</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">size =</span> <span class="fl">2.5</span>,</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">padding =</span> <span class="fu">unit</span>(<span class="fl">0.05</span>, <span class="st">"in"</span>)) <span class="sc">+</span></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>(<span class="at">base_size =</span> <span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"right"</span>) <span class="sc">+</span></span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">40</span>) <span class="sc">+</span></span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Wetness duration (hours)"</span>,</span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Severity"</span>,</span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Temperature (Celcius)"</span>,</span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Integrating generalized beta and monomolecular"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="prediction-disease-modeling_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>In the second example, let’s integrate the Analytis beta and the Weibull model:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>fit_temp2 <span class="ot">&lt;-</span> <span class="fu">nlsLM</span>(</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>  yscaled <span class="sc">~</span> (a <span class="sc">*</span> ((t <span class="sc">-</span> Tmin) <span class="sc">/</span> (Tmax <span class="sc">-</span> Tmin))<span class="sc">^</span>b <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> ((t <span class="sc">-</span> Tmin) <span class="sc">/</span> (Tmax <span class="sc">-</span> Tmin))))<span class="sc">^</span>c,</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> temp,</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">start =</span> <span class="fu">list</span>(<span class="at">a =</span> <span class="dv">1</span>, <span class="at">b =</span> <span class="dv">2</span>, <span class="at">c =</span> <span class="dv">3</span>), <span class="co"># Initial guesses for parameters</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">algorithm =</span> <span class="st">"port"</span> </span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>fit_temp2<span class="sc">$</span>m<span class="sc">$</span><span class="fu">getAllPars</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       a        b        c 
6.762509 1.964817 1.160702 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>a2 <span class="ot">&lt;-</span> fit_temp2<span class="sc">$</span>m<span class="sc">$</span><span class="fu">getAllPars</span>()[<span class="dv">1</span>]</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>b2 <span class="ot">&lt;-</span> fit_temp2<span class="sc">$</span>m<span class="sc">$</span><span class="fu">getAllPars</span>()[<span class="dv">2</span>]</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>c2 <span class="ot">&lt;-</span> fit_temp2<span class="sc">$</span>m<span class="sc">$</span><span class="fu">getAllPars</span>()[<span class="dv">3</span>]</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>fit_wet2 <span class="ot">&lt;-</span> <span class="fu">nlsLM</span>(</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>  yscaled <span class="sc">~</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span>(d <span class="sc">*</span> x)<span class="sc">^</span>e),</span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> wet,</span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">start =</span> <span class="fu">list</span>(<span class="at">d =</span> <span class="dv">1</span>, <span class="at">e =</span> <span class="dv">2</span>),  <span class="co"># Initial guesses for parameters a and b</span></span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>d2 <span class="ot">&lt;-</span>  fit_wet2<span class="sc">$</span>m<span class="sc">$</span><span class="fu">getAllPars</span>()[<span class="dv">1</span>]</span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a>e2 <span class="ot">&lt;-</span> fit_wet2<span class="sc">$</span>m<span class="sc">$</span><span class="fu">getAllPars</span>()[<span class="dv">2</span>]</span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a>Tmin <span class="ot">&lt;-</span> <span class="dv">12</span></span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a>Tmax <span class="ot">&lt;-</span> <span class="dv">40</span></span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true" tabindex="-1"></a>dis2 <span class="ot">&lt;-</span>  (a2 <span class="sc">*</span> ((t <span class="sc">-</span> Tmin) <span class="sc">/</span> (Tmax <span class="sc">-</span> Tmin))<span class="sc">^</span>b2 <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> ((t <span class="sc">-</span> Tmin) <span class="sc">/</span> (Tmax <span class="sc">-</span> Tmin))))<span class="sc">^</span>c2 <span class="sc">*</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span>(d2 <span class="sc">*</span> hw)<span class="sc">^</span>e2)</span>
<span id="cb47-18"><a href="#cb47-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-19"><a href="#cb47-19" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">40</span>, <span class="dv">40</span>)</span>
<span id="cb47-20"><a href="#cb47-20" aria-hidden="true" tabindex="-1"></a>hw <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">40</span>, <span class="at">each =</span> <span class="dv">40</span>)</span>
<span id="cb47-21"><a href="#cb47-21" aria-hidden="true" tabindex="-1"></a>validation2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(t, hw, dis2)</span>
<span id="cb47-22"><a href="#cb47-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-23"><a href="#cb47-23" aria-hidden="true" tabindex="-1"></a>validation2 <span class="ot">&lt;-</span> validation2 <span class="sc">|&gt;</span> </span>
<span id="cb47-24"><a href="#cb47-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(dis2 <span class="sc">!=</span> <span class="st">"NaN"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb47-25"><a href="#cb47-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">dis2 =</span> <span class="fu">case_when</span>(dis2 <span class="sc">&lt;</span> <span class="dv">0</span> <span class="sc">~</span> <span class="dv">0</span>,</span>
<span id="cb47-26"><a href="#cb47-26" aria-hidden="true" tabindex="-1"></a>                          <span class="cn">TRUE</span> <span class="sc">~</span> dis2))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now the plot.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(validation2, <span class="fu">aes</span>(t, hw, <span class="at">z =</span> dis2)) <span class="sc">+</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_contour_filled</span>(<span class="at">bins =</span> <span class="dv">7</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_textcontour</span>(<span class="at">bins =</span> <span class="dv">7</span>,</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">size =</span> <span class="fl">2.5</span>,</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">padding =</span> <span class="fu">unit</span>(<span class="fl">0.05</span>, <span class="st">"in"</span>)) <span class="sc">+</span></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>(<span class="at">base_size =</span> <span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"right"</span>) <span class="sc">+</span></span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">40</span>) <span class="sc">+</span></span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Wetness duration (hours)"</span>,</span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Severity"</span>,</span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Temperature (Celcius)"</span>,</span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Integrating generalized beta and monomolecular"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="prediction-disease-modeling_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>We can create a 3D surface plot to visualize the predictions, as <a href="https://bsppjournals.onlinelibrary.wiley.com/cms/asset/0acf45ce-bad8-4a49-9a17-181836aa9876/ppa_1393_f3.gif">it was used in the original paper</a>. Note that In <code>plot_ly</code>, a 3D surface plot requires a matrix or grid format for the <code>z</code> values, with corresponding vectors for <code>x</code> and <code>y</code> values that define the axes. If the data frame (<code>validation2</code>) has three columns (<code>t</code>, <code>hw</code>, and <code>dis2</code>), we’ll need to convert <code>dis2</code> into a matrix format that <code>plot_ly</code> can interpret for a surface plot.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reshape2)  </span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>z_matrix <span class="ot">&lt;-</span> <span class="fu">acast</span>(validation2, hw <span class="sc">~</span> t, <span class="at">value.var =</span> <span class="st">"dis2"</span>)</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>x_vals <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">unique</span>(validation2<span class="sc">$</span>t))  </span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>y_vals <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">unique</span>(validation2<span class="sc">$</span>hw)) </span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_ly</span>(<span class="at">x =</span> <span class="sc">~</span>x_vals, <span class="at">y =</span> <span class="sc">~</span>y_vals, <span class="at">z =</span> <span class="sc">~</span>z_matrix, <span class="at">type =</span> <span class="st">"surface"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">config</span>(<span class="at">displayModeBar =</span> <span class="cn">FALSE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(</span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">scene =</span> <span class="fu">list</span>(</span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Temperature (°C)"</span>, <span class="at">nticks =</span> <span class="dv">10</span>),</span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Wetness Duration (hours)"</span>, <span class="at">range =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">40</span>)),</span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">zaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Severity"</span>),</span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">aspectratio =</span> <span class="fu">list</span>(<span class="at">x =</span> <span class="dv">1</span>, <span class="at">y =</span> <span class="dv">1</span>, <span class="at">z =</span> <span class="dv">1</span>)  </span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Integrating Generalized Beta and Monomolecular"</span></span>
<span id="cb49-17"><a href="#cb49-17" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-3054de54d5d469964b09" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-3054de54d5d469964b09">{"x":{"visdat":{"f32dc26a478":["function () ","plotlyVisDat"]},"cur_data":"f32dc26a478","attrs":{"f32dc26a478":{"x":{},"y":{},"z":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"surface"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"scene":{"xaxis":{"title":"Temperature (°C)","nticks":10},"yaxis":{"title":"Wetness Duration (hours)","range":[0,40]},"zaxis":{"title":"Severity"},"aspectratio":{"x":1,"y":1,"z":1}},"title":"Integrating Generalized Beta and Monomolecular","hovermode":"closest","showlegend":false,"legend":{"yanchor":"top","y":0.5}},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false,"displayModeBar":false},"data":[{"colorbar":{"title":"z_matrix","ticklen":2,"len":0.5,"lenmode":"fraction","y":1,"yanchor":"top"},"colorscale":[["0","rgba(68,1,84,1)"],["0.0416666666666667","rgba(70,19,97,1)"],["0.0833333333333333","rgba(72,32,111,1)"],["0.125","rgba(71,45,122,1)"],["0.166666666666667","rgba(68,58,128,1)"],["0.208333333333333","rgba(64,70,135,1)"],["0.25","rgba(60,82,138,1)"],["0.291666666666667","rgba(56,93,140,1)"],["0.333333333333333","rgba(49,104,142,1)"],["0.375","rgba(46,114,142,1)"],["0.416666666666667","rgba(42,123,142,1)"],["0.458333333333333","rgba(38,133,141,1)"],["0.5","rgba(37,144,140,1)"],["0.541666666666667","rgba(33,154,138,1)"],["0.583333333333333","rgba(39,164,133,1)"],["0.625","rgba(47,174,127,1)"],["0.666666666666667","rgba(53,183,121,1)"],["0.708333333333333","rgba(79,191,110,1)"],["0.75","rgba(98,199,98,1)"],["0.791666666666667","rgba(119,207,85,1)"],["0.833333333333333","rgba(147,214,70,1)"],["0.875","rgba(172,220,52,1)"],["0.916666666666667","rgba(199,225,42,1)"],["0.958333333333333","rgba(226,228,40,1)"],["1","rgba(253,231,37,1)"]],"showscale":true,"x":[12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40],"y":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40],"z":[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.02094769419669118,0.057384573392527005,0.077230207094710956,0.07825867633143424,0.058386691236345878,0.015730531737265907,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.033762750183378376,0.084465106104958942,0.12090198530079477,0.14074761900297872,0.141776088239702,0.12190410314461364,0.079247943645533669,0.012203730301255322,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.032721049345398212,0.095297112936580941,0.14599946885816151,0.18243634805399733,0.20228198175618128,0.20331045099290457,0.18343846589781621,0.14078230639873623,0.073738093054457887,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0.019351164493891182,0.091371292937351245,0.15394735652853397,0.20464971245011454,0.24108659164595037,0.26093222534813432,0.2619606945848576,0.24208870948976924,0.19943254999068927,0.13238833664641092,0.039753055455259867,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0.074790334464367558,0.14681046290782762,0.20938652649901035,0.26008888242059092,0.29652576161642674,0.31637139531861069,0.31739986455533398,0.29752787946024561,0.25487171996116564,0.1878275066168873,0.095192225425736243,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0.047900348408809412,0.12692154040745374,0.1989416688509138,0.26151773244209653,0.3122200883636771,0.34865696755951292,0.36850260126169687,0.36953107049842016,0.34965908540333179,0.30700292590425182,0.23995871255997347,0.14732343136882242,0.02849331986577186,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0.013153337835403289,0.096741647036678424,0.17576283903532275,0.24778296747878281,0.31035903106996554,0.36106138699154611,0.39749826618738193,0.41734389988956588,0.41837236912628917,0.3985003840312008,0.35584422453212083,0.28880001118784249,0.19616472999669143,0.077334618493640872,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0.058786208227948555,0.14237451742922369,0.22139570942786801,0.29341583787132808,0.35599190146251081,0.40669425738409137,0.4431311365799272,0.46297677028211115,0.46400523951883443,0.44413325442374607,0.4014770949246661,0.33443288158038775,0.2417976003892367,0.12296748888618614,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0.015576471294716288,0.10132851368416285,0.18491682288543798,0.26393801488408231,0.33595814332754237,0.3985342069187251,0.44923656284030566,0.48567344203614149,0.50551907573832544,0.50654754497504872,0.48667555987996036,0.44401940038088039,0.37697518703660204,0.28433990584545099,0.16550979434240043,0.020844086241465498,0,0,0],[0,0,0,0,0,0,0,0,0,0,0.055166793718540497,0.14091883610798706,0.22450714530926219,0.30352833730790652,0.37554846575136658,0.43812452934254931,0.48882688526412987,0.5252637644599657,0.54510939816214965,0.54613786739887293,0.52626588230378457,0.4836097228047046,0.41656550946042625,0.3239302282692752,0.20510011676622464,0.060434408665289707,0,0,0],[0,0,0,0,0,0,0,0,0,0.0063901154447196795,0.091954749465308683,0.17770679185475524,0.26129510105603038,0.3403162930546747,0.41233642149813476,0.47491248508931749,0.52561484101089806,0.56205172020673388,0.58189735390891784,0.58292582314564112,0.56305383805055276,0.52039767855147279,0.45335346520719444,0.36071818401604339,0.24188807251299282,0.097222364412057893,0,0,0],[0,0,0,0,0,0,0,0,0,0.040530108536979637,0.12609474255756864,0.2118467849470152,0.29543509414829033,0.37445628614693466,0.44647641459039472,0.50905247818157751,0.55975483410315796,0.59619171329899379,0.61603734700117774,0.61706581623790102,0.59719383114281266,0.55453767164373269,0.4874934582994544,0.39485817710830334,0.27602806560525278,0.13136235750431785,0,0,0],[0,0,0,0,0,0,0,0,0,0.072177193123197814,0.15774182714378682,0.24349386953323338,0.32708217873450851,0.40610337073315284,0.4781234991766129,0.54069956276779563,0.59140191868937619,0.62783879788521202,0.64768443158739597,0.64871290082411925,0.62884091572903089,0.58618475622995092,0.51914054288567257,0.42650526169452152,0.30767515019147096,0.16300944209053603,0,0,0],[0,0,0,0,0,0,0,0,0.01838298596195681,0.10148429602157627,0.18704893004216527,0.27280097243161183,0.35638928163288697,0.43541047363153129,0.50743060207499135,0.57000666566617408,0.62070902158775465,0.65714590078359048,0.67699153448577443,0.67802000372249771,0.65814801862740935,0.61549185912832938,0.54844764578405103,0.45581236459289998,0.33698225308984942,0.19231654498891448,0.023924353357387018,0,0],[0,0,0,0,0,0,0,0,0.045499040038879945,0.12860035009849941,0.21416498411908841,0.29991702650853497,0.3835053357098101,0.46252652770845443,0.53454665615191455,0.59712271974309727,0.64782507566467773,0.68426195486051355,0.70410758856269751,0.70513605779942079,0.68526407270433243,0.64260791320525246,0.57556369986097411,0.48292841866982311,0.36409830716677255,0.21943259906583762,0.051040407434310153,0,0],[0,0,0,0,0,0,0,0,0.070567745388693814,0.15366905544831327,0.23923368946890228,0.32498573185834884,0.40857404105962397,0.4875952330582683,0.5596153615017283,0.62219142509291103,0.67289378101449171,0.70933066021032753,0.72917629391251149,0.73020476314923477,0.71033277805414641,0.66767661855506644,0.60063240521078809,0.50799712401963704,0.38916701251658642,0.24450130441565149,0.076109112784124022,0,0],[0,0,0,0,0,0,0,0.015263810909302455,0.093726772667315661,0.17682808272693512,0.26239271674752412,0.34814475913697068,0.43173306833824582,0.5107542603368902,0.58277438878035026,0.64535045237153299,0.69605280829311345,0.73248968748894927,0.75233532119113322,0.75336379042785651,0.73349180533276814,0.69083564583368817,0.62379143248940983,0.53115615129825877,0.41232603979520827,0.26766033169427333,0.099268140062745869,0,0],[0,0,0,0,0,0,0,0.036644320947556125,0.11510728270556933,0.19820859276518879,0.28377322678577777,0.36952526917522432,0.45311357837649946,0.53213477037514378,0.60415489881860385,0.66673096240978658,0.71743331833136714,0.75387019752720297,0.77371583122938692,0.7747443004661102,0.75487231537102184,0.71221615587194187,0.64517194252766352,0.55253666133651247,0.43370654983346191,0.28904084173252698,0.12064865010099954,0,0],[0,0,0,0,0,0,0,0.056370712932708872,0.13483367469072208,0.21793498475034154,0.30349961877093057,0.38925166116037713,0.47283997036165226,0.55186116236029659,0.62388129080375665,0.68645735439493938,0.73715971031651994,0.77359658951235577,0.79344222321453972,0.79447069245126301,0.77459870735617464,0.73194254785709467,0.66489833451281632,0.57226305332166527,0.45343294181861471,0.30876723371767978,0.14037504208615229,0,0],[0,0,0,0,0,0,0.00277978758305511,0.074560538647362284,0.15302350040537549,0.23612481046499495,0.32168944448558395,0.40744148687503051,0.49102979607630565,0.57005098807495003,0.64207111651841009,0.70464718010959282,0.75534953603117327,0.7917864152270091,0.81163204892919305,0.81266051816591633,0.79278853307082797,0.750132373571748,0.68308816022746965,0.5904528790363186,0.47162276753326809,0.32695705943233316,0.1585648678008057,0,0],[0,0,0,0,0,0,0.019543786321871592,0.091324537386178767,0.16978749914419197,0.2528888092038114,0.33845344322440041,0.42420548561384697,0.5077937948151221,0.58681498681376643,0.65883511525722649,0.72141117884840922,0.77211353476998978,0.80855041396582561,0.82839604766800956,0.82942451690473284,0.80955253180964448,0.76689637231056451,0.69985215896628616,0.60721687777513511,0.48838676627208455,0.34372105817114962,0.17532886653962218,0,0],[0,0,0,0,0,0,0.03498600704806859,0.10676675811237576,0.18522971987038897,0.26833102993000846,0.35389566395059746,0.43964770634004402,0.52323601554131915,0.60225720753996348,0.67427733598342354,0.73685339957460627,0.78755575549618684,0.82399263469202266,0.84383826839420661,0.8448667376309299,0.82499475253584154,0.78233859303676156,0.71529437969248322,0.62265909850133216,0.5038289869982816,0.35916327889734667,0.19077108726581918,0.0047806809139954998,0],[0,0,0,0,0,0,0.049203992857864254,0.12098474392217143,0.19944770568018463,0.28254901573980407,0.36811364976039307,0.45386569214983963,0.53745400135111476,0.61647519334975909,0.68849532179321915,0.75107138538440188,0.80177374130598245,0.83821062050181827,0.85805625420400222,0.85908472344072551,0.83921273834563714,0.79655657884655717,0.72951236550227883,0.63687708431112777,0.51804697280807721,0.37338126470714228,0.20498907307561484,0.018998666723791163,0],[0,0,0,0,0,0,0.062289008994899864,0.13406976005920704,0.21253272181722024,0.29563403187683968,0.38119866589742868,0.46695070828687524,0.55053901748815037,0.6295602094867947,0.70158033793025476,0.76415640152143749,0.81485875744301806,0.85129563663885388,0.87114127034103783,0.87216973957776112,0.85229775448267275,0.80964159498359278,0.74259738163931444,0.64996210044816338,0.53113198894511282,0.38646628084417789,0.21807408921265045,0.032083682860826773,0],[0,0,0,0,0,0.011102566524349433,0.07432630021057221,0.14610705127487938,0.22457001303289259,0.30767132309251205,0.39323595711310105,0.47898799950254761,0.56257630870382269,0.64159750070246702,0.71361762914592708,0.77619369273710981,0.82689604865869049,0.86333292785452631,0.88317856155671026,0.88420703079343355,0.86433504569834518,0.82167888619926521,0.75463467285498687,0.66199939166383581,0.54316928016078525,0.39850357205985026,0.2301113804283228,0.04412097407649912,0],[0,0,0,0,0,0.022171632985838144,0.085395366672060921,0.15717611773636808,0.23563907949438129,0.31874038955400075,0.40430502357458975,0.49005706596403631,0.57364537516531144,0.65266656716395577,0.72468669560741583,0.78726275919859856,0.83796511512017913,0.87440199431601495,0.8942476280181989,0.89527609725492219,0.87540411215983382,0.83274795266075385,0.76570373931647551,0.67306845812532445,0.55423834662227389,0.40957263852133896,0.2411804468898115,0.055190040537987831,0],[0,0,0,0,0,0.032346516511015541,0.095570250197238318,0.16735100126154551,0.24581396301955871,0.32891527307917817,0.41447990709976718,0.50023194948921368,0.58382025869048881,0.66284145068913314,0.7348615791325932,0.79743764272377593,0.8481399986453565,0.88457687784119232,0.90442251154337627,0.90545098078009956,0.88557899568501119,0.84292283618593122,0.77587862284165288,0.68324334165050182,0.56441323014745126,0.41974752204651639,0.25135533041498892,0.065364924063165228,0],[0,0,0,0,0,0.041696090879320358,0.10491982456554313,0.17670057562985031,0.25516353738786351,0.33826484744748297,0.42382948146807198,0.50958152385751854,0.59316983305879367,0.672191025057438,0.74421115350089806,0.80678721709208079,0.85748957301366135,0.89392645220949718,0.91377208591168113,0.91480055514840442,0.89492857005331605,0.85227241055423608,0.78522819720995773,0.69259291601880668,0.57376280451575612,0.42909709641482119,0.26070490478329372,0.074714498431470044,0],[0,0,0,0,0,0.050284351485636744,0.11350808517185952,0.18528883623616671,0.26375179799417992,0.34685310805379937,0.43241774207438838,0.51816978446383488,0.60175809366511002,0.68077928566375434,0.7527994141072144,0.81537547769839713,0.8660778336199777,0.90251471281581352,0.92236034651799748,0.92338881575472076,0.9035168306596324,0.86086067116055243,0.79381645781627408,0.70118117662512303,0.58235106512207246,0.43768535702113759,0.26929316538961012,0.083302759037786431,0],[0,0,0,0,0.0051589357518163903,0.05817070078167938,0.12139443446790216,0.19317518553220933,0.27163814729022251,0.35473945734984202,0.44030409137043103,0.52605613375987759,0.60964444296115272,0.68866563495979705,0.76068576340325711,0.82326182699443984,0.8739641829160204,0.91040106211185623,0.93024669581404018,0.93127516505076346,0.9114031799556751,0.86874702045659513,0.80170280711231678,0.70906752592116573,0.59023741441811517,0.44557170631718024,0.27717951468565272,0.091189108333829066,0],[0,0,0,0,0.012398461837509894,0.065410226867372884,0.12863396055359566,0.20041471161790284,0.27887767337591607,0.36197898343553547,0.44754361745612448,0.53329565984557104,0.61688396904684617,0.69590516104549049,0.76792528948895056,0.83050135308013329,0.88120370900171385,0.91764058819754968,0.93748622189973363,0.93851469113645691,0.91864270604136855,0.87598654654228858,0.80894233319801023,0.71630705200685918,0.59747694050380862,0.45281123240287369,0.28441904077134628,0.09842863441952257,0],[0,0,0,0,0.019042208283160125,0.072053973313023115,0.13527770699924591,0.20705845806355305,0.28552141982156626,0.36862272988118572,0.45418736390177472,0.53993940629122128,0.62352771549249641,0.70254890749114074,0.7745690359346008,0.83714509952578353,0.8878474554473641,0.92428433464319992,0.94412996834538387,0.94515843758210716,0.9252864524870188,0.88263029298793882,0.81558607964366048,0.72295079845250942,0.60412068694945886,0.45945497884852393,0.29106278721699647,0.1050723808651728,0],[0,0,0,0,0.025137433826495428,0.078149198856358418,0.14137293254258121,0.21315368360688836,0.29161664536490156,0.37471795542452102,0.46028258944511002,0.54603463183455658,0.62962294103583172,0.70864413303447604,0.78066426147793611,0.84324032506911883,0.8939426809906994,0.93037956018653523,0.95022519388871918,0.95125366312544246,0.9313816780303541,0.88872551853127413,0.82168130518699578,0.72904602399584473,0.61021591249279417,0.46555020439185923,0.29715801276033177,0.1111676064085081,0],[0,0,0,0,0.030727861030684547,0.083739626060547537,0.14696335974677033,0.21874411081107747,0.29720707256909068,0.38030838262871014,0.46587301664929914,0.5516250590387457,0.63521336824002084,0.71423456023866516,0.78625468868212522,0.84883075227330795,0.89953310819488852,0.93596998739072435,0.9558156210929083,0.95684409032963158,0.93697210523454322,0.89431594573546325,0.8272717323911849,0.73463645120003385,0.61580633969698328,0.47114063159604835,0.30274843996452089,0.11675803361269722,0],[0,0,0,0,0.035853913336002567,0.088865678365865564,0.15208941205208834,0.22387016311639552,0.30233312487440872,0.38543443493402818,0.47099906895461718,0.55675111134406374,0.64033942054533888,0.7193606125439832,0.79138074098744327,0.85395680457862599,0.90465916050020656,0.94109603969604239,0.96094167339822634,0.96197014263494962,0.94209815753986126,0.89944199804078129,0.83239778469650294,0.73976250350535189,0.62093239200230133,0.47626668390136639,0.30787449226983893,0.12188408591801525,0],[0,0,0,0,0.040552940208821664,0.093564705238684653,0.15678843892490743,0.22856918998921461,0.30703215174722781,0.39013346180684727,0.47569809582743627,0.56145013821688283,0.64503844741815797,0.72405963941680229,0.79607976786026236,0.85865583145144508,0.90935818737302565,0.94579506656886148,0.96564070027104543,0.96666916950776871,0.94679718441268035,0.90414102491360038,0.83709681156932203,0.74446153037817098,0.62563141887512042,0.48096571077418548,0.31257351914265802,0.12658311279083434,0],[0,0,0,0.0034205901615469714,0.04485943030253603,0.097871195332399019,0.1610949290186218,0.23287568008292897,0.31133864184094218,0.39443995190056164,0.48000458592115064,0.56575662831059725,0.64934493751187228,0.7283661295105166,0.80038625795397667,0.86296232154515939,0.91366467746674007,0.9501015566625759,0.96994719036475985,0.97097565960148313,0.95110367450639477,0.9084475150073148,0.84140330166303645,0.7487680204718854,0.62993790896883484,0.48527220086789985,0.31688000923637238,0.13088960288454871,0],[0,0,0,0.0073663725670417776,0.048805212708030836,0.10181697773789383,0.16504071142411661,0.23682146248842378,0.31528442424643699,0.39838573430605645,0.48395036832664545,0.56970241071609196,0.65329071991736709,0.73231191191601142,0.80433204035947148,0.86690810395065421,0.91761045987223477,0.9540473390680706,0.97389297277025455,0.97492144200697783,0.95504945691188947,0.9123932974128095,0.84534908406853115,0.7527138028773801,0.63388369137432954,0.48921798327339466,0.3208257916418672,0.13483538529004352,0],[0,0,0,0.010980806354981956,0.052419646495971015,0.105431411525834,0.16865514521205677,0.24043589627636397,0.31889885803437718,0.40200016809399663,0.48756480211458564,0.5733168445040322,0.65690515370530733,0.73592634570395166,0.80794647414741172,0.87052253773859445,0.92122489366017501,0.95766177285601084,0.97750740655819479,0.97853587579491808,0.95866389069982971,0.91600773120074974,0.84896351785647139,0.75632823666532034,0.63749812516226978,0.49283241706133485,0.32444022542980738,0.1384498190779837,0],[0,0,0,0.014290958706145059,0.055729798847134117,0.1087415638769971,0.17196529756321988,0.24374604862752705,0.32220901038554028,0.40531032044515974,0.49087495446574875,0.57662699685519525,0.66021530605647039,0.73923649805511471,0.81125662649857477,0.8738326900897575,0.92453504601133807,0.96097192520717389,0.98081755890935785,0.98184602814608113,0.96197404305099277,0.9193178835519128,0.85227367020763445,0.7596383890164834,0.64080827751343283,0.49614256941249796,0.32775037778097049,0.14175997142914679,0]],"type":"surface","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="magareys-generic-infection-model" class="level4" data-number="20.2.1.4">
<h4 data-number="20.2.1.4" class="anchored" data-anchor-id="magareys-generic-infection-model"><span class="header-section-number">20.2.1.4</span> Magarey’s generic infection model</h4>
<p>In the early 2000s, Magarey and collaborators <span class="citation" data-cites="magarey2005">(<a href="references.html#ref-magarey2005" role="doc-biblioref">Magarey et al. 2005</a>)</span> proposed a generic infection model for foliar fungal pathogens, designed to predict infection periods based on limited data on temperature and wetness requirements. The model uses cardinal temperatures (minimum, optimum, maximum) and the minimum wetness duration (Wmin) necessary for infection. The model can incorporate inputs based on estimated cardinal temperatures and surface wetness duration. These values are available for numerous pathogens and can be consulted in the literature (See table 2 of the paper by <span class="citation" data-cites="magarey2005">Magarey et al. (<a href="references.html#ref-magarey2005" role="doc-biblioref">2005</a>)</span>).</p>
<p>The model utilizes a temperature response function, which is adjusted to the pathogen’s minimum and optimum wetness duration needs, allowing it to be broadly applicable even with limited data on specific pathogens. The model was validated with data from 53 studies, showing good accuracy and adaptability, even for pathogens lacking comprehensive data <span class="citation" data-cites="magarey2005">(<a href="references.html#ref-magarey2005" role="doc-biblioref">Magarey et al. 2005</a>)</span>.</p>
<p>The function is given by</p>
<p><span class="math inline">\(f(T) = \left( \frac{T_{\text{max}} - T}{T_{\text{max}} - T_{\text{opt}}} \right)^{\frac{T_{\text{opt}} - T_{\text{min}}}{T_{\text{max}} - T_{\text{opt}}}} \times \left( \frac{T - T_{\text{min}}}{T_{\text{opt}} - T_{\text{min}}} \right)^{\frac{T_{\text{opt}} - T_{\text{min}}}{T_{\text{opt}} - T_{\text{min}}}}\)</span></p>
<p>where <span class="math inline">\(T\)</span> is the temperature, <span class="math inline">\(T_{\text{min}}\)</span> is the minimum temperature, <span class="math inline">\(T_{\text{opt}}\)</span> is the optimum temperature, and <span class="math inline">\(T_{\text{max}}\)</span> is the maximum temperature for infection.</p>
<p>The wetness duration requirement is given by</p>
<p><span class="math inline">\(W(T) = \frac{W_{\text{min}}}{f(T)} \leq W_{\text{max}}\)</span></p>
<p>where <span class="math inline">\(W_{\text{min}}\)</span> is the minimum wetness duration requirement, and <span class="math inline">\(W_{\text{max}}\)</span> is an optional upper limit on <span class="math inline">\(W(T)\)</span>.</p>
<p>Let’s write the functions for estimating the required wetness duration at each temperature.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>temp_response <span class="ot">&lt;-</span> <span class="cf">function</span>(T, Tmin, Topt, Tmax) {</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (T <span class="sc">&lt;</span> Tmin <span class="sc">||</span> T <span class="sc">&gt;</span> Tmax) {</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="dv">0</span>)</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>    ((Tmax <span class="sc">-</span> T) <span class="sc">/</span> (Tmax <span class="sc">-</span> Topt))<span class="sc">^</span>((Topt <span class="sc">-</span> Tmin) <span class="sc">/</span> (Tmax <span class="sc">-</span> Topt)) <span class="sc">*</span> </span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>    ((T <span class="sc">-</span> Tmin) <span class="sc">/</span> (Topt <span class="sc">-</span> Tmin))<span class="sc">^</span>((Topt <span class="sc">-</span> Tmin) <span class="sc">/</span> (Topt <span class="sc">-</span> Tmin))</span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the function to calculate wetness duration requirement W(T)</span></span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a>wetness_duration <span class="ot">&lt;-</span> <span class="cf">function</span>(T, Wmin, Tmin, Topt, Tmax, <span class="at">Wmax =</span> <span class="cn">Inf</span>) {</span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a>  f_T <span class="ot">&lt;-</span> <span class="fu">temp_response</span>(T, Tmin, Topt, Tmax)</span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (f_T <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="dv">0</span>)  <span class="co"># Infinite duration required if outside temperature range</span></span>
<span id="cb50-15"><a href="#cb50-15" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb50-16"><a href="#cb50-16" aria-hidden="true" tabindex="-1"></a>  W <span class="ot">&lt;-</span> Wmin <span class="sc">/</span> f_T</span>
<span id="cb50-17"><a href="#cb50-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">min</span>(W, Wmax))  <span class="co"># Apply Wmax as an upper limit if specified</span></span>
<span id="cb50-18"><a href="#cb50-18" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s set the parameters for the fungus <em>Venturia inaequalis</em>, the cause of apple scab.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Parameters for Venturia inaequalis (apple scab)</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>T <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">35</span>, <span class="at">by =</span> <span class="fl">0.5</span>) </span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>Wmin <span class="ot">&lt;-</span> <span class="dv">6</span>                  </span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>Tmin <span class="ot">&lt;-</span> <span class="dv">1</span>                  </span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>Topt <span class="ot">&lt;-</span> <span class="dv">20</span>                 </span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>Tmax <span class="ot">&lt;-</span> <span class="dv">35</span>                 </span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>Wmax <span class="ot">&lt;-</span> <span class="fl">40.5</span>                </span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate wetness duration required at each temperature</span></span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>W_T <span class="ot">&lt;-</span> <span class="fu">sapply</span>(T, wetness_duration, Wmin, Tmin, Topt, Tmax, Wmax)</span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a>temperature_data_applescab <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">Temperature =</span> T,</span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">Wetness_Duration =</span> W_T</span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>And now the parameters for the fungus <em>Phakopsora pachyrhizi</em>, the cause of soybean rust in soybean.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Parameters for Phakposora pachyrhizi</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>T <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">35</span>, <span class="at">by =</span> <span class="fl">0.5</span>)  </span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>Wmin <span class="ot">&lt;-</span> <span class="dv">8</span>                </span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>Tmin <span class="ot">&lt;-</span> <span class="dv">10</span>                  </span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>Topt <span class="ot">&lt;-</span> <span class="dv">23</span>                 </span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>Tmax <span class="ot">&lt;-</span> <span class="dv">28</span>                </span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>Wmax <span class="ot">&lt;-</span> <span class="dv">12</span>                 </span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate wetness duration required at each temperature</span></span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>W_T <span class="ot">&lt;-</span> <span class="fu">sapply</span>(T, wetness_duration, Wmin, Tmin, Topt, Tmax, Wmax)</span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a>temperature_data_soyrust <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">Temperature =</span> T,</span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">Wetness_Duration =</span> W_T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can produce the plots for each pathogen.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>applescab <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(temperature_data_applescab, <span class="fu">aes</span>(<span class="at">x =</span> Temperature, <span class="at">y =</span> Wetness_Duration)) <span class="sc">+</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>, <span class="at">linetype =</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_r4pde</span>(<span class="at">font_size =</span> <span class="dv">14</span>)<span class="sc">+</span></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Temperature (°C)"</span>, <span class="at">y =</span> <span class="st">"Wetness Duration (hours)"</span>, </span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Venturia inaequalis"</span>)<span class="sc">+</span></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"italic"</span>))</span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>soyrust <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(temperature_data_soyrust, <span class="fu">aes</span>(<span class="at">x =</span> Temperature, <span class="at">y =</span> Wetness_Duration)) <span class="sc">+</span></span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>, <span class="at">linetype =</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_r4pde</span>(<span class="at">font_size =</span> <span class="dv">14</span>)<span class="sc">+</span></span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Temperature (°C)"</span>, <span class="at">y =</span> <span class="st">"Wetness Duration (hours)"</span>, </span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Phakopsora pachyrizhi"</span>)<span class="sc">+</span> </span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"italic"</span>))</span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-15"><a href="#cb53-15" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb53-16"><a href="#cb53-16" aria-hidden="true" tabindex="-1"></a>applescab <span class="sc">|</span> soyrust</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="prediction-disease-modeling_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="latency-period-models" class="level3" data-number="20.2.2">
<h3 data-number="20.2.2" class="anchored" data-anchor-id="latency-period-models"><span class="header-section-number">20.2.2</span> Latency period models</h3>
<p>The latent period can be defined as “the length of time between the start of the infection process by a unit of inoculum and the start of production of infectious units” <span class="citation" data-cites="madden2007">(<a href="references.html#ref-madden2007" role="doc-biblioref">Madden et al. 2007</a>)</span>. The latent period, analogous to the reproductive maturity age of nonparasitic organisms, defines the generation time between infections and is a key factor in pathogen development and epidemic progress in plant disease epidemiology <span class="citation" data-cites="plantdi1963">(<a href="references.html#ref-plantdi1963" role="doc-biblioref">Vanderplank 1963</a>)</span>. As a critical trait of aggressiveness, especially in polycyclic diseases, it largely determines the potential number of infection cycles within a season, impacting the overall epidemic intensity <span class="citation" data-cites="lannou2012">(<a href="references.html#ref-lannou2012" role="doc-biblioref">Lannou 2012</a>)</span>.</p>
<section id="parabolic-function" class="level4" data-number="20.2.2.1">
<h4 data-number="20.2.2.1" class="anchored" data-anchor-id="parabolic-function"><span class="header-section-number">20.2.2.1</span> Parabolic function</h4>
<p>The effects of temperature on the length of the incubation and latent periods of hawthorn powdery mildew, caused by <em>Podosphaera clandestina</em>, were studied by <span class="citation" data-cites="xu2000">Xu and Robinson (<a href="references.html#ref-xu2000" role="doc-biblioref">2000</a>)</span>. In that work, the authors inoculated the leaves and, each day after inoculation, the upper surface of each leaf was examined for mildew colonies and conidiophores using a pen-microscope (×50). Sporulation was recorded at the leaf level, noting the number of colonies and the first appearance dates of colonies and sporulation for each leaf.</p>
<p>The latent period (LP) was defined as the time from inoculation to the first day of observed sporulation on the leaf. Due to the skewed distribution of LP across temperatures and inoculations, medians were used to summarize LP rather than means <span class="citation" data-cites="xu2000">(<a href="references.html#ref-xu2000" role="doc-biblioref">Xu and Robinson 2000</a>)</span>.</p>
<p>Let’s look at two plots extracted from the paper. The first, on the left-hand side, is the original number of days of the latent period of each evaluated temperature (note: the solid symbol is for constant temperature while the open circle is for fluctuating temperature). On the right-hand side, the relationship between temperature and rates of development of powdery mildew under constant temperature during the latent periods; the solid line indicates the fitted model. The rate of fungal development was calculated as the reciprocal of the corresponding observed incubation (in hours) and latent periods.</p>
<div id="fig-latent" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-latent-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="imgs/modeling-latent.png" class="img-fluid quarto-figure quarto-figure-center figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-latent-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;20.4: Source: <span class="citation" data-cites="xu2000">Xu and Robinson (<a href="references.html#ref-xu2000" role="doc-biblioref">2000</a>)</span>
</figcaption>
</figure>
</div>
<p>The latent period data in days for the solid black circle (constant temperature) above was extracted using the {digitize} R package.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>latent <span class="ot">&lt;-</span> tibble<span class="sc">::</span><span class="fu">tribble</span>(</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>   <span class="sc">~</span>T, <span class="sc">~</span>days,</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>  <span class="dv">10</span>L,   <span class="dv">13</span>L,</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>  <span class="dv">11</span>L,   <span class="dv">16</span>L,</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>  <span class="dv">13</span>L,    <span class="dv">8</span>L,</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>  <span class="dv">14</span>L,    <span class="dv">9</span>L,</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>  <span class="dv">15</span>L,    <span class="dv">7</span>L,</span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>  <span class="dv">16</span>L,    <span class="dv">7</span>L,</span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>  <span class="dv">17</span>L,    <span class="dv">6</span>L,</span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>  <span class="dv">18</span>L,    <span class="dv">6</span>L,</span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a>  <span class="dv">19</span>L,    <span class="dv">6</span>L,</span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a>  <span class="dv">20</span>L,    <span class="dv">6</span>L,</span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a>  <span class="dv">21</span>L,    <span class="dv">5</span>L,</span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a>  <span class="dv">22</span>L,    <span class="dv">5</span>L,</span>
<span id="cb54-15"><a href="#cb54-15" aria-hidden="true" tabindex="-1"></a>  <span class="dv">23</span>L,    <span class="dv">6</span>L,</span>
<span id="cb54-16"><a href="#cb54-16" aria-hidden="true" tabindex="-1"></a>  <span class="dv">24</span>L,    <span class="dv">6</span>L,</span>
<span id="cb54-17"><a href="#cb54-17" aria-hidden="true" tabindex="-1"></a>  <span class="dv">25</span>L,    <span class="dv">5</span>L,</span>
<span id="cb54-18"><a href="#cb54-18" aria-hidden="true" tabindex="-1"></a>  <span class="dv">26</span>L,    <span class="dv">7</span>L,</span>
<span id="cb54-19"><a href="#cb54-19" aria-hidden="true" tabindex="-1"></a>  <span class="dv">27</span>L,    <span class="dv">7</span>L,</span>
<span id="cb54-20"><a href="#cb54-20" aria-hidden="true" tabindex="-1"></a>  <span class="dv">28</span>L,   <span class="dv">10</span>L</span>
<span id="cb54-21"><a href="#cb54-21" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s reproduce the two plots using the datapoints.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co">#|fig-width: 10</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="co">#|fig-height: 4</span></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(r4pde)</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>p_latent <span class="ot">&lt;-</span> latent <span class="sc">|&gt;</span> </span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(T, days))<span class="sc">+</span></span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_r4pde</span>()</span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a>latent_rate <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">T =</span> latent<span class="sc">$</span>T,  <span class="co"># Scale temperature</span></span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">R =</span> <span class="dv">1</span><span class="sc">/</span>latent<span class="sc">$</span>days<span class="sc">/</span><span class="dv">24</span></span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb55-15"><a href="#cb55-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-16"><a href="#cb55-16" aria-hidden="true" tabindex="-1"></a>p_latent_rate <span class="ot">&lt;-</span> latent_rate <span class="sc">|&gt;</span> </span>
<span id="cb55-17"><a href="#cb55-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(T, R))<span class="sc">+</span></span>
<span id="cb55-18"><a href="#cb55-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb55-19"><a href="#cb55-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_r4pde</span>()</span>
<span id="cb55-20"><a href="#cb55-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-21"><a href="#cb55-21" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb55-22"><a href="#cb55-22" aria-hidden="true" tabindex="-1"></a>p_latent <span class="sc">|</span> p_latent_rate</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="prediction-disease-modeling_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>We will fit the parabolic function proposed by <span class="citation" data-cites="bernard2013">Bernard et al. (<a href="references.html#ref-bernard2013" role="doc-biblioref">2013</a>)</span> which predicts a thermal response curve (developmental rate, R), which is the relationship between the inverse of latent period and temperature. We need to enter the values for optimum temperature (where latent period is shortest) and the minimum latent period. The model is given by:</p>
<p><span class="math inline">\(R(T) = \frac{k}{\text{LP}_{\text{min}} + \text{a} \times (T - T_{\text{opt}})^2}\)</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load necessary package</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="co">#library(minpack.lm)</span></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the model formula</span></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a><span class="co"># model_formula &lt;- R ~ (a + b * T)^(c * T)</span></span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>LPmin <span class="ot">&lt;-</span> <span class="dv">5</span> <span class="co"># minimum latent period</span></span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>Topt <span class="ot">&lt;-</span> <span class="dv">21</span> <span class="co"># Optimal temperature</span></span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>model_formula2 <span class="ot">&lt;-</span> R <span class="sc">~</span> k <span class="sc">/</span> (LPmin <span class="sc">+</span> a <span class="sc">*</span> (T <span class="sc">-</span> Topt)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Set initial parameter estimates</span></span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a><span class="co">#start_values &lt;- list(a = 0.1, b = 0.01, c = 0.01)</span></span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a>start_values2 <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">a =</span> <span class="fl">0.1</span>, <span class="at">k =</span> <span class="dv">1</span>)</span>
<span id="cb56-13"><a href="#cb56-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the model</span></span>
<span id="cb56-14"><a href="#cb56-14" aria-hidden="true" tabindex="-1"></a><span class="co">#fit_rate &lt;- nlsLM(model_formula, data = latent_rate, start = start_values)</span></span>
<span id="cb56-15"><a href="#cb56-15" aria-hidden="true" tabindex="-1"></a>fit_rate2 <span class="ot">&lt;-</span> <span class="fu">nls</span>(model_formula2, <span class="at">data =</span> latent_rate, <span class="at">start =</span> start_values2)</span>
<span id="cb56-16"><a href="#cb56-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-17"><a href="#cb56-17" aria-hidden="true" tabindex="-1"></a><span class="co"># View the summary of the fit</span></span>
<span id="cb56-18"><a href="#cb56-18" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_rate2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Formula: R ~ k/(LPmin + a * (T - Topt)^2)

Parameters:
  Estimate Std. Error t value Pr(&gt;|t|)    
a 0.060274   0.010705    5.63 3.76e-05 ***
k 0.039520   0.001464   26.99 9.05e-15 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.0006936 on 16 degrees of freedom

Number of iterations to convergence: 6 
Achieved convergence tolerance: 3.183e-06</code></pre>
</div>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>fit_rate2<span class="sc">$</span>m<span class="sc">$</span><span class="fu">getAllPars</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         a          k 
0.06027417 0.03952035 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> fit_rate2<span class="sc">$</span>m<span class="sc">$</span><span class="fu">getAllPars</span>()[<span class="dv">1</span>]</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> fit_rate2<span class="sc">$</span>m<span class="sc">$</span><span class="fu">getAllPars</span>()[<span class="dv">2</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now we reproduce the plot with the fitted data. Note that the curve is not the same shown in the paper because we used a different equation.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>T <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">10</span>, <span class="dv">29</span>, <span class="fl">0.1</span>)</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="co">#R &lt;- (a + b * T)^(c * T)</span></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>R <span class="ot">&lt;-</span> k <span class="sc">/</span> (LPmin <span class="sc">+</span> a <span class="sc">*</span> (T <span class="sc">-</span> Topt)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>dat2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(T, R)</span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>dat2 <span class="sc">|&gt;</span></span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(T, R)) <span class="sc">+</span></span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> latent_rate, <span class="fu">aes</span>(T, R)) <span class="sc">+</span></span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_r4pde</span>(<span class="at">font_size =</span> <span class="dv">16</span>) <span class="sc">+</span></span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Temperature"</span>, <span class="at">y =</span> <span class="st">"Inverse of the latent period (hour -1)"</span>, </span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="prediction-disease-modeling_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="field-data" class="level2" data-number="20.3">
<h2 data-number="20.3" class="anchored" data-anchor-id="field-data"><span class="header-section-number">20.3</span> Field data</h2>
<p>While pathogen inoculum, host resistance, and agronomic factors are sometimes included alongside weather in empirically derived models using field data <span class="citation" data-cites="shah2013 cao2015 mehra2017">(<a href="references.html#ref-cao2015" role="doc-biblioref">Cao et al. 2015</a>; <a href="references.html#ref-mehra2017" role="doc-biblioref">Mehra et al. 2017</a>; <a href="references.html#ref-shah2013" role="doc-biblioref">Shah et al. 2013</a>)</span>, only a few models explicitly incorporate non-weather factors <span class="citation" data-cites="mehra2016 paul2004">(<a href="references.html#ref-mehra2016" role="doc-biblioref">Mehra et al. 2016</a>; <a href="references.html#ref-paul2004" role="doc-biblioref">Paul and Munkvold 2004</a>)</span>. In most cases, these models primarily rely on weather variables as predictors <span class="citation" data-cites="gonzález-domínguez2023">(<a href="references.html#ref-gonzález-domínguez2023" role="doc-biblioref">González-Domínguez et al. 2023</a>)</span>. This focus reflects the critical role of weather in driving key processes in the disease cycle, such as pathogen survival, dispersal, host infection, and reproduction <span class="citation" data-cites="dewolf2007">(<a href="references.html#ref-dewolf2007" role="doc-biblioref">De Wolf and Isard 2007</a>)</span>. Consequently, a primary objective for plant epidemiologists is to identify and quantify the relationships between weather conditions and measures of disease intensity <span class="citation" data-cites="shah2019 eljarroudi2017 pietravalle2003 coakley1988 delponte2006 shah2013 coakley1988a">(<a href="references.html#ref-coakley1988" role="doc-biblioref">Coakley et al. 1988</a>; <a href="references.html#ref-coakley1988a" role="doc-biblioref">Coakley 1988</a>; <a href="references.html#ref-delponte2006" role="doc-biblioref">Del Ponte et al. 2006</a>; <a href="references.html#ref-eljarroudi2017" role="doc-biblioref">El Jarroudi et al. 2017</a>; <a href="references.html#ref-pietravalle2003" role="doc-biblioref">Pietravalle et al. 2003</a>; <a href="references.html#ref-shah2013" role="doc-biblioref">Shah et al. 2013</a>, <a href="references.html#ref-shah2019" role="doc-biblioref">2019b</a>)</span>.</p>
<p>In modeling efforts, the disease variable can be represented either as a continuous measure (e.g., incidence or severity) or as categorical data, which may be binary (e.g., non-epidemic vs.&nbsp;epidemic) or multinomial (e.g., low, moderate, and high severity). This variability in response types informs the selection of suitable modeling techniques, ensuring that the model accurately captures the nature of the data and the relationships between weather variables and disease outcomes.</p>
<p>In this section, I will demonstrate several modeling approaches that can be applied when field data is available. These examples will cover a range of techniques, starting with variable construction, which involves transforming raw weather data into summary measures that can effectively represent conditions relevant to disease outcomes. Next, variable selection methods will be explored to identify the most influential predictors, ensuring that models are both accurate and interpretable. The focus will then shift to model fitting, showing how different models, such as linear and logistic regression, can be used to capture relationships between weather variables and disease endpoints. Finally, model evaluation will be addressed, emphasizing metrics like accuracy, sensitivity, and area under the curve (AUC), which are crucial for assessing the predictive performance and reliability of the models developed.</p>
<p>Follows a typical workflow for developing a disease prediction model, starting with disease data collection and weather data retrieval. The process includes data pre-processing, feature engineering, variable selection, model fitting, cross-validation, model tuning, and evaluation, followed by interpretation. Iterative feedback between model evaluation and variable selection aims to optimize model performance.</p>
<div id="fig-workflow" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-workflow-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="imgs/modeling-workflow.png" class="img-fluid quarto-figure quarto-figure-center figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-workflow-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;20.5: Key steps for developing a plant disease prediction model
</figcaption>
</figure>
</div>
<section id="variable-creation-and-selection" class="level3" data-number="20.3.1">
<h3 data-number="20.3.1" class="anchored" data-anchor-id="variable-creation-and-selection"><span class="header-section-number">20.3.1</span> Variable creation and selection</h3>
<p>Variable construction, particularly for weather-related variables, involves not only data transformation methods but also requires an understanding of how diseases respond to specific weather conditions at particular growth stages <span class="citation" data-cites="decól2024 dewolf2003">(<a href="references.html#ref-decól2024" role="doc-biblioref">De Cól et al. 2024</a>; <a href="references.html#ref-dewolf2003" role="doc-biblioref">De Wolf et al. 2003</a>)</span>. This approach ensures that the variables derived accurately capture biologically relevant processes, improving the realism and relevance of the model inputs.</p>
<p>In addition, data mining techniques are employed to systematically explore time-series data and identify potential weather-disease relationships <span class="citation" data-cites="shah2019 pietravalle2003 coakley1988">(<a href="references.html#ref-coakley1988" role="doc-biblioref">Coakley et al. 1988</a>; <a href="references.html#ref-pietravalle2003" role="doc-biblioref">Pietravalle et al. 2003</a>; <a href="references.html#ref-shah2019" role="doc-biblioref">Shah et al. 2019b</a>)</span>. These techniques involve creating lagged variables, moving averages, or window-based summaries that capture delayed or cumulative effects of weather on disease outcomes. By integrating system knowledge with data mining, researchers aim to construct variables that are both biologically meaningful and statistically robust, improving the chances of identifying predictors that enhance model accuracy and interpretability.</p>
<section id="window-pane" class="level4" data-number="20.3.1.1">
<h4 data-number="20.3.1.1" class="anchored" data-anchor-id="window-pane"><span class="header-section-number">20.3.1.1</span> Window-pane</h4>
<section id="variable-construction" class="level5" data-number="20.3.1.1.1">
<h5 data-number="20.3.1.1.1" class="anchored" data-anchor-id="variable-construction"><span class="header-section-number">20.3.1.1.1</span> Variable construction</h5>
<p>With regards to weather variable creation and selection for data-mining purposes, window-pane analysis, first introduced in the mid-1980s <span class="citation" data-cites="coakley1985">(<a href="references.html#ref-coakley1985" role="doc-biblioref">Coakley 1985</a>)</span>, has been widely used in modeling studies in plant pathology <span class="citation" data-cites="pietravalle2003 calverojr1996 tebeest2008a gouache2015a coakley1988 kriss2010 dallalana2021 coakley1988a">(<a href="references.html#ref-calverojr1996" role="doc-biblioref">Calvero Jr et al. 1996</a>; <a href="references.html#ref-coakley1988" role="doc-biblioref">Coakley et al. 1988</a>; <a href="references.html#ref-coakley1988a" role="doc-biblioref">Coakley 1988</a>; <a href="references.html#ref-dallalana2021" role="doc-biblioref">Dalla Lana et al. 2021b</a>; <a href="references.html#ref-gouache2015a" role="doc-biblioref">Gouache et al. 2015</a>; <a href="references.html#ref-kriss2010" role="doc-biblioref">Kriss et al. 2010</a>; <a href="references.html#ref-pietravalle2003" role="doc-biblioref">Pietravalle et al. 2003</a>; <a href="references.html#ref-tebeest2008a" role="doc-biblioref">Te Beest et al. 2008</a>)</span>. This method aids in identifying weather conditions that are most strongly associated with disease outcomes by segmenting a continuous time series (e.g.&nbsp;daily temperature, relative humidity, and rainfall), into discrete, fixed-length windows.</p>
<p>The analysis involves summarizing conditions within each window (e.g., mean, sum, count) and correlating these summaries with disease outcomes, which may be expressed as continuous measures (e.g., severity) or as categorical variables (e.g., low vs.&nbsp;high levels). This approach allows users to set specific start and end times, as well as window lengths, enabling the exploration of different temporal relationships between weather and disease. By sliding the start and end points along the series, multiple overlapping windows are generated, making it possible to identify the most informative variables for modeling. The selected optimal fixed-time and fixed-window-length variables derived from this analysis serve as predictors in model development, helping to improve the accuracy and relevance of disease forecasting models.</p>
<p>Here’s an R code that demonstrates how the windows are defined over a 28-day period using four fixed window lengths (7, 14, 21, and 28 days), generating a total of 46 variables.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Define total days and window lengths</span></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>max_days <span class="ot">&lt;-</span> <span class="dv">28</span></span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>window_lengths <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">7</span>, <span class="dv">14</span>, <span class="dv">21</span>, <span class="dv">28</span>)</span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Create an empty data frame for all sliding windows</span></span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>window_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Populate the data frame with start and end points for each window</span></span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a>var_id <span class="ot">&lt;-</span> <span class="dv">1</span>  <span class="co"># Variable ID for each window</span></span>
<span id="cb62-13"><a href="#cb62-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-14"><a href="#cb62-14" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (length <span class="cf">in</span> <span class="fu">sort</span>(window_lengths)) {  <span class="co"># Sort window lengths from shortest to longest</span></span>
<span id="cb62-15"><a href="#cb62-15" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (start_day <span class="cf">in</span> <span class="dv">0</span><span class="sc">:</span>(max_days <span class="sc">-</span> length)) {</span>
<span id="cb62-16"><a href="#cb62-16" aria-hidden="true" tabindex="-1"></a>    end_day <span class="ot">&lt;-</span> start_day <span class="sc">+</span> length</span>
<span id="cb62-17"><a href="#cb62-17" aria-hidden="true" tabindex="-1"></a>    window_data <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb62-18"><a href="#cb62-18" aria-hidden="true" tabindex="-1"></a>      window_data,</span>
<span id="cb62-19"><a href="#cb62-19" aria-hidden="true" tabindex="-1"></a>      <span class="fu">data.frame</span>(</span>
<span id="cb62-20"><a href="#cb62-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">start =</span> start_day,</span>
<span id="cb62-21"><a href="#cb62-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">end =</span> end_day,</span>
<span id="cb62-22"><a href="#cb62-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">var_id =</span> var_id,</span>
<span id="cb62-23"><a href="#cb62-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">window_length =</span> length</span>
<span id="cb62-24"><a href="#cb62-24" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb62-25"><a href="#cb62-25" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb62-26"><a href="#cb62-26" aria-hidden="true" tabindex="-1"></a>    var_id <span class="ot">&lt;-</span> var_id <span class="sc">+</span> <span class="dv">1</span>  <span class="co"># Increment variable ID</span></span>
<span id="cb62-27"><a href="#cb62-27" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb62-28"><a href="#cb62-28" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb62-29"><a href="#cb62-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-30"><a href="#cb62-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert window_length to a factor for correct ordering in the legend</span></span>
<span id="cb62-31"><a href="#cb62-31" aria-hidden="true" tabindex="-1"></a>window_data<span class="sc">$</span>window_length <span class="ot">&lt;-</span> <span class="fu">factor</span>(window_data<span class="sc">$</span>window_length, <span class="at">levels =</span> <span class="fu">sort</span>(<span class="fu">unique</span>(window_data<span class="sc">$</span>window_length)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>window_data <span class="sc">|&gt;</span> </span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> start, <span class="at">xend =</span> end, <span class="at">y =</span> var_id, <span class="at">yend =</span> var_id)) <span class="sc">+</span></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">linewidth =</span> <span class="dv">2</span>) <span class="sc">+</span>  <span class="co"># Line segments for each window</span></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="dv">0</span><span class="sc">:</span>max_days, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, max_days)) <span class="sc">+</span></span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="dv">1</span><span class="sc">:</span>var_id) <span class="sc">+</span></span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Window-pane"</span>,</span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Each variable of 7, 14, 21 and 28 days length over 28 days"</span>,</span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Days"</span>, <span class="at">y =</span> <span class="st">"Variable ID"</span>, <span class="at">color =</span> <span class="st">"Window Length (days)"</span>) <span class="sc">+</span></span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a>  r4pde<span class="sc">::</span><span class="fu">theme_r4pde</span>(<span class="at">font_size =</span> <span class="dv">14</span>) <span class="sc">+</span></span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"right"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="prediction-disease-modeling_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p>The window-pane analysis requires a spreadsheet program <span class="citation" data-cites="kriss2010">(<a href="references.html#ref-kriss2010" role="doc-biblioref">Kriss et al. 2010</a>)</span> or a specific algorithm that automates the creation of sliding windows at defined starting and ending times relative to a reference date. In the seminal work, software was programmed in the FORTRAN language and named WINDOW <span class="citation" data-cites="coakley1985">(<a href="references.html#ref-coakley1985" role="doc-biblioref">Coakley 1985</a>)</span>. It enabled the creation of windows and the calculation of summary statistics, including correlation with disease severity. Building on the original idea, a Genstat 6.1 algorithm was developed in the early 2000s, incorporating further adjustments such as the implementation of bootstrapping analysis to validate correlations and misclassifications identified by window-pane <span class="citation" data-cites="pietravalle2003 tebeest2008a">(<a href="references.html#ref-pietravalle2003" role="doc-biblioref">Pietravalle et al. 2003</a>; <a href="references.html#ref-tebeest2008a" role="doc-biblioref">Te Beest et al. 2008</a>)</span>. More recently, window-pane analysis including variable creation and analysis has been conducted in R using custom-made scripts <span class="citation" data-cites="gouache2015a dallalana2021">(<a href="references.html#ref-dallalana2021" role="doc-biblioref">Dalla Lana et al. 2021b</a>; <a href="references.html#ref-gouache2015a" role="doc-biblioref">Gouache et al. 2015</a>)</span>.</p>
<p>I will demonstrate the <code>windowpane()</code> function of the {r4pde} package developed to facilitate the creation of variables using the window-pane approach. First, let’s load a dataset that contains information on the disease, as well as metadata, including a key date that will be used as the starting point for window creation. The BlastWheat dataset, which is included in the {r4pde} package, was provided by <span class="citation" data-cites="decól2024">De Cól et al. (<a href="references.html#ref-decól2024" role="doc-biblioref">2024</a>)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(r4pde)</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>trials <span class="ot">&lt;-</span> BlastWheat</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(trials)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 143
Columns: 10
$ study      &lt;dbl&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, …
$ year       &lt;dbl&gt; 2012, 2012, 2012, 2012, 2012, 2013, 2013, 2013, 2013, 2014,…
$ location   &lt;chr&gt; "Dourados", "Palotina", "Londrina", "Planaltina", "Itaberá"…
$ state      &lt;chr&gt; "MS", "PR", "PR", "DF", "SP", "MS", "MG", "DF", "SP", "MG",…
$ latitude   &lt;dbl&gt; -22.27516, -24.35483, -23.35916, -15.60387, -24.06832, -22.…
$ longitude  &lt;dbl&gt; -54.81640, -53.75794, -51.16476, -47.71381, -49.15575, -54.…
$ heading    &lt;chr&gt; "10-05-2012", "09-06-2012", "01-06-2012", "03-05-2012", "15…
$ inc_mean   &lt;dbl&gt; 93.30, 40.50, 100.00, 35.50, 7.71, 48.70, 22.00, 46.50, 68.…
$ index_mean &lt;dbl&gt; 68.65, 11.73, 92.86, 6.36, 0.35, 9.17, 2.91, 10.41, 41.86, …
$ yld_mean   &lt;dbl&gt; 1097.00, 1219.38, 495.12, 1747.44, 2148.31, 506.00, 1562.75…</code></pre>
</div>
</div>
<p>We can note that the heading date, which will be used as reference date in our analysis, is not defined as date object, which needs correction.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>trials<span class="sc">$</span>heading <span class="ot">=</span> <span class="fu">as.Date</span>(trials<span class="sc">$</span>heading, <span class="at">format =</span> <span class="st">"%d-%m-%Y"</span>)</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(trials<span class="sc">$</span>heading)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Date[1:143], format: "2012-05-10" "2012-06-09" "2012-06-01" "2012-05-03" "2012-04-15" ...</code></pre>
</div>
</div>
<p>The weather data for our analysis will be downloaded from NASA POWER. Since we have multiple trials with different heading dates, a wrapper function for the <code>get_power()</code> function from the {nasapower} package was created, included in {r4pde}, and named <code>get_nasapower()</code>. This function enables the download of data for a period “around” the key date, which can be defined by the user. In our case, we will download data from 28 days before and 28 days after the heading date.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>weather_data <span class="ot">&lt;-</span> <span class="fu">get_nasapower</span>(</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> trials,</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">days_around =</span> <span class="dv">28</span>,</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">date_col =</span> <span class="st">"heading"</span>,</span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">pars =</span> <span class="fu">c</span>(<span class="st">"T2M"</span>, <span class="st">"T2M_MAX"</span>, <span class="st">"T2M_MIN"</span>, <span class="st">"T2M_RANGE"</span>, <span class="st">"RH2M"</span>, </span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>           <span class="st">"PRECTOTCORR"</span>, <span class="st">"T2MDEW"</span>, <span class="st">"WS2M"</span>, <span class="st">"PS"</span>, <span class="st">"GWETTOP"</span>, </span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>           <span class="st">"GWETPROF"</span>, <span class="st">"CLRSKY_SFC_PAR_TOT"</span>)</span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a><span class="co"># See all parameters in the website: https://power.larc.nasa.gov/#resources</span></span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a><span class="co"># save the data for faster rendering</span></span>
<span id="cb68-12"><a href="#cb68-12" aria-hidden="true" tabindex="-1"></a><span class="fu">write_csv</span>(weather_data, <span class="st">"data/weather_windowpane.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now we can see the weather data and join the two dataframes.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co"># read the data</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>weather_data <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(<span class="st">"data/weather_windowpane.csv"</span>)</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(weather_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 8,151
Columns: 14
$ LON         &lt;dbl&gt; -54.8164, -54.8164, -54.8164, -54.8164, -54.8164, -54.8164…
$ LAT         &lt;dbl&gt; -22.27516, -22.27516, -22.27516, -22.27516, -22.27516, -22…
$ YEAR        &lt;dbl&gt; 2012, 2012, 2012, 2012, 2012, 2012, 2012, 2012, 2012, 2012…
$ MM          &lt;dbl&gt; 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 5…
$ DD          &lt;dbl&gt; 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26…
$ DOY         &lt;dbl&gt; 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114…
$ YYYYMMDD    &lt;date&gt; 2012-04-12, 2012-04-13, 2012-04-14, 2012-04-15, 2012-04-1…
$ T2M         &lt;dbl&gt; 24.31, 25.83, 24.99, 24.15, 22.72, 23.33, 23.76, 24.83, 24…
$ RH2M        &lt;dbl&gt; 83.69, 77.62, 81.69, 82.69, 74.62, 74.44, 70.19, 67.75, 77…
$ PRECTOTCORR &lt;dbl&gt; 0.02, 1.13, 11.00, 0.06, 0.00, 0.04, 0.00, 0.03, 24.08, 20…
$ T2M_MAX     &lt;dbl&gt; 28.61, 31.01, 30.01, 29.43, 30.33, 30.69, 31.51, 32.49, 30…
$ T2M_MIN     &lt;dbl&gt; 20.82, 20.43, 21.11, 19.04, 16.31, 17.37, 17.15, 17.69, 20…
$ T2MDEW      &lt;dbl&gt; 21.19, 21.23, 21.38, 20.75, 17.47, 18.01, 17.29, 17.85, 20…
$ study       &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1…</code></pre>
</div>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co"># apply a full join</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>trials_weather <span class="ot">&lt;-</span> <span class="fu">full_join</span>(trials, weather_data) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We are now ready to use the windowpane function to create new variables. The function has several arguments. Note the two date variables: <code>end_date</code>, which serves as the reference for sliding the windows, and <code>date_col</code>, which represents the date for each day in the time series. The <code>summary_type</code> specifies the statistic to be calculated, while the <code>direction</code> determines whether the sliding windows will move backward, forward, or in both directions relative to the end date. Lastly, the <code>group_by</code> argument specifies the index variable for the epidemic or study.</p>
<p>We will create new variables based on the mean daily temperature (T2M), with each variable representing the mean value over one of the four window lengths (7, 14, 21, and 28 days) defined in the <code>window_length</code> argument. We will only generate variables that cover periods before the heading date, using “backward” in the <code>direction</code> argument.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create window variables separated for each weather variable</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>wp_T2M <span class="ot">&lt;-</span> <span class="fu">windowpane</span>(</span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> trials_weather,</span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">end_date_col =</span> heading,</span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">date_col =</span> YYYYMMDD,</span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">variable =</span> T2M,  </span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">summary_type =</span> <span class="st">"mean"</span>,</span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">threshold =</span> <span class="cn">NULL</span>,</span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">window_lengths =</span> <span class="fu">c</span>(<span class="dv">7</span>, <span class="dv">14</span>, <span class="dv">21</span>, <span class="dv">28</span>),</span>
<span id="cb72-11"><a href="#cb72-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">direction =</span> <span class="st">"backward"</span>,</span>
<span id="cb72-12"><a href="#cb72-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">group_by_cols =</span> <span class="st">"study"</span>, </span>
<span id="cb72-13"><a href="#cb72-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb72-14"><a href="#cb72-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-15"><a href="#cb72-15" aria-hidden="true" tabindex="-1"></a>wpT2M_MIN_15 <span class="ot">&lt;-</span> <span class="fu">windowpane</span>(</span>
<span id="cb72-16"><a href="#cb72-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> trials_weather,</span>
<span id="cb72-17"><a href="#cb72-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">end_date_col =</span> heading,</span>
<span id="cb72-18"><a href="#cb72-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">date_col =</span> YYYYMMDD,</span>
<span id="cb72-19"><a href="#cb72-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">variable =</span> T2M_MIN,   </span>
<span id="cb72-20"><a href="#cb72-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">summary_type =</span> <span class="st">"below_threshold"</span>,</span>
<span id="cb72-21"><a href="#cb72-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">threshold =</span> <span class="dv">15</span>,</span>
<span id="cb72-22"><a href="#cb72-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">window_lengths =</span> <span class="fu">c</span>(<span class="dv">7</span>, <span class="dv">14</span>, <span class="dv">21</span>, <span class="dv">28</span>),</span>
<span id="cb72-23"><a href="#cb72-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">direction =</span> <span class="st">"backward"</span>,</span>
<span id="cb72-24"><a href="#cb72-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">group_by_cols =</span> <span class="st">"study"</span>, </span>
<span id="cb72-25"><a href="#cb72-25" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb72-26"><a href="#cb72-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-27"><a href="#cb72-27" aria-hidden="true" tabindex="-1"></a>wpT2M_MIN <span class="ot">&lt;-</span> <span class="fu">windowpane</span>(</span>
<span id="cb72-28"><a href="#cb72-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> trials_weather,</span>
<span id="cb72-29"><a href="#cb72-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">end_date_col =</span> heading,</span>
<span id="cb72-30"><a href="#cb72-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">date_col =</span> YYYYMMDD,</span>
<span id="cb72-31"><a href="#cb72-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">variable =</span> T2M_MIN,   </span>
<span id="cb72-32"><a href="#cb72-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">summary_type =</span> <span class="st">"mean"</span>,</span>
<span id="cb72-33"><a href="#cb72-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">threshold =</span> <span class="cn">NULL</span>,</span>
<span id="cb72-34"><a href="#cb72-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">window_lengths =</span> <span class="fu">c</span>(<span class="dv">7</span>, <span class="dv">14</span>, <span class="dv">21</span>, <span class="dv">28</span>),</span>
<span id="cb72-35"><a href="#cb72-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">direction =</span> <span class="st">"backward"</span>,</span>
<span id="cb72-36"><a href="#cb72-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">group_by_cols =</span> <span class="st">"study"</span>, </span>
<span id="cb72-37"><a href="#cb72-37" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb72-38"><a href="#cb72-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-39"><a href="#cb72-39" aria-hidden="true" tabindex="-1"></a>wpT2M_MAX <span class="ot">&lt;-</span> <span class="fu">windowpane</span>(</span>
<span id="cb72-40"><a href="#cb72-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> trials_weather,</span>
<span id="cb72-41"><a href="#cb72-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">end_date_col =</span> heading,</span>
<span id="cb72-42"><a href="#cb72-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">date_col =</span> YYYYMMDD,</span>
<span id="cb72-43"><a href="#cb72-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">variable =</span> T2M_MAX,   </span>
<span id="cb72-44"><a href="#cb72-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">summary_type =</span> <span class="st">"mean"</span>,</span>
<span id="cb72-45"><a href="#cb72-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">threshold =</span> <span class="cn">NULL</span>,</span>
<span id="cb72-46"><a href="#cb72-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">window_lengths =</span> <span class="fu">c</span>(<span class="dv">7</span>, <span class="dv">14</span>, <span class="dv">21</span>, <span class="dv">28</span>),</span>
<span id="cb72-47"><a href="#cb72-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">direction =</span> <span class="st">"backward"</span>,</span>
<span id="cb72-48"><a href="#cb72-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">group_by_cols =</span> <span class="st">"study"</span>, </span>
<span id="cb72-49"><a href="#cb72-49" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb72-50"><a href="#cb72-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-51"><a href="#cb72-51" aria-hidden="true" tabindex="-1"></a>wpPREC <span class="ot">&lt;-</span> <span class="fu">windowpane</span>(</span>
<span id="cb72-52"><a href="#cb72-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> trials_weather,</span>
<span id="cb72-53"><a href="#cb72-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">end_date_col =</span> heading,</span>
<span id="cb72-54"><a href="#cb72-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">date_col =</span> YYYYMMDD,</span>
<span id="cb72-55"><a href="#cb72-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">variable =</span> PRECTOTCORR,   </span>
<span id="cb72-56"><a href="#cb72-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">summary_type =</span> <span class="st">"sum"</span>,</span>
<span id="cb72-57"><a href="#cb72-57" aria-hidden="true" tabindex="-1"></a>    <span class="at">threshold =</span> <span class="cn">NULL</span>,</span>
<span id="cb72-58"><a href="#cb72-58" aria-hidden="true" tabindex="-1"></a>    <span class="at">window_lengths =</span> <span class="fu">c</span>(<span class="dv">7</span>, <span class="dv">14</span>, <span class="dv">21</span>, <span class="dv">28</span>),</span>
<span id="cb72-59"><a href="#cb72-59" aria-hidden="true" tabindex="-1"></a>    <span class="at">direction =</span> <span class="st">"backward"</span>,</span>
<span id="cb72-60"><a href="#cb72-60" aria-hidden="true" tabindex="-1"></a>    <span class="at">group_by_cols =</span> <span class="st">"study"</span>, </span>
<span id="cb72-61"><a href="#cb72-61" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb72-62"><a href="#cb72-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-63"><a href="#cb72-63" aria-hidden="true" tabindex="-1"></a>wpRH2M <span class="ot">&lt;-</span> <span class="fu">windowpane</span>(</span>
<span id="cb72-64"><a href="#cb72-64" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> trials_weather,</span>
<span id="cb72-65"><a href="#cb72-65" aria-hidden="true" tabindex="-1"></a>    <span class="at">end_date_col =</span> heading,</span>
<span id="cb72-66"><a href="#cb72-66" aria-hidden="true" tabindex="-1"></a>    <span class="at">date_col =</span> YYYYMMDD,</span>
<span id="cb72-67"><a href="#cb72-67" aria-hidden="true" tabindex="-1"></a>    <span class="at">variable =</span> RH2M,   </span>
<span id="cb72-68"><a href="#cb72-68" aria-hidden="true" tabindex="-1"></a>    <span class="at">summary_type =</span> <span class="st">"mean"</span>,</span>
<span id="cb72-69"><a href="#cb72-69" aria-hidden="true" tabindex="-1"></a>    <span class="at">threshold =</span> <span class="cn">NULL</span>,</span>
<span id="cb72-70"><a href="#cb72-70" aria-hidden="true" tabindex="-1"></a>    <span class="at">window_lengths =</span> <span class="fu">c</span>(<span class="dv">7</span>, <span class="dv">14</span>, <span class="dv">21</span>, <span class="dv">28</span>),</span>
<span id="cb72-71"><a href="#cb72-71" aria-hidden="true" tabindex="-1"></a>    <span class="at">direction =</span> <span class="st">"backward"</span>,</span>
<span id="cb72-72"><a href="#cb72-72" aria-hidden="true" tabindex="-1"></a>    <span class="at">group_by_cols =</span> <span class="st">"study"</span>, </span>
<span id="cb72-73"><a href="#cb72-73" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb72-74"><a href="#cb72-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-75"><a href="#cb72-75" aria-hidden="true" tabindex="-1"></a><span class="co"># combine all datasets</span></span>
<span id="cb72-76"><a href="#cb72-76" aria-hidden="true" tabindex="-1"></a>wp_all <span class="ot">&lt;-</span> <span class="fu">cbind</span>(wp_T2M, wpT2M_MIN_15, wpT2M_MIN, wpT2M_MAX, wpPREC, wpRH2M)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="correlations-and-multiple-hypothesis-test" class="level5" data-number="20.3.1.1.2">
<h5 data-number="20.3.1.1.2" class="anchored" data-anchor-id="correlations-and-multiple-hypothesis-test"><span class="header-section-number">20.3.1.1.2</span> Correlations and multiple hypothesis test</h5>
<p>The window-pane analysis begins by quantifying the associations between each summary weather variable and disease response using a specific correlation coefficient (Pearson or Spearman). Usually, Spearman’s rank correlation can be preferred due to its ability to measure monotonic relationships and its robustness to outliers. In other cases, Spearman was used because the disease data was ordinal <span class="citation" data-cites="kriss2010">(<a href="references.html#ref-kriss2010" role="doc-biblioref">Kriss et al. 2010</a>)</span>.</p>
<p>In a recent study, <span class="citation" data-cites="dallalana2021">Dalla Lana et al. (<a href="references.html#ref-dallalana2021" role="doc-biblioref">2021b</a>)</span>, differing from <span class="citation" data-cites="kriss2010">Kriss et al. (<a href="references.html#ref-kriss2010" role="doc-biblioref">2010</a>)</span>, proposed the estimation of the precision of these correlations via bootstrapping, where a high number of samples (e.g.&nbsp;1000) are randomly drawn (with replacement) from the original dataset. For each bootstrap sample, correlations between weather variables and disease outcomes are calculated, and the average across samples is used as the final measure of association. This approach ensures a more reliable estimation of the correlations by capturing variability and improving statistical robustness.</p>
<p>The window-pane analysis involves numerous tests, as each time window generates a separate test statistic. Because many tests are conducted, the global significance level becomes higher than the critical significance level set for individual tests, increasing the risk of false positives <span class="citation" data-cites="kriss2010">(<a href="references.html#ref-kriss2010" role="doc-biblioref">Kriss et al. 2010</a>)</span>. Additionally, the correlations among test statistics are influenced by overlapping time windows, shared data, and large-scale climatic patterns. To address this issue, <span class="citation" data-cites="kriss2010">Kriss et al. (<a href="references.html#ref-kriss2010" role="doc-biblioref">2010</a>)</span> proposed the use of the Simes’ method, which tests the global null hypothesis that none of the individual correlations are significant. Simes’ method orders p-values and rejects the global null hypothesis if any adjusted p-value meets a specific threshold.</p>
<p>While this method indicates whether at least one correlation is significant, it does not provide significance for individual correlations. Therefore, the authors proposed that the individual correlation coefficients should be compared against a more stringent significance level (α = 0.005 instead of 0.05), reducing the likelihood of false positives but increasing false negatives. Although this adjustment is independent of the Simes’ method, there was a general alignment: significant global results often corresponded to significant individual correlations, and non-significant global results typically lacked significant individual correlations <span class="citation" data-cites="kriss2010">(<a href="references.html#ref-kriss2010" role="doc-biblioref">Kriss et al. 2010</a>)</span>.</p>
<p>Let’s calculate the bootstrapped correlation coefficients combined with the Sime’s method. First, we need to subset our variables to the specific combination of weather and window.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>  T2M_MIN_7 <span class="ot">=</span> wp_all <span class="sc">|&gt;</span> dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">"length7_T2M_MIN_mean"</span>))</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>  T2M_MIN_14 <span class="ot">=</span> wp_all <span class="sc">|&gt;</span> dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">"length14_T2M_MIN_mean"</span>))</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>  T2M_MIN_21 <span class="ot">=</span> wp_all <span class="sc">|&gt;</span> dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">"length21_T2M_MIN_mean"</span>))</span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>  T2M_MIN_28 <span class="ot">=</span> wp_all <span class="sc">|&gt;</span> dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">"length28_T2M_MIN_mean"</span>))</span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>  T2M_MAX_7 <span class="ot">=</span> wp_all <span class="sc">|&gt;</span> dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">"length7_T2M_MAX_mean"</span>))</span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a>  T2M_MAX_14 <span class="ot">=</span> wp_all <span class="sc">|&gt;</span> dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">"length14_T2M_MAX_mean"</span>))</span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a>  T2M_MAX_21 <span class="ot">=</span> wp_all <span class="sc">|&gt;</span> dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">"length21_T2M_MAX_mean"</span>))</span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a>  T2M_MAX_28 <span class="ot">=</span> wp_all <span class="sc">|&gt;</span> dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">"length28_T2M_MAX_mean"</span>))</span>
<span id="cb73-10"><a href="#cb73-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb73-11"><a href="#cb73-11" aria-hidden="true" tabindex="-1"></a>  T2M_7 <span class="ot">=</span> wp_all <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">"length7_T2M_mean"</span>))</span>
<span id="cb73-12"><a href="#cb73-12" aria-hidden="true" tabindex="-1"></a>  T2M_14 <span class="ot">=</span> wp_all <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">"length14_T2M_mean"</span>))</span>
<span id="cb73-13"><a href="#cb73-13" aria-hidden="true" tabindex="-1"></a>  T2M_21 <span class="ot">=</span> wp_all <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">"length21_T2M_mean"</span>))</span>
<span id="cb73-14"><a href="#cb73-14" aria-hidden="true" tabindex="-1"></a>  T2M_28 <span class="ot">=</span> wp_all <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">"length28_T2M_mean"</span>))</span>
<span id="cb73-15"><a href="#cb73-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb73-16"><a href="#cb73-16" aria-hidden="true" tabindex="-1"></a>  RH2M_7 <span class="ot">=</span> wp_all <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">"length7_RH2M_mean"</span>))</span>
<span id="cb73-17"><a href="#cb73-17" aria-hidden="true" tabindex="-1"></a>  RH2M_14 <span class="ot">=</span> wp_all <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">"length14_RH2M_mean"</span>))</span>
<span id="cb73-18"><a href="#cb73-18" aria-hidden="true" tabindex="-1"></a>  RH2_21 <span class="ot">=</span> wp_all <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">"length21_RH2M_mean"</span>))</span>
<span id="cb73-19"><a href="#cb73-19" aria-hidden="true" tabindex="-1"></a>  RH2_28 <span class="ot">=</span> wp_all <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">"length28_RH2M_mean"</span>))</span>
<span id="cb73-20"><a href="#cb73-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb73-21"><a href="#cb73-21" aria-hidden="true" tabindex="-1"></a>  PRECTOTCORR_7 <span class="ot">=</span> wp_all <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">"length7_PRECTOTCORR"</span>))</span>
<span id="cb73-22"><a href="#cb73-22" aria-hidden="true" tabindex="-1"></a>  PRECTOTCORR_14 <span class="ot">=</span> wp_all <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">"length14_PRECTOTCORR"</span>))</span>
<span id="cb73-23"><a href="#cb73-23" aria-hidden="true" tabindex="-1"></a>  PRECTOTCORR_21 <span class="ot">=</span> wp_all <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">"length21_PRECTOTCORR"</span>))</span>
<span id="cb73-24"><a href="#cb73-24" aria-hidden="true" tabindex="-1"></a>  PRECTOTCORR_28 <span class="ot">=</span> wp_all <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">"length28_PRECTOTCORR"</span>))</span>
<span id="cb73-25"><a href="#cb73-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb73-26"><a href="#cb73-26" aria-hidden="true" tabindex="-1"></a>  T2M_MINb_7 <span class="ot">=</span> wp_all <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">"length7_T2M_MIN_below"</span>))</span>
<span id="cb73-27"><a href="#cb73-27" aria-hidden="true" tabindex="-1"></a>  T2M_MINb_14 <span class="ot">=</span> wp_all <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">"length14_T2M_MIN_below"</span>))</span>
<span id="cb73-28"><a href="#cb73-28" aria-hidden="true" tabindex="-1"></a>  T2M_MINb_21 <span class="ot">=</span> wp_all <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">"length21_T2M_MIN_below"</span>))</span>
<span id="cb73-29"><a href="#cb73-29" aria-hidden="true" tabindex="-1"></a>  T2M_MINb_28 <span class="ot">=</span> wp_all <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">"length28_T2M_MIN_below"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now, we can use the <code>windowpane_tests()</code> function from the {r4pde} package to analyze each of the datasets created above. This function will compute the bootstrapped correlation coefficients for the variables of interest and apply the Simes’ procedure to account for multiple testing, providing adjusted P-values for more robust statistical inference.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> T2M_MINb_7 </span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>inc <span class="ot">&lt;-</span> trials<span class="sc">$</span>inc_mean </span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>response_var <span class="ot">&lt;-</span> <span class="st">'inc'</span>  </span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">windowpane_tests</span>(data, response_var, <span class="at">corr_type =</span> <span class="st">"spearman"</span>, <span class="at">R =</span> <span class="dv">1000</span>)</span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>results_TMINb <span class="ot">&lt;-</span> results<span class="sc">$</span>results</span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a>results</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$results
                                  variable correlation      p_value  mean_corr
1  length7_T2M_MIN_below_threshold_-18_-24  -0.5295915 1.040432e-11 -0.5249507
2  length7_T2M_MIN_below_threshold_-17_-23  -0.5136581 5.359609e-11 -0.5130773
3  length7_T2M_MIN_below_threshold_-15_-21  -0.5116609 6.543248e-11 -0.5063511
4  length7_T2M_MIN_below_threshold_-10_-16  -0.5063934 1.100732e-10 -0.5008654
5  length7_T2M_MIN_below_threshold_-11_-17  -0.5054218 1.210402e-10 -0.5013972
6  length7_T2M_MIN_below_threshold_-16_-22  -0.5038720 1.407514e-10 -0.4988078
7  length7_T2M_MIN_below_threshold_-12_-18  -0.4972482 2.659657e-10 -0.4921962
8  length7_T2M_MIN_below_threshold_-19_-25  -0.4951918 3.231718e-10 -0.4943599
9   length7_T2M_MIN_below_threshold_-9_-15  -0.4913413 4.638201e-10 -0.4853357
10  length7_T2M_MIN_below_threshold_-7_-13  -0.4882483 6.180090e-10 -0.4853013
11   length7_T2M_MIN_below_threshold_-3_-9  -0.4793727 1.386299e-09 -0.4775091
12    length7_T2M_MIN_below_threshold_0_-6  -0.4757057 1.922737e-09 -0.4737155
13  length7_T2M_MIN_below_threshold_-8_-14  -0.4743890 2.160334e-09 -0.4731947
14 length7_T2M_MIN_below_threshold_-14_-20  -0.4742346 2.189972e-09 -0.4734724
15  length7_T2M_MIN_below_threshold_-4_-10  -0.4735015 2.336183e-09 -0.4693049
16   length7_T2M_MIN_below_threshold_-2_-8  -0.4730773 2.425031e-09 -0.4741065
17   length7_T2M_MIN_below_threshold_-1_-7  -0.4698400 3.218863e-09 -0.4678987
18  length7_T2M_MIN_below_threshold_-6_-12  -0.4663226 4.364062e-09 -0.4625572
19 length7_T2M_MIN_below_threshold_-13_-19  -0.4630281 5.785628e-09 -0.4610996
20  length7_T2M_MIN_below_threshold_-5_-11  -0.4594875 7.807700e-09 -0.4582524
21 length7_T2M_MIN_below_threshold_-20_-26  -0.4334293 6.401965e-08 -0.4305574
22 length7_T2M_MIN_below_threshold_-21_-27  -0.4291061 8.925631e-08 -0.4271509
      sd_corr median_corr rank  m simes_threshold significant_simes
1  0.05792860  -0.5281375    1 22     0.002272727              TRUE
2  0.06219467  -0.5156222    2 22     0.004545455              TRUE
3  0.06085362  -0.5081182    3 22     0.006818182              TRUE
4  0.06439511  -0.5032007    4 22     0.009090909              TRUE
5  0.06317908  -0.5034083    5 22     0.011363636              TRUE
6  0.06375940  -0.4989540    6 22     0.013636364              TRUE
7  0.06625604  -0.4921979    7 22     0.015909091              TRUE
8  0.06260022  -0.4976638    8 22     0.018181818              TRUE
9  0.06759529  -0.4847309    9 22     0.020454545              TRUE
10 0.06787472  -0.4880106   10 22     0.022727273              TRUE
11 0.06497033  -0.4802147   11 22     0.025000000              TRUE
12 0.06536201  -0.4736488   12 22     0.027272727              TRUE
13 0.06529500  -0.4757740   13 22     0.029545455              TRUE
14 0.06578540  -0.4759618   14 22     0.031818182              TRUE
15 0.06580619  -0.4740651   15 22     0.034090909              TRUE
16 0.06212626  -0.4755563   16 22     0.036363636              TRUE
17 0.06178866  -0.4722236   17 22     0.038636364              TRUE
18 0.06805414  -0.4621550   18 22     0.040909091              TRUE
19 0.06631706  -0.4606907   19 22     0.043181818              TRUE
20 0.06542673  -0.4562920   20 22     0.045454545              TRUE
21 0.06440558  -0.4348640   21 22     0.047727273              TRUE
22 0.06557457  -0.4305249   22 22     0.050000000              TRUE
   individual_significant
1                    TRUE
2                    TRUE
3                    TRUE
4                    TRUE
5                    TRUE
6                    TRUE
7                    TRUE
8                    TRUE
9                    TRUE
10                   TRUE
11                   TRUE
12                   TRUE
13                   TRUE
14                   TRUE
15                   TRUE
16                   TRUE
17                   TRUE
18                   TRUE
19                   TRUE
20                   TRUE
21                   TRUE
22                   TRUE

$summary_table
               Metric         Value
1 Global P-value (Pg)  2.288950e-10
2     Max Correlation -4.271509e-01

$global_significant
[1] TRUE</code></pre>
</div>
</div>
<p>The window-pane tests results indicate strong, statistically significant negative correlations between the response variable, the number of days when the TMIN was lower than 15 <sup>o</sup>C, and the selected predictors over a 7-day period. The correlations range from approximately -0.56 to -0.50, with all P-values below the global significance threshold after Simes’ correction, suggesting that these predictors are robustly associated with the response.</p>
<p>The global P-value, which accounts for multiple testing, is exceptionally low, confirming a significant overall relationship, while the highest observed correlation is -0.50. These findings highlight that low-temperature conditions over 7 days are consistently linked with the response variable, emphasizing the importance of temperature variability in this context.</p>
<p>Let’s apply the test function to 7-day long windows for three other variables: relative humidity, precipitation and maximum temperature.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(r4pde)</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>data1 <span class="ot">&lt;-</span> RH2M_7 </span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>data1<span class="sc">$</span>inc <span class="ot">&lt;-</span> trials<span class="sc">$</span>inc_mean </span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>response_var <span class="ot">&lt;-</span> <span class="st">'inc'</span>  </span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>results1 <span class="ot">&lt;-</span> <span class="fu">windowpane_tests</span>(data1, response_var, <span class="at">corr_type =</span> <span class="st">"spearman"</span>, <span class="at">R =</span> <span class="dv">1000</span>)</span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a>results_RH <span class="ot">&lt;-</span> results1<span class="sc">$</span>results</span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-9"><a href="#cb76-9" aria-hidden="true" tabindex="-1"></a>data2 <span class="ot">&lt;-</span> PRECTOTCORR_7 </span>
<span id="cb76-10"><a href="#cb76-10" aria-hidden="true" tabindex="-1"></a>data2<span class="sc">$</span>inc <span class="ot">&lt;-</span> trials<span class="sc">$</span>inc_mean </span>
<span id="cb76-11"><a href="#cb76-11" aria-hidden="true" tabindex="-1"></a>response_var <span class="ot">&lt;-</span> <span class="st">'inc'</span>  </span>
<span id="cb76-12"><a href="#cb76-12" aria-hidden="true" tabindex="-1"></a>results2 <span class="ot">&lt;-</span> <span class="fu">windowpane_tests</span>(data2, response_var, <span class="at">corr_type =</span> <span class="st">"spearman"</span>, <span class="at">R =</span> <span class="dv">1000</span>)</span>
<span id="cb76-13"><a href="#cb76-13" aria-hidden="true" tabindex="-1"></a>results_PREC <span class="ot">&lt;-</span> results2<span class="sc">$</span>results</span>
<span id="cb76-14"><a href="#cb76-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-15"><a href="#cb76-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-16"><a href="#cb76-16" aria-hidden="true" tabindex="-1"></a>data3 <span class="ot">&lt;-</span> T2M_MAX_7 <span class="co"># enter the dataset</span></span>
<span id="cb76-17"><a href="#cb76-17" aria-hidden="true" tabindex="-1"></a>data3<span class="sc">$</span>inc <span class="ot">&lt;-</span> trials<span class="sc">$</span>inc_mean </span>
<span id="cb76-18"><a href="#cb76-18" aria-hidden="true" tabindex="-1"></a>response_var <span class="ot">&lt;-</span> <span class="st">'inc'</span>  </span>
<span id="cb76-19"><a href="#cb76-19" aria-hidden="true" tabindex="-1"></a>results3 <span class="ot">&lt;-</span> <span class="fu">windowpane_tests</span>(data3, response_var, <span class="at">corr_type =</span> <span class="st">"spearman"</span>, <span class="at">R =</span> <span class="dv">1000</span>)</span>
<span id="cb76-20"><a href="#cb76-20" aria-hidden="true" tabindex="-1"></a>results_TMAX <span class="ot">&lt;-</span> results3<span class="sc">$</span>results</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The first variable in the results dataframe contains the name of the variable. We can extract the starting and ending day from each window using the <code>extract</code> function, which allows for regex-based extraction into new columns. In this case, two new columns will be created representing the extreme days of the window.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Use strcapture to extract components into new columns</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>df_TMINb7 <span class="ot">&lt;-</span> results_TMINb <span class="sc">|&gt;</span></span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">extract</span>(variable, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">"variable_prefix"</span>, <span class="st">"low"</span>, <span class="st">"high"</span>), </span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">regex =</span> <span class="st">"^(.*)_(-?</span><span class="sc">\\</span><span class="st">d+)_(-?</span><span class="sc">\\</span><span class="st">d+)$"</span>, <span class="at">convert =</span> <span class="cn">TRUE</span>)</span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a>df_RH7 <span class="ot">&lt;-</span> results_RH <span class="sc">|&gt;</span></span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">extract</span>(variable, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">"variable_prefix"</span>, <span class="st">"low"</span>, <span class="st">"high"</span>), </span>
<span id="cb77-9"><a href="#cb77-9" aria-hidden="true" tabindex="-1"></a>          <span class="at">regex =</span> <span class="st">"^(.*)_(-?</span><span class="sc">\\</span><span class="st">d+)_(-?</span><span class="sc">\\</span><span class="st">d+)$"</span>, <span class="at">convert =</span> <span class="cn">TRUE</span>)</span>
<span id="cb77-10"><a href="#cb77-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-11"><a href="#cb77-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-12"><a href="#cb77-12" aria-hidden="true" tabindex="-1"></a>df_PREC7 <span class="ot">&lt;-</span> results_PREC <span class="sc">|&gt;</span></span>
<span id="cb77-13"><a href="#cb77-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">extract</span>(variable, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">"variable_prefix"</span>, <span class="st">"low"</span>, <span class="st">"high"</span>), </span>
<span id="cb77-14"><a href="#cb77-14" aria-hidden="true" tabindex="-1"></a>          <span class="at">regex =</span> <span class="st">"^(.*)_(-?</span><span class="sc">\\</span><span class="st">d+)_(-?</span><span class="sc">\\</span><span class="st">d+)$"</span>, <span class="at">convert =</span> <span class="cn">TRUE</span>)</span>
<span id="cb77-15"><a href="#cb77-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-16"><a href="#cb77-16" aria-hidden="true" tabindex="-1"></a>df_TMAX7 <span class="ot">&lt;-</span> results_TMAX <span class="sc">|&gt;</span></span>
<span id="cb77-17"><a href="#cb77-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">extract</span>(variable, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">"variable_prefix"</span>, <span class="st">"low"</span>, <span class="st">"high"</span>), </span>
<span id="cb77-18"><a href="#cb77-18" aria-hidden="true" tabindex="-1"></a>          <span class="at">regex =</span> <span class="st">"^(.*)_(-?</span><span class="sc">\\</span><span class="st">d+)_(-?</span><span class="sc">\\</span><span class="st">d+)$"</span>, <span class="at">convert =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now we can plot the mean correlation for the start day of each window.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>p_TMIN <span class="ot">&lt;-</span> df_TMINb7 <span class="sc">|&gt;</span> </span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(low, mean_corr, <span class="at">fill =</span> p_value))<span class="sc">+</span></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>()<span class="sc">+</span></span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_r4pde</span>(<span class="at">font_size =</span> <span class="dv">12</span>)<span class="sc">+</span></span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"N. days TMIN &lt; 15C"</span>,</span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"7-day window"</span>,</span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Spearman's correlation"</span>,</span>
<span id="cb78-9"><a href="#cb78-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Day relative to heading date "</span>)</span>
<span id="cb78-10"><a href="#cb78-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-11"><a href="#cb78-11" aria-hidden="true" tabindex="-1"></a>p_RH <span class="ot">&lt;-</span> df_RH7 <span class="sc">|&gt;</span> </span>
<span id="cb78-12"><a href="#cb78-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(low, mean_corr, <span class="at">fill =</span> p_value))<span class="sc">+</span></span>
<span id="cb78-13"><a href="#cb78-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb78-14"><a href="#cb78-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>()<span class="sc">+</span></span>
<span id="cb78-15"><a href="#cb78-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_r4pde</span>(<span class="at">font_size =</span> <span class="dv">12</span>)<span class="sc">+</span></span>
<span id="cb78-16"><a href="#cb78-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Relative humidity"</span>, </span>
<span id="cb78-17"><a href="#cb78-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"7-day window"</span>,</span>
<span id="cb78-18"><a href="#cb78-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Spearman's correlation"</span>,</span>
<span id="cb78-19"><a href="#cb78-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Day relative to heading date "</span>)</span>
<span id="cb78-20"><a href="#cb78-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-21"><a href="#cb78-21" aria-hidden="true" tabindex="-1"></a>p_TMAX <span class="ot">&lt;-</span> df_TMAX7 <span class="sc">|&gt;</span> </span>
<span id="cb78-22"><a href="#cb78-22" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(low, mean_corr, <span class="at">fill =</span> p_value))<span class="sc">+</span></span>
<span id="cb78-23"><a href="#cb78-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb78-24"><a href="#cb78-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>()<span class="sc">+</span></span>
<span id="cb78-25"><a href="#cb78-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_r4pde</span>(<span class="at">font_size =</span> <span class="dv">12</span>)<span class="sc">+</span></span>
<span id="cb78-26"><a href="#cb78-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Max. temperature"</span>, </span>
<span id="cb78-27"><a href="#cb78-27" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"7-day window"</span>,</span>
<span id="cb78-28"><a href="#cb78-28" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Spearman's correlation"</span>,</span>
<span id="cb78-29"><a href="#cb78-29" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Day relative to heading date "</span>)</span>
<span id="cb78-30"><a href="#cb78-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-31"><a href="#cb78-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-32"><a href="#cb78-32" aria-hidden="true" tabindex="-1"></a>p_PREC <span class="ot">&lt;-</span> df_PREC7 <span class="sc">|&gt;</span> </span>
<span id="cb78-33"><a href="#cb78-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(low, mean_corr, <span class="at">fill =</span> p_value))<span class="sc">+</span></span>
<span id="cb78-34"><a href="#cb78-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb78-35"><a href="#cb78-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>()<span class="sc">+</span></span>
<span id="cb78-36"><a href="#cb78-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_r4pde</span>(<span class="at">font_size =</span> <span class="dv">12</span>)<span class="sc">+</span></span>
<span id="cb78-37"><a href="#cb78-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Cumulative rainfall"</span>, </span>
<span id="cb78-38"><a href="#cb78-38" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"7-day window"</span>,</span>
<span id="cb78-39"><a href="#cb78-39" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Spearman's correlation"</span>,</span>
<span id="cb78-40"><a href="#cb78-40" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Day relative to heading date "</span>)</span>
<span id="cb78-41"><a href="#cb78-41" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb78-42"><a href="#cb78-42" aria-hidden="true" tabindex="-1"></a>scale_common <span class="ot">&lt;-</span> <span class="fu">scale_fill_viridis_c</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), </span>
<span id="cb78-43"><a href="#cb78-43" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">na.value =</span> <span class="st">"grey90"</span>)</span>
<span id="cb78-44"><a href="#cb78-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-45"><a href="#cb78-45" aria-hidden="true" tabindex="-1"></a>p_TMIN <span class="ot">&lt;-</span> p_TMIN <span class="sc">+</span> scale_common</span>
<span id="cb78-46"><a href="#cb78-46" aria-hidden="true" tabindex="-1"></a>p_TMAX <span class="ot">&lt;-</span> p_TMAX <span class="sc">+</span> scale_common</span>
<span id="cb78-47"><a href="#cb78-47" aria-hidden="true" tabindex="-1"></a>p_RH <span class="ot">&lt;-</span> p_RH <span class="sc">+</span> scale_common</span>
<span id="cb78-48"><a href="#cb78-48" aria-hidden="true" tabindex="-1"></a>p_PREC <span class="ot">&lt;-</span> p_PREC <span class="sc">+</span> scale_common</span>
<span id="cb78-49"><a href="#cb78-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-50"><a href="#cb78-50" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine plots using patchwork and collect guides</span></span>
<span id="cb78-51"><a href="#cb78-51" aria-hidden="true" tabindex="-1"></a>(p_TMIN <span class="sc">|</span> p_TMAX) <span class="sc">/</span> (p_RH <span class="sc">|</span> p_PREC) <span class="sc">+</span> </span>
<span id="cb78-52"><a href="#cb78-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">guides =</span> <span class="st">"collect"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="prediction-disease-modeling_files/figure-html/unnamed-chunk-43-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Interpretation</strong>. All 7-day-length variables but maximum temperature were strongly associated with the incidence of wheat blast. These three variables can be used as candidates for developing predictions models.</p>
</section>
</section>
<section id="functional-data-analysis" class="level4" data-number="20.3.1.2">
<h4 data-number="20.3.1.2" class="anchored" data-anchor-id="functional-data-analysis"><span class="header-section-number">20.3.1.2</span> Functional data analysis</h4>
<p>Functional Data Analysis (FDA) is a statistical approach used to analyze and model data that varies continuously over time or space. It represents entire data sequences (e.g., time series) as smooth functions, allowing for the exploration of trends, patterns, and relationships in complex, continuous processes rather than relying on discrete, segmented data points <span class="citation" data-cites="ramsay2005functional Gertheiss2024">(<a href="references.html#ref-Gertheiss2024" role="doc-biblioref">Gertheiss et al. 2024</a>; <a href="references.html#ref-ramsay2005functional" role="doc-biblioref">Ramsay and Silverman 2005</a>)</span>.</p>
<p>In the FDA framework, scalar-on-function and function-on-scalar models are two types of FDA models, designed to examine relationships between functional predictors and outcomes. Function-on-scalar models use single values (e.g., mean daily relative humidity) as predictors to explain the shape of an entire outcome curve (e.g.&nbsp;disease). Meanwhile, in scalar-on-function models, time series data (e.g., daily temperatures) are used as predictors to identify which parts of the series are linked to a single outcome. Together, these FDA models offer complementary insights, allowing either for predicting a scalar outcome from curves or understanding how scalar predictors influence entire functions <span class="citation" data-cites="ramsay2005functional">(<a href="references.html#ref-ramsay2005functional" role="doc-biblioref">Ramsay and Silverman 2005</a>)</span>.</p>
<p>Initially applied in plant pathology to study the relationship between Fusarium head blight outbreaks and weather variables over time (using the function-on-scalar model) <span class="citation" data-cites="shah2019a">(<a href="references.html#ref-shah2019a" role="doc-biblioref">Shah et al. 2019a</a>)</span>, FDA has since been adopted in other plant pathology studies with similar objectives <span class="citation" data-cites="shah2019 hjelkrem2021a alves2022a">(<a href="references.html#ref-alves2022a" role="doc-biblioref">Alves et al. 2022</a>; <a href="references.html#ref-hjelkrem2021a" role="doc-biblioref">Hjelkrem et al. 2021</a>; <a href="references.html#ref-shah2019" role="doc-biblioref">Shah et al. 2019b</a>)</span>.</p>
<p>In particular, <span class="citation" data-cites="shah2019">Shah et al. (<a href="references.html#ref-shah2019" role="doc-biblioref">2019b</a>)</span> used FDA as a basis to develop logistic regression models for large-scale deployment by utilizing FDA through a scalar-on-function approach to predict plant diseases - in this approach, the model identifies which parts of the time series (e.g., certain weeks or days) are most associated with the disease outcome, helping to predict whether an epidemic is likely to occur based on patterns in the weather series. Moreover, FDA was employed to identify the most relevant temporal regions of weather series associated with disease outbreaks, improving prediction by summarizing key windows across critical growth stages. The authors discussed that , unlike traditional window-pane analysis, FDA reduces statistical testing issues and offers a more refined method for incorporating novel predictors into simple, effective models <span class="citation" data-cites="shah2019">(<a href="references.html#ref-shah2019" role="doc-biblioref">Shah et al. 2019b</a>)</span>.</p>
<p>With the objective of identifying temporal regions of the weather series, Alves et al.&nbsp;(unpublished) proposed the use of a function-on-scalar model to gain insights about the time series related to a binary disease outcome by identifying significant regions in the weather series where the curves diverge. The function-on-scalar approach here compares the average functional trajectories of two groups: epidemic vs.&nbsp;non-epidemic. It identifies time regions where the mean weather curves for the two groups differ significantly. While the model doesn’t directly predict a binary response, it aids in diagnosing critical time points in the series that differentiate the two disease outcomes, supporting model development and refinement for binary classification.</p>
<p>For that purpose, the authors used the <code>ITP2bspline()</code> function of the R package {fdatest} that implements the Interval Testing Procedure (ITP) to compare two functional populations (epidemic vs.&nbsp;non-epidemic) evaluated on a uniform grid. It represents data using B-spline basis functions and assesses the significance of each basis coefficient with interval-wise control of the Family Wise Error Rate (FWER) <span class="citation" data-cites="pini2016">(<a href="references.html#ref-pini2016" role="doc-biblioref">Pini and Vantini 2016</a>)</span>.</p>
<p>In this section, I will first demonstrate how to fit the function-on-scalar regression with the objective of visualizing two curves, the difference coefficient function and the overall mean coefficient curve. The former shows how the effect of a weather-related variable on the response variable changes over the days relative to a reference date (e.g.&nbsp;planting date, flowering). It helps to identify critical windows when the weather variations have the most substantial impact. The latter represents the cumulative or overall effect of weather over the time period. It helps assess whether the influence of weather variable accumulates or stabilizes over time.</p>
<p>Then, I will demonstrate the Interval Testing Procedure (ITP) to compare two functional populations (epidemic vs.&nbsp;non-epidemic) and identify exactly the days in the series that the two populations are significantly different. We will keep analyzing the data on wheat blast epidemics in Brazil.</p>
<section id="function-on-scalar-regression" class="level5" data-number="20.3.1.2.1">
<h5 data-number="20.3.1.2.1" class="anchored" data-anchor-id="function-on-scalar-regression"><span class="header-section-number">20.3.1.2.1</span> Function-on-scalar regression</h5>
<p>The following analysis uses function-on-scalar regression to explore the relationship between relative humidity at 2 meters (RH2M) and the occurrence of wheat blast epidemics. Let’s first load the necessary libraries.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(r4pde)</span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(refund)</span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The first step involves reading and merging two datasets:</p>
<p>- <code>trials</code>: Contains disease data with heading dates.</p>
<p>- <code>weather_data</code>: Contains weather data for specific time windows. It was created in the previous section on window-pane and can be downloaded <a href="https://raw.githubusercontent.com/emdelponte/epidemiology-R/refs/heads/main/data/weather_windowpane.csv">here</a>.</p>
<p>The datasets are merged into <code>trials_weather</code>, and the resulting data is transformed into a wide format where each column represents time points (days), and rows correspond to individual studies. The binary epidemic status is created, where:</p>
<ul>
<li>1 indicates an epidemic (if <code>inc_mean &gt; 20</code>).</li>
<li>0 indicates no epidemic (if <code>inc_mean &lt;= 20</code>).</li>
</ul>
<p>The weather variable (<code>RH2M</code>) is used as the predictor, and time points (days) are calculated relative to the heading date.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load the disease datase</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>trials <span class="ot">&lt;-</span> r4pde<span class="sc">::</span>BlastWheat</span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>trials<span class="sc">$</span>heading <span class="ot">=</span> <span class="fu">as.Date</span>(trials<span class="sc">$</span>heading, <span class="at">format =</span> <span class="st">"%d-%m-%Y"</span>)</span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a><span class="co"># load the weather data constructed in previous section</span></span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a>weather_data <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(<span class="st">"https://raw.githubusercontent.com/emdelponte/epidemiology-R/refs/heads/main/data/weather_windowpane.csv"</span>)</span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a>trials_weather <span class="ot">&lt;-</span> <span class="fu">full_join</span>(trials, weather_data)</span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-9"><a href="#cb80-9" aria-hidden="true" tabindex="-1"></a><span class="co"># create epidemic variable and number of days relative to heading</span></span>
<span id="cb80-10"><a href="#cb80-10" aria-hidden="true" tabindex="-1"></a>dat_wide_RH <span class="ot">&lt;-</span> trials_weather <span class="sc">|&gt;</span></span>
<span id="cb80-11"><a href="#cb80-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">epidemic =</span> <span class="fu">if_else</span>(inc_mean <span class="sc">&gt;</span> <span class="dv">20</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb80-12"><a href="#cb80-12" aria-hidden="true" tabindex="-1"></a>           <span class="at">days =</span> <span class="fu">as.numeric</span>(<span class="sc">-</span>(heading <span class="sc">-</span> YYYYMMDD))) <span class="sc">|&gt;</span></span>
<span id="cb80-13"><a href="#cb80-13" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(study, epidemic, days, RH2M) <span class="sc">|&gt;</span></span>
<span id="cb80-14"><a href="#cb80-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_wider</span>(<span class="at">id_cols =</span> <span class="fu">c</span>(study, epidemic), </span>
<span id="cb80-15"><a href="#cb80-15" aria-hidden="true" tabindex="-1"></a>                <span class="at">names_from =</span> days, <span class="at">values_from =</span> RH2M)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The response vector is the epidemic status (0 or 1), while the predictor matrix contains the values of the specified weather variable across time. The model fits smooth functions to represent the effects of time and the epidemic status on the weather variable using penalized splines. The function-on-scalar regression model is given by:</p>
<p><span class="math inline">\(y_{ij} = \beta_0(t_j) + \beta_1(t_j) x_i + \epsilon_{ij}\)</span></p>
<p>where: <span class="math inline">\(y_{ij}\)</span> is the value of the weather variable for study <span class="math inline">\(i\)</span> at time <span class="math inline">\(j\)</span>; <span class="math inline">\(\beta_0(t_j)\)</span> is the smooth function for the overall mean effect over time; <span class="math inline">\(\beta_1(t_j)\)</span> is the smooth function representing the effect of epidemic status over time; <span class="math inline">\(x_i\)</span> is the binary epidemic status (0 or 1); and <span class="math inline">\(\epsilon{ij}\)</span> is the error term.</p>
<p>We can now fit the model using the <code>pffr()</code> function of the {refund} package.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> dat_wide_RH<span class="sc">$</span>epidemic  <span class="co"># Response vector</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> dat_wide_RH <span class="sc">|&gt;</span> </span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>study, <span class="sc">-</span>epidemic) <span class="sc">|&gt;</span> </span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.matrix</span>()  <span class="co"># Matrix of predictors</span></span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a>yind <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">colnames</span>(y))</span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-8"><a href="#cb81-8" aria-hidden="true" tabindex="-1"></a>FOSR_RH <span class="ot">&lt;-</span> <span class="fu">pffr</span>(y <span class="sc">~</span> x, </span>
<span id="cb81-9"><a href="#cb81-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">yind =</span> yind,</span>
<span id="cb81-10"><a href="#cb81-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">bs.yindex =</span> <span class="fu">list</span>(<span class="at">bs =</span> <span class="st">"ps"</span>, <span class="at">k =</span> <span class="dv">30</span>, <span class="at">m =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>)), </span>
<span id="cb81-11"><a href="#cb81-11" aria-hidden="true" tabindex="-1"></a>             <span class="at">bs.int =</span> <span class="fu">list</span>(<span class="at">bs =</span> <span class="st">"ps"</span>, <span class="at">k =</span> <span class="dv">30</span>, <span class="at">m =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>)),</span>
<span id="cb81-12"><a href="#cb81-12" aria-hidden="true" tabindex="-1"></a>                <span class="at">algorithm =</span> <span class="st">"gam"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s extract the coefficients of the model fit object and prepare the data and plot using gpplot.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>  coef_list <span class="ot">&lt;-</span> <span class="fu">coef</span>(FOSR_RH)<span class="sc">$</span>smterms</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>using seWithMean for  s(yind.vec) .</code></pre>
</div>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>  mean_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">time =</span> coef_list[[<span class="dv">1</span>]]<span class="sc">$</span>coef[, <span class="st">"yind.vec"</span>],</span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">value =</span> coef_list[[<span class="dv">1</span>]]<span class="sc">$</span>coef[, <span class="st">"value"</span>],</span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">lower =</span> coef_list[[<span class="dv">1</span>]]<span class="sc">$</span>coef[, <span class="st">"value"</span>] <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> coef_list[[<span class="dv">1</span>]]<span class="sc">$</span>coef[, <span class="st">"se"</span>],</span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">upper =</span> coef_list[[<span class="dv">1</span>]]<span class="sc">$</span>coef[, <span class="st">"value"</span>] <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> coef_list[[<span class="dv">1</span>]]<span class="sc">$</span>coef[, <span class="st">"se"</span>],</span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">term =</span> <span class="st">"Overall Mean"</span></span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb84-9"><a href="#cb84-9" aria-hidden="true" tabindex="-1"></a>  x_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb84-10"><a href="#cb84-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">time =</span> coef_list[[<span class="dv">2</span>]]<span class="sc">$</span>coef[, <span class="st">"yind.vec"</span>],</span>
<span id="cb84-11"><a href="#cb84-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">value =</span> coef_list[[<span class="dv">2</span>]]<span class="sc">$</span>coef[, <span class="st">"value"</span>],</span>
<span id="cb84-12"><a href="#cb84-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">lower =</span> coef_list[[<span class="dv">2</span>]]<span class="sc">$</span>coef[, <span class="st">"value"</span>] <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> coef_list[[<span class="dv">2</span>]]<span class="sc">$</span>coef[, <span class="st">"se"</span>],</span>
<span id="cb84-13"><a href="#cb84-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">upper =</span> coef_list[[<span class="dv">2</span>]]<span class="sc">$</span>coef[, <span class="st">"value"</span>] <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> coef_list[[<span class="dv">2</span>]]<span class="sc">$</span>coef[, <span class="st">"se"</span>],</span>
<span id="cb84-14"><a href="#cb84-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">term =</span> <span class="st">"Difference"</span></span>
<span id="cb84-15"><a href="#cb84-15" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb84-16"><a href="#cb84-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb84-17"><a href="#cb84-17" aria-hidden="true" tabindex="-1"></a>  plot_df <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(mean_df, x_df)</span>
<span id="cb84-18"><a href="#cb84-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb84-19"><a href="#cb84-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-20"><a href="#cb84-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(plot_df, <span class="fu">aes</span>(<span class="at">x =</span> time, <span class="at">y =</span> value)) <span class="sc">+</span></span>
<span id="cb84-21"><a href="#cb84-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> lower, <span class="at">ymax =</span> upper), </span>
<span id="cb84-22"><a href="#cb84-22" aria-hidden="true" tabindex="-1"></a>                <span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb84-23"><a href="#cb84-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb84-24"><a href="#cb84-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_grid</span>(<span class="at">rows =</span> <span class="fu">vars</span>(term), </span>
<span id="cb84-25"><a href="#cb84-25" aria-hidden="true" tabindex="-1"></a>               <span class="at">scales =</span> <span class="st">"free_y"</span>) <span class="sc">+</span></span>
<span id="cb84-26"><a href="#cb84-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_r4pde</span>(<span class="at">font_size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb84-27"><a href="#cb84-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="fu">aes</span>(<span class="at">yintercept =</span> <span class="dv">0</span>), </span>
<span id="cb84-28"><a href="#cb84-28" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">"grey"</span>, </span>
<span id="cb84-29"><a href="#cb84-29" aria-hidden="true" tabindex="-1"></a>               <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb84-30"><a href="#cb84-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_vline</span>(<span class="fu">aes</span>(<span class="at">xintercept =</span> <span class="dv">0</span>), </span>
<span id="cb84-31"><a href="#cb84-31" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">"grey"</span>, </span>
<span id="cb84-32"><a href="#cb84-32" aria-hidden="true" tabindex="-1"></a>               <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb84-33"><a href="#cb84-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Day relative to wheat heading"</span>, <span class="at">y =</span> <span class="st">"Coefficient Function"</span>,</span>
<span id="cb84-34"><a href="#cb84-34" aria-hidden="true" tabindex="-1"></a>         <span class="at">title =</span> <span class="st">"RH2M"</span>) <span class="sc">+</span></span>
<span id="cb84-35"><a href="#cb84-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="fu">rel</span>(<span class="fl">1.0</span>)),</span>
<span id="cb84-36"><a href="#cb84-36" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">12</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="prediction-disease-modeling_files/figure-html/unnamed-chunk-47-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Because we have several weather variables, we can facilitate the process by creating a function named <code>fosr()</code> that can be applied for the other variables.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the function for function-on-scalar regression</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>fosr <span class="ot">&lt;-</span> <span class="cf">function</span>(data, weather_var) {</span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Step 1: Prepare the dataset and transform to wide format</span></span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a>  dat_wide <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">epidemic =</span> <span class="fu">if_else</span>(inc_mean <span class="sc">&gt;</span> <span class="dv">20</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">days =</span> <span class="fu">as.numeric</span>(<span class="sc">-</span>(heading <span class="sc">-</span> YYYYMMDD))) <span class="sc">%&gt;%</span></span>
<span id="cb85-8"><a href="#cb85-8" aria-hidden="true" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">select</span>(study, epidemic, days, <span class="sc">!!</span><span class="fu">sym</span>(weather_var)) <span class="sc">%&gt;%</span></span>
<span id="cb85-9"><a href="#cb85-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_wider</span>(<span class="at">id_cols =</span> <span class="fu">c</span>(study, epidemic), <span class="at">names_from =</span> days, <span class="at">values_from =</span> <span class="sc">!!</span><span class="fu">sym</span>(weather_var))</span>
<span id="cb85-10"><a href="#cb85-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb85-11"><a href="#cb85-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-12"><a href="#cb85-12" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> dat_wide<span class="sc">$</span>epidemic  <span class="co"># Response vector</span></span>
<span id="cb85-13"><a href="#cb85-13" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> dat_wide <span class="sc">|&gt;</span></span>
<span id="cb85-14"><a href="#cb85-14" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>study, <span class="sc">-</span>epidemic) <span class="sc">|&gt;</span></span>
<span id="cb85-15"><a href="#cb85-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.matrix</span>()  <span class="co"># Matrix of predictors</span></span>
<span id="cb85-16"><a href="#cb85-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb85-17"><a href="#cb85-17" aria-hidden="true" tabindex="-1"></a>  m2 <span class="ot">&lt;-</span> <span class="fu">pffr</span>(y <span class="sc">~</span> x, </span>
<span id="cb85-18"><a href="#cb85-18" aria-hidden="true" tabindex="-1"></a>             <span class="at">yind =</span> yind,</span>
<span id="cb85-19"><a href="#cb85-19" aria-hidden="true" tabindex="-1"></a>             <span class="at">bs.yindex =</span> <span class="fu">list</span>(<span class="at">bs =</span> <span class="st">"ps"</span>, <span class="at">k =</span> <span class="dv">30</span>, <span class="at">m =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>)), </span>
<span id="cb85-20"><a href="#cb85-20" aria-hidden="true" tabindex="-1"></a>             <span class="at">bs.int =</span> <span class="fu">list</span>(<span class="at">bs =</span> <span class="st">"ps"</span>, <span class="at">k =</span> <span class="dv">30</span>, <span class="at">m =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>)),</span>
<span id="cb85-21"><a href="#cb85-21" aria-hidden="true" tabindex="-1"></a>                <span class="at">algorithm =</span> <span class="st">"gam"</span>)</span>
<span id="cb85-22"><a href="#cb85-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-23"><a href="#cb85-23" aria-hidden="true" tabindex="-1"></a>  coef_list <span class="ot">&lt;-</span> <span class="fu">coef</span>(m2)<span class="sc">$</span>smterms</span>
<span id="cb85-24"><a href="#cb85-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb85-25"><a href="#cb85-25" aria-hidden="true" tabindex="-1"></a>  mean_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb85-26"><a href="#cb85-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">time =</span> coef_list[[<span class="dv">1</span>]]<span class="sc">$</span>coef[, <span class="st">"yind.vec"</span>],</span>
<span id="cb85-27"><a href="#cb85-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">value =</span> coef_list[[<span class="dv">1</span>]]<span class="sc">$</span>coef[, <span class="st">"value"</span>],</span>
<span id="cb85-28"><a href="#cb85-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">lower =</span> coef_list[[<span class="dv">1</span>]]<span class="sc">$</span>coef[, <span class="st">"value"</span>] <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> coef_list[[<span class="dv">1</span>]]<span class="sc">$</span>coef[, <span class="st">"se"</span>],</span>
<span id="cb85-29"><a href="#cb85-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">upper =</span> coef_list[[<span class="dv">1</span>]]<span class="sc">$</span>coef[, <span class="st">"value"</span>] <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> coef_list[[<span class="dv">1</span>]]<span class="sc">$</span>coef[, <span class="st">"se"</span>],</span>
<span id="cb85-30"><a href="#cb85-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">term =</span> <span class="st">"Overall Mean"</span></span>
<span id="cb85-31"><a href="#cb85-31" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb85-32"><a href="#cb85-32" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb85-33"><a href="#cb85-33" aria-hidden="true" tabindex="-1"></a>  x_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb85-34"><a href="#cb85-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">time =</span> coef_list[[<span class="dv">2</span>]]<span class="sc">$</span>coef[, <span class="st">"yind.vec"</span>],</span>
<span id="cb85-35"><a href="#cb85-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">value =</span> coef_list[[<span class="dv">2</span>]]<span class="sc">$</span>coef[, <span class="st">"value"</span>],</span>
<span id="cb85-36"><a href="#cb85-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">lower =</span> coef_list[[<span class="dv">2</span>]]<span class="sc">$</span>coef[, <span class="st">"value"</span>] <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> coef_list[[<span class="dv">2</span>]]<span class="sc">$</span>coef[, <span class="st">"se"</span>],</span>
<span id="cb85-37"><a href="#cb85-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">upper =</span> coef_list[[<span class="dv">2</span>]]<span class="sc">$</span>coef[, <span class="st">"value"</span>] <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> coef_list[[<span class="dv">2</span>]]<span class="sc">$</span>coef[, <span class="st">"se"</span>],</span>
<span id="cb85-38"><a href="#cb85-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">term =</span> <span class="st">"Difference"</span></span>
<span id="cb85-39"><a href="#cb85-39" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb85-40"><a href="#cb85-40" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb85-41"><a href="#cb85-41" aria-hidden="true" tabindex="-1"></a>  plot_df <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(mean_df, x_df)</span>
<span id="cb85-42"><a href="#cb85-42" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb85-43"><a href="#cb85-43" aria-hidden="true" tabindex="-1"></a>   <span class="fu">ggplot</span>(plot_df, <span class="fu">aes</span>(<span class="at">x =</span> time, <span class="at">y =</span> value)) <span class="sc">+</span></span>
<span id="cb85-44"><a href="#cb85-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> lower, <span class="at">ymax =</span> upper), </span>
<span id="cb85-45"><a href="#cb85-45" aria-hidden="true" tabindex="-1"></a>                <span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb85-46"><a href="#cb85-46" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb85-47"><a href="#cb85-47" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_grid</span>(<span class="at">rows =</span> <span class="fu">vars</span>(term), </span>
<span id="cb85-48"><a href="#cb85-48" aria-hidden="true" tabindex="-1"></a>               <span class="at">scales =</span> <span class="st">"free_y"</span>) <span class="sc">+</span></span>
<span id="cb85-49"><a href="#cb85-49" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_r4pde</span>(<span class="at">font_size =</span> <span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb85-50"><a href="#cb85-50" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="fu">aes</span>(<span class="at">yintercept =</span> <span class="dv">0</span>), </span>
<span id="cb85-51"><a href="#cb85-51" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">"grey"</span>, </span>
<span id="cb85-52"><a href="#cb85-52" aria-hidden="true" tabindex="-1"></a>               <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb85-53"><a href="#cb85-53" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_vline</span>(<span class="fu">aes</span>(<span class="at">xintercept =</span> <span class="dv">0</span>), </span>
<span id="cb85-54"><a href="#cb85-54" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">"grey"</span>, </span>
<span id="cb85-55"><a href="#cb85-55" aria-hidden="true" tabindex="-1"></a>               <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb85-56"><a href="#cb85-56" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Day relative to wheat heading"</span>, <span class="at">y =</span> <span class="st">"Coefficient Function"</span>,</span>
<span id="cb85-57"><a href="#cb85-57" aria-hidden="true" tabindex="-1"></a>         <span class="at">title =</span> weather_var) <span class="sc">+</span></span>
<span id="cb85-58"><a href="#cb85-58" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="fu">rel</span>(<span class="fl">1.0</span>)),</span>
<span id="cb85-59"><a href="#cb85-59" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">10</span>))</span>
<span id="cb85-60"><a href="#cb85-60" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now we can apply the function to the other variables and obtain plots for each variable.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>tmin <span class="ot">&lt;-</span> <span class="fu">fosr</span>(trials_weather, <span class="st">"T2M_MIN"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>using seWithMean for  s(yind.vec) .</code></pre>
</div>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>tmax <span class="ot">&lt;-</span> <span class="fu">fosr</span>(trials_weather, <span class="st">"T2M_MAX"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>using seWithMean for  s(yind.vec) .</code></pre>
</div>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>rh <span class="ot">&lt;-</span> <span class="fu">fosr</span>(trials_weather, <span class="st">"RH2M"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>using seWithMean for  s(yind.vec) .</code></pre>
</div>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>prec <span class="ot">&lt;-</span> <span class="fu">fosr</span>(trials_weather, <span class="st">"PRECTOTCORR"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>using seWithMean for  s(yind.vec) .</code></pre>
</div>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>(tmin <span class="sc">|</span>tmax)<span class="sc">/</span>(rh <span class="sc">|</span> prec)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="prediction-disease-modeling_files/figure-html/unnamed-chunk-49-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="interval-test-procedure" class="level5" data-number="20.3.1.2.2">
<h5 data-number="20.3.1.2.2" class="anchored" data-anchor-id="interval-test-procedure"><span class="header-section-number">20.3.1.2.2</span> Interval test procedure</h5>
<p>For this test, we need to subset the data into two epidemic conditions, transform from long to wide format and create a matrix object.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>df_epidemic <span class="ot">&lt;-</span> trials_weather <span class="sc">|&gt;</span> </span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">epidemic =</span> <span class="fu">if_else</span>(inc_mean <span class="sc">&gt;</span> <span class="dv">20</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">days =</span> <span class="fu">as.numeric</span>(<span class="sc">-</span>(heading <span class="sc">-</span> YYYYMMDD))) <span class="sc">|&gt;</span></span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(epidemic <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">|&gt;</span> </span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(RH2M, days, study)</span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-7"><a href="#cb95-7" aria-hidden="true" tabindex="-1"></a>df_non_epidemic <span class="ot">&lt;-</span> trials_weather <span class="sc">|&gt;</span> </span>
<span id="cb95-8"><a href="#cb95-8" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">epidemic =</span> <span class="fu">if_else</span>(inc_mean <span class="sc">&gt;</span> <span class="dv">20</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb95-9"><a href="#cb95-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">days =</span> <span class="fu">as.numeric</span>(<span class="sc">-</span>(heading <span class="sc">-</span> YYYYMMDD))) <span class="sc">|&gt;</span></span>
<span id="cb95-10"><a href="#cb95-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(epidemic <span class="sc">==</span> <span class="dv">0</span>) <span class="sc">|&gt;</span> </span>
<span id="cb95-11"><a href="#cb95-11" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(RH2M, days, study)</span>
<span id="cb95-12"><a href="#cb95-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-13"><a href="#cb95-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Pivot data to wide format for FDA</span></span>
<span id="cb95-14"><a href="#cb95-14" aria-hidden="true" tabindex="-1"></a>df_epidemic_wide <span class="ot">&lt;-</span> df_epidemic <span class="sc">|&gt;</span></span>
<span id="cb95-15"><a href="#cb95-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(study) <span class="sc">|&gt;</span></span>
<span id="cb95-16"><a href="#cb95-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> days, <span class="at">values_from =</span> RH2M) <span class="sc">|&gt;</span></span>
<span id="cb95-17"><a href="#cb95-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span></span>
<span id="cb95-18"><a href="#cb95-18" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>study)</span>
<span id="cb95-19"><a href="#cb95-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-20"><a href="#cb95-20" aria-hidden="true" tabindex="-1"></a>df_non_epidemic_wide <span class="ot">&lt;-</span> df_non_epidemic <span class="sc">|&gt;</span></span>
<span id="cb95-21"><a href="#cb95-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(study) <span class="sc">|&gt;</span></span>
<span id="cb95-22"><a href="#cb95-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> days, <span class="at">values_from =</span> RH2M) <span class="sc">|&gt;</span></span>
<span id="cb95-23"><a href="#cb95-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span></span>
<span id="cb95-24"><a href="#cb95-24" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>study)</span>
<span id="cb95-25"><a href="#cb95-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-26"><a href="#cb95-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to matrix</span></span>
<span id="cb95-27"><a href="#cb95-27" aria-hidden="true" tabindex="-1"></a>data_epidemic <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(df_epidemic_wide)</span>
<span id="cb95-28"><a href="#cb95-28" aria-hidden="true" tabindex="-1"></a>data_non_epidemic <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(df_non_epidemic_wide)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now we can now apply the function specifying each new data in each data argument.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(fdatest)</span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform FDA test</span></span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a>itp_result <span class="ot">&lt;-</span> <span class="fu">ITP2bspline</span>(<span class="at">data1 =</span> data_epidemic, </span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a>                          <span class="at">data2 =</span> data_non_epidemic, </span>
<span id="cb96-6"><a href="#cb96-6" aria-hidden="true" tabindex="-1"></a>                          <span class="at">B =</span> <span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "First step: basis expansion"
Swapping 'y' and 'argvals', because 'y' is  simpler,
  and 'argvals' should be;  now  dim(argvals) =  57 ;  dim(y) =  57 x 143 
[1] "Second step: joint univariate tests"
[1] "Third step: interval-wise combination and correction"
[1] "creating the p-value matrix: end of row 2 out of 57"
[1] "creating the p-value matrix: end of row 3 out of 57"
[1] "creating the p-value matrix: end of row 4 out of 57"
[1] "creating the p-value matrix: end of row 5 out of 57"
[1] "creating the p-value matrix: end of row 6 out of 57"
[1] "creating the p-value matrix: end of row 7 out of 57"
[1] "creating the p-value matrix: end of row 8 out of 57"
[1] "creating the p-value matrix: end of row 9 out of 57"
[1] "creating the p-value matrix: end of row 10 out of 57"
[1] "creating the p-value matrix: end of row 11 out of 57"
[1] "creating the p-value matrix: end of row 12 out of 57"
[1] "creating the p-value matrix: end of row 13 out of 57"
[1] "creating the p-value matrix: end of row 14 out of 57"
[1] "creating the p-value matrix: end of row 15 out of 57"
[1] "creating the p-value matrix: end of row 16 out of 57"
[1] "creating the p-value matrix: end of row 17 out of 57"
[1] "creating the p-value matrix: end of row 18 out of 57"
[1] "creating the p-value matrix: end of row 19 out of 57"
[1] "creating the p-value matrix: end of row 20 out of 57"
[1] "creating the p-value matrix: end of row 21 out of 57"
[1] "creating the p-value matrix: end of row 22 out of 57"
[1] "creating the p-value matrix: end of row 23 out of 57"
[1] "creating the p-value matrix: end of row 24 out of 57"
[1] "creating the p-value matrix: end of row 25 out of 57"
[1] "creating the p-value matrix: end of row 26 out of 57"
[1] "creating the p-value matrix: end of row 27 out of 57"
[1] "creating the p-value matrix: end of row 28 out of 57"
[1] "creating the p-value matrix: end of row 29 out of 57"
[1] "creating the p-value matrix: end of row 30 out of 57"
[1] "creating the p-value matrix: end of row 31 out of 57"
[1] "creating the p-value matrix: end of row 32 out of 57"
[1] "creating the p-value matrix: end of row 33 out of 57"
[1] "creating the p-value matrix: end of row 34 out of 57"
[1] "creating the p-value matrix: end of row 35 out of 57"
[1] "creating the p-value matrix: end of row 36 out of 57"
[1] "creating the p-value matrix: end of row 37 out of 57"
[1] "creating the p-value matrix: end of row 38 out of 57"
[1] "creating the p-value matrix: end of row 39 out of 57"
[1] "creating the p-value matrix: end of row 40 out of 57"
[1] "creating the p-value matrix: end of row 41 out of 57"
[1] "creating the p-value matrix: end of row 42 out of 57"
[1] "creating the p-value matrix: end of row 43 out of 57"
[1] "creating the p-value matrix: end of row 44 out of 57"
[1] "creating the p-value matrix: end of row 45 out of 57"
[1] "creating the p-value matrix: end of row 46 out of 57"
[1] "creating the p-value matrix: end of row 47 out of 57"
[1] "creating the p-value matrix: end of row 48 out of 57"
[1] "creating the p-value matrix: end of row 49 out of 57"
[1] "creating the p-value matrix: end of row 50 out of 57"
[1] "creating the p-value matrix: end of row 51 out of 57"
[1] "creating the p-value matrix: end of row 52 out of 57"
[1] "creating the p-value matrix: end of row 53 out of 57"
[1] "creating the p-value matrix: end of row 54 out of 57"
[1] "creating the p-value matrix: end of row 55 out of 57"
[1] "creating the p-value matrix: end of row 56 out of 57"
[1] "creating the p-value matrix: end of row 57 out of 57"
[1] "Interval Testing Procedure completed"</code></pre>
</div>
</div>
<p>Here, we can see the p-values for each time point as well as which time points were significant considering p &lt; 0.05.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="co"># global p-values</span></span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>itp_result<span class="sc">$</span>corrected.pval</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
[39] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="co"># significant components</span></span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a><span class="fu">which</span>(itp_result<span class="sc">$</span>corrected.pval <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25
[26] 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50
[51] 51 52 53 54 55 56 57</code></pre>
</div>
</div>
<p>The plot function produces two graphs, one for the curves and another for the p-values where the shaded area indicate the significance.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot FDA results</span></span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(itp_result, <span class="at">main =</span> <span class="st">"RH2M"</span>, </span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">xrange =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">28</span>, <span class="dv">28</span>), </span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">'Day'</span>, <span class="at">xaxt =</span> <span class="st">'n'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="prediction-disease-modeling_files/figure-html/unnamed-chunk-53-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">28</span>, <span class="dv">28</span>, <span class="at">by =</span> <span class="dv">2</span>), </span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">labels =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">28</span>, <span class="dv">28</span>, <span class="at">by =</span> <span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="prediction-disease-modeling_files/figure-html/unnamed-chunk-53-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Because we may have several weather variables, we can avoid repeating the code for each variable by creating a function. The arguments are the data and weather variable. Optionally, the user can define the threshold for disease.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>run_ITP_test <span class="ot">&lt;-</span> <span class="cf">function</span>(data, weather_var, <span class="at">threshold =</span> <span class="dv">20</span>, <span class="at">B =</span> <span class="dv">100</span>) {</span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Convert the weather_var input to symbol for dplyr's select function</span></span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a>  weather_var_sym <span class="ot">&lt;-</span> <span class="fu">sym</span>(weather_var)</span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb104-6"><a href="#cb104-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Filter and prepare epidemic data</span></span>
<span id="cb104-7"><a href="#cb104-7" aria-hidden="true" tabindex="-1"></a>  df_epidemic <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span> </span>
<span id="cb104-8"><a href="#cb104-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">epidemic =</span> <span class="fu">if_else</span>(inc_mean <span class="sc">&gt;</span> threshold, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb104-9"><a href="#cb104-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">days =</span> <span class="fu">as.numeric</span>(<span class="sc">-</span>(heading <span class="sc">-</span> YYYYMMDD))) <span class="sc">|&gt;</span> </span>
<span id="cb104-10"><a href="#cb104-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(epidemic <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">|&gt;</span> </span>
<span id="cb104-11"><a href="#cb104-11" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">!!</span>weather_var_sym, days, study)</span>
<span id="cb104-12"><a href="#cb104-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb104-13"><a href="#cb104-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Filter and prepare non-epidemic data</span></span>
<span id="cb104-14"><a href="#cb104-14" aria-hidden="true" tabindex="-1"></a>  df_non_epidemic <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span> </span>
<span id="cb104-15"><a href="#cb104-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">epidemic =</span> <span class="fu">if_else</span>(inc_mean <span class="sc">&gt;</span> threshold, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb104-16"><a href="#cb104-16" aria-hidden="true" tabindex="-1"></a>           <span class="at">days =</span> <span class="fu">as.numeric</span>(<span class="sc">-</span>(heading <span class="sc">-</span> YYYYMMDD))) <span class="sc">|&gt;</span> </span>
<span id="cb104-17"><a href="#cb104-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(epidemic <span class="sc">==</span> <span class="dv">0</span>) <span class="sc">|&gt;</span> </span>
<span id="cb104-18"><a href="#cb104-18" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">!!</span>weather_var_sym, days, study)</span>
<span id="cb104-19"><a href="#cb104-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb104-20"><a href="#cb104-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Pivot epidemic data to wide format</span></span>
<span id="cb104-21"><a href="#cb104-21" aria-hidden="true" tabindex="-1"></a>  df_epidemic_wide <span class="ot">&lt;-</span> df_epidemic <span class="sc">|&gt;</span> </span>
<span id="cb104-22"><a href="#cb104-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(study) <span class="sc">|&gt;</span> </span>
<span id="cb104-23"><a href="#cb104-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> days, <span class="at">values_from =</span> <span class="sc">!!</span>weather_var_sym) <span class="sc">|&gt;</span> </span>
<span id="cb104-24"><a href="#cb104-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>() <span class="sc">|&gt;</span> </span>
<span id="cb104-25"><a href="#cb104-25" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>study)</span>
<span id="cb104-26"><a href="#cb104-26" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb104-27"><a href="#cb104-27" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Pivot non-epidemic data to wide format</span></span>
<span id="cb104-28"><a href="#cb104-28" aria-hidden="true" tabindex="-1"></a>  df_non_epidemic_wide <span class="ot">&lt;-</span> df_non_epidemic <span class="sc">|&gt;</span> </span>
<span id="cb104-29"><a href="#cb104-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(study) <span class="sc">|&gt;</span> </span>
<span id="cb104-30"><a href="#cb104-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> days, <span class="at">values_from =</span> <span class="sc">!!</span>weather_var_sym) <span class="sc">|&gt;</span> </span>
<span id="cb104-31"><a href="#cb104-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>() <span class="sc">|&gt;</span> </span>
<span id="cb104-32"><a href="#cb104-32" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>study)</span>
<span id="cb104-33"><a href="#cb104-33" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb104-34"><a href="#cb104-34" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Convert to matrix</span></span>
<span id="cb104-35"><a href="#cb104-35" aria-hidden="true" tabindex="-1"></a>  data_epidemic <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(df_epidemic_wide)</span>
<span id="cb104-36"><a href="#cb104-36" aria-hidden="true" tabindex="-1"></a>  data_non_epidemic <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(df_non_epidemic_wide)</span>
<span id="cb104-37"><a href="#cb104-37" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb104-38"><a href="#cb104-38" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Perform FDA test</span></span>
<span id="cb104-39"><a href="#cb104-39" aria-hidden="true" tabindex="-1"></a>  itp_result <span class="ot">&lt;-</span> <span class="fu">ITP2bspline</span>(<span class="at">data1 =</span> data_epidemic, </span>
<span id="cb104-40"><a href="#cb104-40" aria-hidden="true" tabindex="-1"></a>                            <span class="at">data2 =</span> data_non_epidemic, </span>
<span id="cb104-41"><a href="#cb104-41" aria-hidden="true" tabindex="-1"></a>                            <span class="at">B =</span> B)</span>
<span id="cb104-42"><a href="#cb104-42" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb104-43"><a href="#cb104-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(itp_result)</span>
<span id="cb104-44"><a href="#cb104-44" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Applying the function to each variable.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>itp_tmin <span class="ot">&lt;-</span> <span class="fu">run_ITP_test</span>(<span class="at">data =</span> trials_weather, <span class="at">weather_var =</span> <span class="st">"T2M_MIN"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "First step: basis expansion"
Swapping 'y' and 'argvals', because 'y' is  simpler,
  and 'argvals' should be;  now  dim(argvals) =  57 ;  dim(y) =  57 x 143 
[1] "Second step: joint univariate tests"
[1] "Third step: interval-wise combination and correction"
[1] "creating the p-value matrix: end of row 2 out of 57"
[1] "creating the p-value matrix: end of row 3 out of 57"
[1] "creating the p-value matrix: end of row 4 out of 57"
[1] "creating the p-value matrix: end of row 5 out of 57"
[1] "creating the p-value matrix: end of row 6 out of 57"
[1] "creating the p-value matrix: end of row 7 out of 57"
[1] "creating the p-value matrix: end of row 8 out of 57"
[1] "creating the p-value matrix: end of row 9 out of 57"
[1] "creating the p-value matrix: end of row 10 out of 57"
[1] "creating the p-value matrix: end of row 11 out of 57"
[1] "creating the p-value matrix: end of row 12 out of 57"
[1] "creating the p-value matrix: end of row 13 out of 57"
[1] "creating the p-value matrix: end of row 14 out of 57"
[1] "creating the p-value matrix: end of row 15 out of 57"
[1] "creating the p-value matrix: end of row 16 out of 57"
[1] "creating the p-value matrix: end of row 17 out of 57"
[1] "creating the p-value matrix: end of row 18 out of 57"
[1] "creating the p-value matrix: end of row 19 out of 57"
[1] "creating the p-value matrix: end of row 20 out of 57"
[1] "creating the p-value matrix: end of row 21 out of 57"
[1] "creating the p-value matrix: end of row 22 out of 57"
[1] "creating the p-value matrix: end of row 23 out of 57"
[1] "creating the p-value matrix: end of row 24 out of 57"
[1] "creating the p-value matrix: end of row 25 out of 57"
[1] "creating the p-value matrix: end of row 26 out of 57"
[1] "creating the p-value matrix: end of row 27 out of 57"
[1] "creating the p-value matrix: end of row 28 out of 57"
[1] "creating the p-value matrix: end of row 29 out of 57"
[1] "creating the p-value matrix: end of row 30 out of 57"
[1] "creating the p-value matrix: end of row 31 out of 57"
[1] "creating the p-value matrix: end of row 32 out of 57"
[1] "creating the p-value matrix: end of row 33 out of 57"
[1] "creating the p-value matrix: end of row 34 out of 57"
[1] "creating the p-value matrix: end of row 35 out of 57"
[1] "creating the p-value matrix: end of row 36 out of 57"
[1] "creating the p-value matrix: end of row 37 out of 57"
[1] "creating the p-value matrix: end of row 38 out of 57"
[1] "creating the p-value matrix: end of row 39 out of 57"
[1] "creating the p-value matrix: end of row 40 out of 57"
[1] "creating the p-value matrix: end of row 41 out of 57"
[1] "creating the p-value matrix: end of row 42 out of 57"
[1] "creating the p-value matrix: end of row 43 out of 57"
[1] "creating the p-value matrix: end of row 44 out of 57"
[1] "creating the p-value matrix: end of row 45 out of 57"
[1] "creating the p-value matrix: end of row 46 out of 57"
[1] "creating the p-value matrix: end of row 47 out of 57"
[1] "creating the p-value matrix: end of row 48 out of 57"
[1] "creating the p-value matrix: end of row 49 out of 57"
[1] "creating the p-value matrix: end of row 50 out of 57"
[1] "creating the p-value matrix: end of row 51 out of 57"
[1] "creating the p-value matrix: end of row 52 out of 57"
[1] "creating the p-value matrix: end of row 53 out of 57"
[1] "creating the p-value matrix: end of row 54 out of 57"
[1] "creating the p-value matrix: end of row 55 out of 57"
[1] "creating the p-value matrix: end of row 56 out of 57"
[1] "creating the p-value matrix: end of row 57 out of 57"
[1] "Interval Testing Procedure completed"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>itp_tmax <span class="ot">&lt;-</span> <span class="fu">run_ITP_test</span>(<span class="at">data =</span> trials_weather, <span class="at">weather_var =</span> <span class="st">"T2M_MAX"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "First step: basis expansion"
Swapping 'y' and 'argvals', because 'y' is  simpler,
  and 'argvals' should be;  now  dim(argvals) =  57 ;  dim(y) =  57 x 143 
[1] "Second step: joint univariate tests"
[1] "Third step: interval-wise combination and correction"
[1] "creating the p-value matrix: end of row 2 out of 57"
[1] "creating the p-value matrix: end of row 3 out of 57"
[1] "creating the p-value matrix: end of row 4 out of 57"
[1] "creating the p-value matrix: end of row 5 out of 57"
[1] "creating the p-value matrix: end of row 6 out of 57"
[1] "creating the p-value matrix: end of row 7 out of 57"
[1] "creating the p-value matrix: end of row 8 out of 57"
[1] "creating the p-value matrix: end of row 9 out of 57"
[1] "creating the p-value matrix: end of row 10 out of 57"
[1] "creating the p-value matrix: end of row 11 out of 57"
[1] "creating the p-value matrix: end of row 12 out of 57"
[1] "creating the p-value matrix: end of row 13 out of 57"
[1] "creating the p-value matrix: end of row 14 out of 57"
[1] "creating the p-value matrix: end of row 15 out of 57"
[1] "creating the p-value matrix: end of row 16 out of 57"
[1] "creating the p-value matrix: end of row 17 out of 57"
[1] "creating the p-value matrix: end of row 18 out of 57"
[1] "creating the p-value matrix: end of row 19 out of 57"
[1] "creating the p-value matrix: end of row 20 out of 57"
[1] "creating the p-value matrix: end of row 21 out of 57"
[1] "creating the p-value matrix: end of row 22 out of 57"
[1] "creating the p-value matrix: end of row 23 out of 57"
[1] "creating the p-value matrix: end of row 24 out of 57"
[1] "creating the p-value matrix: end of row 25 out of 57"
[1] "creating the p-value matrix: end of row 26 out of 57"
[1] "creating the p-value matrix: end of row 27 out of 57"
[1] "creating the p-value matrix: end of row 28 out of 57"
[1] "creating the p-value matrix: end of row 29 out of 57"
[1] "creating the p-value matrix: end of row 30 out of 57"
[1] "creating the p-value matrix: end of row 31 out of 57"
[1] "creating the p-value matrix: end of row 32 out of 57"
[1] "creating the p-value matrix: end of row 33 out of 57"
[1] "creating the p-value matrix: end of row 34 out of 57"
[1] "creating the p-value matrix: end of row 35 out of 57"
[1] "creating the p-value matrix: end of row 36 out of 57"
[1] "creating the p-value matrix: end of row 37 out of 57"
[1] "creating the p-value matrix: end of row 38 out of 57"
[1] "creating the p-value matrix: end of row 39 out of 57"
[1] "creating the p-value matrix: end of row 40 out of 57"
[1] "creating the p-value matrix: end of row 41 out of 57"
[1] "creating the p-value matrix: end of row 42 out of 57"
[1] "creating the p-value matrix: end of row 43 out of 57"
[1] "creating the p-value matrix: end of row 44 out of 57"
[1] "creating the p-value matrix: end of row 45 out of 57"
[1] "creating the p-value matrix: end of row 46 out of 57"
[1] "creating the p-value matrix: end of row 47 out of 57"
[1] "creating the p-value matrix: end of row 48 out of 57"
[1] "creating the p-value matrix: end of row 49 out of 57"
[1] "creating the p-value matrix: end of row 50 out of 57"
[1] "creating the p-value matrix: end of row 51 out of 57"
[1] "creating the p-value matrix: end of row 52 out of 57"
[1] "creating the p-value matrix: end of row 53 out of 57"
[1] "creating the p-value matrix: end of row 54 out of 57"
[1] "creating the p-value matrix: end of row 55 out of 57"
[1] "creating the p-value matrix: end of row 56 out of 57"
[1] "creating the p-value matrix: end of row 57 out of 57"
[1] "Interval Testing Procedure completed"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>itp_prec <span class="ot">&lt;-</span> <span class="fu">run_ITP_test</span>(<span class="at">data =</span> trials_weather, <span class="at">weather_var =</span> <span class="st">"PRECTOTCORR"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "First step: basis expansion"
Swapping 'y' and 'argvals', because 'y' is  simpler,
  and 'argvals' should be;  now  dim(argvals) =  57 ;  dim(y) =  57 x 143 
[1] "Second step: joint univariate tests"
[1] "Third step: interval-wise combination and correction"
[1] "creating the p-value matrix: end of row 2 out of 57"
[1] "creating the p-value matrix: end of row 3 out of 57"
[1] "creating the p-value matrix: end of row 4 out of 57"
[1] "creating the p-value matrix: end of row 5 out of 57"
[1] "creating the p-value matrix: end of row 6 out of 57"
[1] "creating the p-value matrix: end of row 7 out of 57"
[1] "creating the p-value matrix: end of row 8 out of 57"
[1] "creating the p-value matrix: end of row 9 out of 57"
[1] "creating the p-value matrix: end of row 10 out of 57"
[1] "creating the p-value matrix: end of row 11 out of 57"
[1] "creating the p-value matrix: end of row 12 out of 57"
[1] "creating the p-value matrix: end of row 13 out of 57"
[1] "creating the p-value matrix: end of row 14 out of 57"
[1] "creating the p-value matrix: end of row 15 out of 57"
[1] "creating the p-value matrix: end of row 16 out of 57"
[1] "creating the p-value matrix: end of row 17 out of 57"
[1] "creating the p-value matrix: end of row 18 out of 57"
[1] "creating the p-value matrix: end of row 19 out of 57"
[1] "creating the p-value matrix: end of row 20 out of 57"
[1] "creating the p-value matrix: end of row 21 out of 57"
[1] "creating the p-value matrix: end of row 22 out of 57"
[1] "creating the p-value matrix: end of row 23 out of 57"
[1] "creating the p-value matrix: end of row 24 out of 57"
[1] "creating the p-value matrix: end of row 25 out of 57"
[1] "creating the p-value matrix: end of row 26 out of 57"
[1] "creating the p-value matrix: end of row 27 out of 57"
[1] "creating the p-value matrix: end of row 28 out of 57"
[1] "creating the p-value matrix: end of row 29 out of 57"
[1] "creating the p-value matrix: end of row 30 out of 57"
[1] "creating the p-value matrix: end of row 31 out of 57"
[1] "creating the p-value matrix: end of row 32 out of 57"
[1] "creating the p-value matrix: end of row 33 out of 57"
[1] "creating the p-value matrix: end of row 34 out of 57"
[1] "creating the p-value matrix: end of row 35 out of 57"
[1] "creating the p-value matrix: end of row 36 out of 57"
[1] "creating the p-value matrix: end of row 37 out of 57"
[1] "creating the p-value matrix: end of row 38 out of 57"
[1] "creating the p-value matrix: end of row 39 out of 57"
[1] "creating the p-value matrix: end of row 40 out of 57"
[1] "creating the p-value matrix: end of row 41 out of 57"
[1] "creating the p-value matrix: end of row 42 out of 57"
[1] "creating the p-value matrix: end of row 43 out of 57"
[1] "creating the p-value matrix: end of row 44 out of 57"
[1] "creating the p-value matrix: end of row 45 out of 57"
[1] "creating the p-value matrix: end of row 46 out of 57"
[1] "creating the p-value matrix: end of row 47 out of 57"
[1] "creating the p-value matrix: end of row 48 out of 57"
[1] "creating the p-value matrix: end of row 49 out of 57"
[1] "creating the p-value matrix: end of row 50 out of 57"
[1] "creating the p-value matrix: end of row 51 out of 57"
[1] "creating the p-value matrix: end of row 52 out of 57"
[1] "creating the p-value matrix: end of row 53 out of 57"
[1] "creating the p-value matrix: end of row 54 out of 57"
[1] "creating the p-value matrix: end of row 55 out of 57"
[1] "creating the p-value matrix: end of row 56 out of 57"
[1] "creating the p-value matrix: end of row 57 out of 57"
[1] "Interval Testing Procedure completed"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a>itp_tmin<span class="sc">$</span>corrected.pval</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 0.00 0.02 0.04 0.00 0.00 0.00 0.00 0.00 0.01 0.00 0.00 0.00 0.00 0.00 0.00
[16] 0.00 0.00 0.00 0.00 0.00 0.00 0.02 0.01 0.00 0.00 0.00 0.00 0.01 0.07 0.00
[31] 0.00 0.02 0.01 0.02 0.01 0.00 0.00 0.00 0.00 0.00 0.02 0.00 0.18 0.06 0.03
[46] 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.01 0.04 0.04 0.09</code></pre>
</div>
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="fu">which</span>(itp_tmin<span class="sc">$</span>corrected.pval <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25
[26] 26 27 28 30 31 32 33 34 35 36 37 38 39 40 41 42 45 46 47 48 49 50 51 52 53
[51] 54 55 56</code></pre>
</div>
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>itp_tmax<span class="sc">$</span>corrected.pval</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 0.05 0.05 0.08 0.22 0.09 0.09 0.08 0.09 0.13 0.56 0.28 0.18 0.22 0.38 0.47
[16] 0.59 0.52 0.52 0.63 0.36 0.18 0.24 0.20 0.30 0.56 0.57 0.37 0.18 0.13 0.11
[31] 0.11 0.15 0.16 0.16 0.18 0.20 0.22 0.53 0.32 0.32 0.28 0.23 0.30 0.42 0.41
[46] 0.30 0.52 0.79 0.91 0.61 0.58 0.58 0.46 0.33 0.00 0.05 0.07</code></pre>
</div>
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="fu">which</span>(itp_tmax<span class="sc">$</span>corrected.pval <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 55</code></pre>
</div>
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a>itp_prec<span class="sc">$</span>corrected.pval</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 0.00 0.18 0.42 0.10 0.37 0.05 0.00 0.00 0.94 0.08 0.02 0.06 0.00 0.00 0.25
[16] 0.00 0.00 0.00 0.01 0.49 0.00 0.03 0.01 0.01 0.19 0.07 0.01 0.01 0.00 0.00
[31] 0.00 0.00 0.00 0.30 0.00 0.00 0.04 0.03 0.00 0.00 0.03 0.19 0.83 0.62 0.52
[46] 0.41 0.77 0.92 0.92 0.92 0.41 0.18 0.00 0.00 0.00 0.06 0.01</code></pre>
</div>
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="fu">which</span>(itp_prec<span class="sc">$</span>corrected.pval <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1]  1  7  8 11 13 14 16 17 18 19 21 22 23 24 27 28 29 30 31 32 33 35 36 37 38
[26] 39 40 41 53 54 55 57</code></pre>
</div>
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(itp_tmin, <span class="at">main =</span> <span class="st">"TMIN"</span>, </span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">xrange =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">28</span>, <span class="dv">28</span>), </span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">'Day'</span>, <span class="at">xaxt =</span> <span class="st">'n'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="prediction-disease-modeling_files/figure-html/unnamed-chunk-55-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">28</span>, <span class="dv">28</span>, <span class="at">by =</span> <span class="dv">2</span>), </span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">labels =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">28</span>, <span class="dv">28</span>, <span class="at">by =</span> <span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="prediction-disease-modeling_files/figure-html/unnamed-chunk-55-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(itp_tmax, <span class="at">main =</span> <span class="st">"TMAX"</span>, </span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">xrange =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">28</span>, <span class="dv">28</span>), </span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">'Day'</span>, <span class="at">xaxt =</span> <span class="st">'n'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="prediction-disease-modeling_files/figure-html/unnamed-chunk-55-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">28</span>, <span class="dv">28</span>, <span class="at">by =</span> <span class="dv">2</span>), </span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">labels =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">28</span>, <span class="dv">28</span>, <span class="at">by =</span> <span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="prediction-disease-modeling_files/figure-html/unnamed-chunk-55-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(itp_prec, <span class="at">main =</span> <span class="st">"PREC"</span>, </span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">xrange =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">28</span>, <span class="dv">28</span>), </span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">'Day'</span>, <span class="at">xaxt =</span> <span class="st">'n'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="prediction-disease-modeling_files/figure-html/unnamed-chunk-55-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">28</span>, <span class="dv">28</span>, <span class="at">by =</span> <span class="dv">2</span>), </span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">labels =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">28</span>, <span class="dv">28</span>, <span class="at">by =</span> <span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="prediction-disease-modeling_files/figure-html/unnamed-chunk-55-6.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Interpretation</strong>: Based on the results above, minimum temperature and relative humidity had a significant influence across the entire range of days, particularly during the pre-heading period. Maximum temperature did not affect the epidemics at any time. Lastly, precipitation influenced wheat blast during several short intervals, with the most notable impact occurring over a longer seven-day period around the heading stage. Therefore, TMIN, RH and PREC can be tested further as candidate predictors in prediction models.</p>
</section>
</section>
</section>
<section id="model-fitting" class="level3" data-number="20.3.2">
<h3 data-number="20.3.2" class="anchored" data-anchor-id="model-fitting"><span class="header-section-number">20.3.2</span> Model fitting</h3>
<section id="logistic-regression-models" class="level4" data-number="20.3.2.1">
<h4 data-number="20.3.2.1" class="anchored" data-anchor-id="logistic-regression-models"><span class="header-section-number">20.3.2.1</span> Logistic regression models</h4>
<p>Logistic regression is a statistical modeling technique used to predict the probability of a binary outcome based on one or more predictor variables <span class="citation" data-cites="james2021">(<a href="references.html#ref-james2021" role="doc-biblioref">James et al. 2021</a>)</span>. In the context of plant disease prediction, the logistic model relates factors like environmental conditions (usually weather), host characteristics (e.g., cultivar resistance), and pathogen presence to the likelihood of disease occurrence. This occurrence can be expressed as presence or absence <span class="citation" data-cites="mila2004">(<a href="references.html#ref-mila2004" role="doc-biblioref">Mila et al. 2004</a>)</span> or as a classification of incidence/severity based on an epidemic threshold <span class="citation" data-cites="dewolf2003 decól2024">(<a href="references.html#ref-decól2024" role="doc-biblioref">De Cól et al. 2024</a>; <a href="references.html#ref-dewolf2003" role="doc-biblioref">De Wolf et al. 2003</a>)</span>. By integrating these variables, the model enables researchers to assess disease risk under varying conditions and to develop decision support systems. This modeling approach has been used successfully in several studies in the field <span class="citation" data-cites="harikrishnan2008 xu2013 romero2021 shah2013 mila2004 decól2024 willbur2018 dewolf2003">(<a href="references.html#ref-decól2024" role="doc-biblioref">De Cól et al. 2024</a>; <a href="references.html#ref-dewolf2003" role="doc-biblioref">De Wolf et al. 2003</a>; <a href="references.html#ref-harikrishnan2008" role="doc-biblioref">Harikrishnan and Río 2008</a>; <a href="references.html#ref-mila2004" role="doc-biblioref">Mila et al. 2004</a>; <a href="references.html#ref-romero2021" role="doc-biblioref">Romero et al. 2021</a>; <a href="references.html#ref-shah2013" role="doc-biblioref">Shah et al. 2013</a>; <a href="references.html#ref-willbur2018" role="doc-biblioref">Willbur et al. 2018</a>; <a href="references.html#ref-xu2013" role="doc-biblioref">Xu et al. 2013</a>)</span>, demonstrating its efficacy in predicting disease outbreaks and informing early intervention efforts.</p>
<p>The logistic model uses the logistic function to transform a linear combination of predictors into a probability between 0 and 1. This transformation ensures that the predicted values are valid probabilities, facilitating meaningful interpretations. By estimating the influence of each predictor on the odds of disease, logistic regression helps identify significant risk factors. Additionally, the model’s coefficients provide insights into the strength and direction of the association between predictors and disease risk, offering valuable information for understanding the underlying mechanisms of disease development and progression.</p>
<p>The logistic regression model predicts the probability <span class="math inline">\(P\)</span> of the binary outcome <span class="math inline">\(Y = 1 \mid X\)</span> (e.g., presence or absence of disease) given a set of predictor variables <span class="math inline">\(X\)</span>. The model uses the logistic function to ensure the predicted probabilities lie between 0 and 1:</p>
<p><span class="math inline">\(P(Y = 1 \mid X) = \frac{1}{1 + e^{-(\beta_0 + \beta_1 X_1 + \beta_2 X_2 + \dots + \beta_p X_p)}}\)</span></p>
<p>Alternatively, the model can be expressed in terms of the log-odds (also known as the logit function):</p>
<p><span class="math inline">\(\log\left( \frac{P(Y = 1 \mid X)}{1 - P(Y = 1 \mid X)} \right) = \beta_0 + \beta_1 X_1 + \beta_2 X_2 + \dots + \beta_p X_p\)</span></p>
<p>Compared to more complex machine learning models, logistic regression offers a high degree of interpretability, which is crucial in many scientific and practical applications. While models like neural networks, random forests, or support vector machines can achieve high predictive accuracy, they often function as “black boxes” where the relationship between predictors and the outcome is not easily understood <span class="citation" data-cites="molnar2019">(<a href="references.html#ref-molnar2019" role="doc-biblioref">Molnar 2019</a>)</span>. In contrast, logistic regression provides clear and direct interpretations of model parameters, allowing researchers and practitioners to understand how each predictor variable influences the probability of disease occurrence. This transparency makes logistic regression a preferred choice in contexts where explaining the underlying relationships is as important as prediction accuracy. The balance between interpretability and predictive performance justifies the choice of logistic regression in several contexts, especially when insights into the data are essential for decision-making, which is the case in plant disease prediction contexts.</p>
<p>In this section, we will keep working with the wheat blast disease data and expand on the previous sections on variable construction and selection, a usual step prior to testing the prediction variables in the logistic regression model.</p>
<section id="data-preparation" class="level5" data-number="20.3.2.1.1">
<h5 data-number="20.3.2.1.1" class="anchored" data-anchor-id="data-preparation"><span class="header-section-number">20.3.2.1.1</span> Data preparation</h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(r4pde)</span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-4"><a href="#cb129-4" aria-hidden="true" tabindex="-1"></a><span class="co"># load the disease datase</span></span>
<span id="cb129-5"><a href="#cb129-5" aria-hidden="true" tabindex="-1"></a>trials <span class="ot">&lt;-</span> r4pde<span class="sc">::</span>BlastWheat</span>
<span id="cb129-6"><a href="#cb129-6" aria-hidden="true" tabindex="-1"></a>trials<span class="sc">$</span>heading <span class="ot">=</span> <span class="fu">as.Date</span>(trials<span class="sc">$</span>heading, <span class="at">format =</span> <span class="st">"%d-%m-%Y"</span>)</span>
<span id="cb129-7"><a href="#cb129-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-8"><a href="#cb129-8" aria-hidden="true" tabindex="-1"></a><span class="co"># load the weather data </span></span>
<span id="cb129-9"><a href="#cb129-9" aria-hidden="true" tabindex="-1"></a>weather_data <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(<span class="st">"https://raw.githubusercontent.com/emdelponte/epidemiology-R/refs/heads/main/data/weather_windowpane.csv"</span>)</span>
<span id="cb129-10"><a href="#cb129-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-11"><a href="#cb129-11" aria-hidden="true" tabindex="-1"></a><span class="co"># join the two datasets</span></span>
<span id="cb129-12"><a href="#cb129-12" aria-hidden="true" tabindex="-1"></a>trials_weather <span class="ot">&lt;-</span> <span class="fu">full_join</span>(trials, weather_data)</span>
<span id="cb129-13"><a href="#cb129-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-14"><a href="#cb129-14" aria-hidden="true" tabindex="-1"></a><span class="co"># create epidemic variable and number of days relative to heading</span></span>
<span id="cb129-15"><a href="#cb129-15" aria-hidden="true" tabindex="-1"></a>trials_weather <span class="ot">&lt;-</span> trials_weather <span class="sc">|&gt;</span></span>
<span id="cb129-16"><a href="#cb129-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">epidemic =</span> <span class="fu">if_else</span>(inc_mean <span class="sc">&gt;</span> <span class="dv">20</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb129-17"><a href="#cb129-17" aria-hidden="true" tabindex="-1"></a>           <span class="at">days =</span> <span class="fu">as.numeric</span>(<span class="sc">-</span>(heading <span class="sc">-</span> YYYYMMDD)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s create a few weather-related variables based on the original variables available from the NASA POWER. First, we need to group by study and epidemic and then filter the days to only the pre-heading (28 days) since will attempt to develop a model using only pre-heading variables. We will not include mean daily maximum temperature given its weak association based on window-pane and not significant influence based on the interval test procedure of the FDA (see previous section).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a>epi_weather <span class="ot">&lt;-</span> trials_weather <span class="sc">|&gt;</span> </span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(study, epidemic) <span class="sc">|&gt;</span> </span>
<span id="cb130-3"><a href="#cb130-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(days <span class="sc">&gt;=</span> <span class="sc">-</span><span class="dv">28</span> <span class="sc">&amp;</span> days <span class="sc">&lt;=</span> <span class="dv">7</span>) <span class="sc">|&gt;</span> </span>
<span id="cb130-4"><a href="#cb130-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb130-5"><a href="#cb130-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">tmin_pre =</span> <span class="fu">mean</span>(T2M_MIN, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb130-6"><a href="#cb130-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">rh_pre =</span> <span class="fu">mean</span>(RH2M, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb130-7"><a href="#cb130-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">prec_pre =</span> <span class="fu">sum</span>(PRECTOTCORR, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))<span class="sc">|&gt;</span> </span>
<span id="cb130-8"><a href="#cb130-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span> </span>
<span id="cb130-9"><a href="#cb130-9" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span> study)</span>
<span id="cb130-10"><a href="#cb130-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-11"><a href="#cb130-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-12"><a href="#cb130-12" aria-hidden="true" tabindex="-1"></a><span class="do">## create rainfall around heading</span></span>
<span id="cb130-13"><a href="#cb130-13" aria-hidden="true" tabindex="-1"></a>epi_rain <span class="ot">&lt;-</span> trials_weather <span class="sc">|&gt;</span> </span>
<span id="cb130-14"><a href="#cb130-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(study, epidemic) <span class="sc">|&gt;</span> </span>
<span id="cb130-15"><a href="#cb130-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(days <span class="sc">&gt;=</span> <span class="sc">-</span><span class="dv">3</span> <span class="sc">&amp;</span> days <span class="sc">&lt;=</span> <span class="dv">6</span>) <span class="sc">|&gt;</span> </span>
<span id="cb130-16"><a href="#cb130-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb130-17"><a href="#cb130-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">prec_pos =</span> <span class="fu">sum</span>(PRECTOTCORR, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))<span class="sc">|&gt;</span> </span>
<span id="cb130-18"><a href="#cb130-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span> </span>
<span id="cb130-19"><a href="#cb130-19" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span> study, <span class="sc">-</span> epidemic)</span>
<span id="cb130-20"><a href="#cb130-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-21"><a href="#cb130-21" aria-hidden="true" tabindex="-1"></a>epi_weather2 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(epi_weather, epi_rain)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="model-fitting-1" class="level5" data-number="20.3.2.1.2">
<h5 data-number="20.3.2.1.2" class="anchored" data-anchor-id="model-fitting-1"><span class="header-section-number">20.3.2.1.2</span> Model fitting</h5>
<p>Now we can fit the model and look at the summary.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="co"># model fitting</span></span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a>m_logistic <span class="ot">&lt;-</span> <span class="fu">glm</span>(epidemic <span class="sc">~</span> tmin_pre <span class="sc">+</span> rh_pre <span class="sc">+</span> prec_pre, </span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">data =</span> epi_weather, </span>
<span id="cb131-4"><a href="#cb131-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">family =</span> binomial)</span>
<span id="cb131-5"><a href="#cb131-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-6"><a href="#cb131-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Model summary</span></span>
<span id="cb131-7"><a href="#cb131-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m_logistic)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = epidemic ~ tmin_pre + rh_pre + prec_pre, family = binomial, 
    data = epi_weather)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.1986  -0.5938   0.3459   0.6545   2.1343  

Coefficients:
             Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept) -20.16698    3.87801  -5.200 1.99e-07 ***
tmin_pre      0.27391    0.08610   3.181  0.00147 ** 
rh_pre        0.22020    0.04734   4.652 3.29e-06 ***
prec_pre     -0.12680    0.20907  -0.606  0.54420    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 197.06  on 142  degrees of freedom
Residual deviance: 125.11  on 139  degrees of freedom
AIC: 133.11

Number of Fisher Scoring iterations: 5</code></pre>
</div>
</div>
<p>interpretation of the coefficients:</p>
<ul>
<li><p>Intercept: Estimate of -18.96, indicating the baseline log-odds of an epidemic when all predictors are zero.</p></li>
<li><p>tmin_pre: Positive estimate (0.27, p = 0.002), indicating that higher minimum temperatures are significantly associated with an increased probability of an epidemic.</p></li>
<li><p>rh_pre: Positive estimate (0.20, p &lt; 0.001), suggesting that higher relative humidity is strongly associated with an increased probability of an epidemic.</p></li>
<li><p>prec_pre: Negative but non-significant estimate (-0.002, p = 0.70), indicating no significant relationship between precipitation and epidemic occurrence.</p></li>
</ul>
<p>Model fit</p>
<ul>
<li><p>The null deviance (197.06) reflects the fit of a model without predictors, while the residual deviance (121.55) indicates the fit of the full model with predictors. A significant reduction in deviance suggests that the predictors improve model fit.</p></li>
<li><p>The AIC (129.55) helps evaluate model performance, with lower values indicating better fit.</p></li>
</ul>
<p>Let’s fit again the model using only the two significant variables and include the prec_pos variable.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a>m_logistic <span class="ot">&lt;-</span> <span class="fu">glm</span>(epidemic <span class="sc">~</span> tmin_pre <span class="sc">+</span> rh_pre <span class="sc">+</span> prec_pos, </span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">data =</span> epi_weather2, </span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">family =</span> binomial)</span>
<span id="cb133-4"><a href="#cb133-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-5"><a href="#cb133-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m_logistic)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = epidemic ~ tmin_pre + rh_pre + prec_pos, family = binomial, 
    data = epi_weather2)

Coefficients:
             Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept) -19.31170    3.47903  -5.551 2.84e-08 ***
tmin_pre      0.34620    0.10023   3.454 0.000552 ***
rh_pre        0.18418    0.03746   4.917 8.80e-07 ***
prec_pos      0.06393    0.02222   2.878 0.004003 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 197.06  on 142  degrees of freedom
Residual deviance: 109.99  on 139  degrees of freedom
AIC: 117.99

Number of Fisher Scoring iterations: 6</code></pre>
</div>
</div>
<p>We can notice that including rainfall accumulation around flowering, the AIC is reduced to 117.99, suggesting that its inclusion improved prediction.</p>
<p>We can check the accuracy of the new model in predicting the training data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)</span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-3"><a href="#cb135-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Obtain the predicted probability</span></span>
<span id="cb135-4"><a href="#cb135-4" aria-hidden="true" tabindex="-1"></a>pred_probs <span class="ot">&lt;-</span> <span class="fu">predict</span>(m_logistic, epi_weather2, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb135-5"><a href="#cb135-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-6"><a href="#cb135-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert probabilities to binary outcomes using 0.5 as the threshold</span></span>
<span id="cb135-7"><a href="#cb135-7" aria-hidden="true" tabindex="-1"></a>pred_classes <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(pred_probs <span class="sc">&gt;=</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb135-8"><a href="#cb135-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-9"><a href="#cb135-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate accuracy</span></span>
<span id="cb135-10"><a href="#cb135-10" aria-hidden="true" tabindex="-1"></a>actual_classes <span class="ot">&lt;-</span> epi_weather<span class="sc">$</span>epidemic</span>
<span id="cb135-11"><a href="#cb135-11" aria-hidden="true" tabindex="-1"></a>accuracy <span class="ot">&lt;-</span> <span class="fu">mean</span>(pred_classes <span class="sc">==</span> actual_classes)</span>
<span id="cb135-12"><a href="#cb135-12" aria-hidden="true" tabindex="-1"></a>accuracy</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8181818</code></pre>
</div>
</div>
<p>The <code>confusionMatrix()</code> function of the {caret} package gives a more complete information about the perfomrance of the model on the training set.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create the confusion matrix</span></span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(<span class="at">data =</span> <span class="fu">as.factor</span>(<span class="fu">as.numeric</span>(pred_probs <span class="sc">&gt;</span> <span class="fl">0.50</span>)),  <span class="at">mode=</span> <span class="st">"everything"</span>,  <span class="at">reference =</span> <span class="fu">as.factor</span>(epi_weather<span class="sc">$</span>epidemic))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction  0  1
         0 49 10
         1 16 68
                                          
               Accuracy : 0.8182          
                 95% CI : (0.7451, 0.8777)
    No Information Rate : 0.5455          
    P-Value [Acc &gt; NIR] : 6.459e-12       
                                          
                  Kappa : 0.6305          
                                          
 Mcnemar's Test P-Value : 0.3268          
                                          
            Sensitivity : 0.7538          
            Specificity : 0.8718          
         Pos Pred Value : 0.8305          
         Neg Pred Value : 0.8095          
              Precision : 0.8305          
                 Recall : 0.7538          
                     F1 : 0.7903          
             Prevalence : 0.4545          
         Detection Rate : 0.3427          
   Detection Prevalence : 0.4126          
      Balanced Accuracy : 0.8128          
                                          
       'Positive' Class : 0               
                                          </code></pre>
</div>
</div>
</section>
<section id="model-evaluation" class="level5" data-number="20.3.2.1.3">
<h5 data-number="20.3.2.1.3" class="anchored" data-anchor-id="model-evaluation"><span class="header-section-number">20.3.2.1.3</span> Model evaluation</h5>
<p>It is highly desirable to evaluate model performance metrics using data that was not “seen” by the model during training. If the dataset is sufficiently large (e.g., more than 300 observations), it can be split into training and test sets, typically using an 80:20 ratio. For smaller datasets, alternatives like leave-one-out cross-validation (LOOCV) can be applied, as was done in the original wheat blast model study, which had 143 cases available <span class="citation" data-cites="decól2024">(<a href="references.html#ref-decól2024" role="doc-biblioref">De Cól et al. 2024</a>)</span>.</p>
<p>The Leave-One-Out Cross-Validation (LOOCV) is a resampling method used to evaluate model performance, particularly with small datasets. In LOOCV, the model is trained repeatedly, each time using all but one observation, which is set aside for testing. This process is repeated until every observation has served as the test case once. The overall performance metric is calculated by averaging the results from all iterations, providing an unbiased estimate of model accuracy <span class="citation" data-cites="hastie2009">(<a href="references.html#ref-hastie2009" role="doc-biblioref">Hastie et al. 2009</a>)</span>.</p>
<p>Let’s first create the training and test data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a>train_index <span class="ot">&lt;-</span> <span class="fu">createDataPartition</span>(epi_weather2<span class="sc">$</span>epidemic, <span class="at">p =</span> <span class="fl">0.8</span>, <span class="at">list =</span> <span class="cn">FALSE</span>)</span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a>train_data <span class="ot">&lt;-</span> epi_weather2[train_index, ]</span>
<span id="cb139-3"><a href="#cb139-3" aria-hidden="true" tabindex="-1"></a>test_data <span class="ot">&lt;-</span> epi_weather2[<span class="sc">-</span>train_index, ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now we fit the logistic model on the training data and obtain the predictions.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fit the model on training data</span></span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a>m_logistic2 <span class="ot">&lt;-</span> <span class="fu">glm</span>(epidemic <span class="sc">~</span> tmin_pre <span class="sc">+</span> rh_pre <span class="sc">+</span> prec_pos, </span>
<span id="cb140-3"><a href="#cb140-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> train_data, </span>
<span id="cb140-4"><a href="#cb140-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">family =</span> binomial)</span>
<span id="cb140-5"><a href="#cb140-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-6"><a href="#cb140-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Predict on the test data</span></span>
<span id="cb140-7"><a href="#cb140-7" aria-hidden="true" tabindex="-1"></a>pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(m_logistic2, <span class="at">newdata =</span> test_data, <span class="at">type =</span> <span class="st">"response"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s build now the confusion matrix for the test data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a>confusion_matrix <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(<span class="at">data =</span> <span class="fu">as.factor</span>(<span class="fu">as.numeric</span>(pred <span class="sc">&gt;</span> <span class="fl">0.5</span>)), <span class="at">reference =</span> <span class="fu">as.factor</span>(test_data<span class="sc">$</span>epidemic), <span class="at">mode =</span> <span class="st">"everything"</span>)</span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(confusion_matrix)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction  0  1
         0 10  0
         1  6 12
                                         
               Accuracy : 0.7857         
                 95% CI : (0.5905, 0.917)
    No Information Rate : 0.5714         
    P-Value [Acc &gt; NIR] : 0.01543        
                                         
                  Kappa : 0.5882         
                                         
 Mcnemar's Test P-Value : 0.04123        
                                         
            Sensitivity : 0.6250         
            Specificity : 1.0000         
         Pos Pred Value : 1.0000         
         Neg Pred Value : 0.6667         
              Precision : 1.0000         
                 Recall : 0.6250         
                     F1 : 0.7692         
             Prevalence : 0.5714         
         Detection Rate : 0.3571         
   Detection Prevalence : 0.3571         
      Balanced Accuracy : 0.8125         
                                         
       'Positive' Class : 0              
                                         </code></pre>
</div>
</div>
<p>The code below provides a comparative evaluation of model accuracy using two different cross-validation techniques, the LOOCV and 10-fold cross validation. The latter is similar to the LOOCV code, but with the addition of <code>K = 10</code>, which specifies 10-fold cross-validation. Here, the dataset is divided into 10 subsets (folds), with the model trained on 9 folds and tested on the remaining fold. This process repeats for all 10 folds, averaging the results. For both we need a custom cost function that evaluates the performance of a binary classifier. Note that we will use the model 1 built with all observations, not the training data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-3"><a href="#cb143-3" aria-hidden="true" tabindex="-1"></a>cost <span class="ot">&lt;-</span> <span class="cf">function</span>(r, <span class="at">pi =</span> <span class="dv">0</span>) <span class="fu">mean</span>(<span class="fu">abs</span>(r <span class="sc">-</span> pi) <span class="sc">&gt;</span> <span class="fl">0.5</span>)</span>
<span id="cb143-4"><a href="#cb143-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-5"><a href="#cb143-5" aria-hidden="true" tabindex="-1"></a><span class="co"># LOOCV (accuracy)</span></span>
<span id="cb143-6"><a href="#cb143-6" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="sc">-</span> <span class="fu">cv.glm</span>(epi_weather2, m_logistic, <span class="at">cost =</span> cost)<span class="sc">$</span>delta[<span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8041958</code></pre>
</div>
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="co"># K-fold CV K=10 (accuracy)</span></span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="sc">-</span> <span class="fu">cv.glm</span>(epi_weather2, m_logistic, <span class="at">K =</span> <span class="dv">10</span>, <span class="at">cost =</span> cost)<span class="sc">$</span>delta[<span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8041958</code></pre>
</div>
</div>
<p>We can conclude that using two variables from relatively long periods before heading, and the precipitation accumulation variable around heading (all defined based on FDA analysis) the model can reasonably predict wheat blast. We can further explore the effect of other variables from the post-heading period, as well as variables from shorter intervals around heading and flowering—periods when infections are likely to occur.</p>
<p>Variable selection is a critical process that combines statistical techniques with biological knowledge to identify the most relevant predictors for a given model. Approaches can range from simple methods, like selecting the most correlated variables at periods of time know as most critical for infection or epidemic development <span class="citation" data-cites="dewolf2003">(<a href="references.html#ref-dewolf2003" role="doc-biblioref">De Wolf et al. 2003</a>)</span>, to more advanced algorithms designed to optimize predictive power, such as regularization techniques like lasso or elastic-net <span class="citation" data-cites="decól2024 dallalana2021a dewolf2023">(<a href="references.html#ref-dallalana2021a" role="doc-biblioref">Dalla Lana et al. 2021a</a>; <a href="references.html#ref-decól2024" role="doc-biblioref">De Cól et al. 2024</a>; <a href="references.html#ref-dewolf2023" role="doc-biblioref">De Wolf et al. 2023</a>)</span>.</p>
<p>Regularization methods not only help in selecting significant predictors but also in handling multicollinearity and reducing model complexity <span class="citation" data-cites="hastie2009">(<a href="references.html#ref-hastie2009" role="doc-biblioref">Hastie et al. 2009</a>)</span>. These methods will be demonstrated further in the following sections, where Lasso and similar techniques are discussed in detail.</p>


<div id="refs" class="references csl-bib-body" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-alves2022a" class="csl-entry" role="listitem">
Alves, K. S., Shah, D. A., Dillard, H. R., Del Ponte, E. M., and Pethybridge, S. J. 2022. <a href="http://dx.doi.org/10.31219/osf.io/9tgau">From reanalysis data to inference: A framework for linking environment to plant disease epidemics at the regional scale</a>.
</div>
<div id="ref-analytis1977" class="csl-entry" role="listitem">
Analytis, S. 1977. Über die Relation zwischen biologischer Entwicklung und Temperatur bei phytopathogenen Pilzen. Journal of Phytopathology 90:64–76. <a href="https://doi.org/10.1111/j.1439-0434.1977.tb02886.x">https://doi.org/10.1111/j.1439-0434.1977.tb02886.x</a>.
</div>
<div id="ref-bailey1999" class="csl-entry" role="listitem">
Bailey, J. E. 1999. Integrated Method of Organizing, Computing, and Deploying Weather-Based Disease Advisories for Selected Peanut Disease. Peanut Science 26:74–80. <a href="https://doi.org/10.3146/i0095-3679-26-2-3">https://doi.org/10.3146/i0095-3679-26-2-3</a>.
</div>
<div id="ref-bernard2013" class="csl-entry" role="listitem">
Bernard, F., Sache, I., Suffert, F., and Chelle, M. 2013. The development of a foliar fungal pathogen does react to leaf temperature! New Phytologist 198:232–240. <a href="https://doi.org/10.1111/nph.12134">https://doi.org/10.1111/nph.12134</a>.
</div>
<div id="ref-bulger1987" class="csl-entry" role="listitem">
Bulger, M. A. 1987. Influence of temperature and wetness duration on infection of strawberry flowers by<span><em>Botrytis cinerea</em></span>and disease incidence of fruit originating from infected flowers. Phytopathology 77:1225. <a href="https://doi.org/10.1094/phyto-77-1225">https://doi.org/10.1094/phyto-77-1225</a>.
</div>
<div id="ref-calverojr1996" class="csl-entry" role="listitem">
Calvero Jr, S. B., Coakley, S. M., and Teng, P. S. 1996. Development of empirical forecasting models for rice blast based on weather factors. Plant Pathology 45:667–678. <a href="https://doi.org/10.1046/j.1365-3059.1996.d01-168.x">https://doi.org/10.1046/j.1365-3059.1996.d01-168.x</a>.
</div>
<div id="ref-cao2015" class="csl-entry" role="listitem">
Cao, X., Yao, D., Xu, X., Zhou, Y., Ding, K., Duan, X., Fan, J., and Luo, Y. 2015. Development of Weather- and Airborne Inoculum-Based Models to Describe Disease Severity of Wheat Powdery Mildew. Plant Disease 99:395–400. <a href="https://doi.org/10.1094/pdis-02-14-0201-re">https://doi.org/10.1094/pdis-02-14-0201-re</a>.
</div>
<div id="ref-coakley1985" class="csl-entry" role="listitem">
Coakley, S. M. 1985. Model for predicting severity of septoria tritici blotch on winter wheat. Phytopathology 75:1245. <a href="https://doi.org/10.1094/phyto-75-1245">https://doi.org/10.1094/phyto-75-1245</a>.
</div>
<div id="ref-coakley1988a" class="csl-entry" role="listitem">
Coakley, S. M. 1988. Predicting stripe rust severity on winter wheat using an improved method for analyzing meteorological and rust data. Phytopathology 78:543. <a href="https://doi.org/10.1094/phyto-78-543">https://doi.org/10.1094/phyto-78-543</a>.
</div>
<div id="ref-coakley1988" class="csl-entry" role="listitem">
Coakley, S. M., McDaniel, L. R., and Line, R. F. 1988. Quantifying how climatic factors affect variation in plant disease severity: A general method using a new way to analyze meteorological data. Climatic Change 12:57–75. <a href="https://doi.org/10.1007/bf00140264">https://doi.org/10.1007/bf00140264</a>.
</div>
<div id="ref-dallalana2021a" class="csl-entry" role="listitem">
Dalla Lana, F., Madden, L. V., and Paul, P. A. 2021a. Logistic Models Derived via LASSO Methods for Quantifying the Risk of Natural Contamination of Maize Grain with Deoxynivalenol. Phytopathology® 111:2250–2267. <a href="https://doi.org/10.1094/phyto-03-21-0104-r">https://doi.org/10.1094/phyto-03-21-0104-r</a>.
</div>
<div id="ref-dallalana2021" class="csl-entry" role="listitem">
Dalla Lana, F., Madden, L. V., and Paul, P. A. 2021b. Natural Occurrence of Maize Gibberella Ear Rot and Contamination of Grain with Mycotoxins in Association with Weather Variables. Plant Disease 105:114–126. <a href="https://doi.org/10.1094/pdis-05-20-0952-re">https://doi.org/10.1094/pdis-05-20-0952-re</a>.
</div>
<div id="ref-dallapria2006" class="csl-entry" role="listitem">
Dalla Pria, M., Christiano, R. C. S., Furtado, E. L., Amorim, L., and Bergamin Filho, A. 2006. Effect of temperature and leaf wetness duration on infection of sweet oranges by Asiatic citrus canker. Plant Pathology 55:657–663. <a href="https://doi.org/10.1111/j.1365-3059.2006.01393.x">https://doi.org/10.1111/j.1365-3059.2006.01393.x</a>.
</div>
<div id="ref-decól2024" class="csl-entry" role="listitem">
De Cól, M., Coelho, M., and Del Ponte, E. M. 2024. Weather-Based Logistic Regression Models for Predicting Wheat Head Blast Epidemics. Plant Disease 108:2206–2213. <a href="https://doi.org/10.1094/pdis-11-23-2513-re">https://doi.org/10.1094/pdis-11-23-2513-re</a>.
</div>
<div id="ref-dewolf2023" class="csl-entry" role="listitem">
De Wolf, E. D., Andersen Onofre, K. F., and Lollato, R. P. 2023. Early Season Environmental Indicators of Wheat Stripe Rust Epidemics in Kansas and the Central Great Plains Region of the United States. Plant Disease 107:2119–2125. <a href="https://doi.org/10.1094/pdis-08-22-1873-re">https://doi.org/10.1094/pdis-08-22-1873-re</a>.
</div>
<div id="ref-dewolf2007" class="csl-entry" role="listitem">
De Wolf, E. D., and Isard, S. A. 2007. Disease Cycle Approach to Plant Disease Prediction. Annual Review of Phytopathology 45:203–220. <a href="https://doi.org/10.1146/annurev.phyto.44.070505.143329">https://doi.org/10.1146/annurev.phyto.44.070505.143329</a>.
</div>
<div id="ref-dewolf2003" class="csl-entry" role="listitem">
De Wolf, E. D., Madden, L. V., and Lipps, P. E. 2003. Risk Assessment Models for Wheat Fusarium Head Blight Epidemics Based on Within-Season Weather Data. Phytopathology® 93:428–435. <a href="https://doi.org/10.1094/phyto.2003.93.4.428">https://doi.org/10.1094/phyto.2003.93.4.428</a>.
</div>
<div id="ref-delponte2006" class="csl-entry" role="listitem">
Del Ponte, E. M., Godoy, C. V., Li, X., and Yang, X. B. 2006. Predicting Severity of Asian Soybean Rust Epidemics with Empirical Rainfall Models. Phytopathology® 96:797–803. <a href="https://doi.org/10.1094/phyto-96-0797">https://doi.org/10.1094/phyto-96-0797</a>.
</div>
<div id="ref-duthie1997" class="csl-entry" role="listitem">
Duthie, J. A. 1997. Models of the Response of Foliar Parasites to the Combined Effects of Temperature and Duration of Wetness. Phytopathology® 87:1088–1095. <a href="https://doi.org/10.1094/phyto.1997.87.11.1088">https://doi.org/10.1094/phyto.1997.87.11.1088</a>.
</div>
<div id="ref-eljarroudi2017" class="csl-entry" role="listitem">
El Jarroudi, M., Kouadio, L., Bock, C. H., El Jarroudi, M., Junk, J., Pasquali, M., Maraite, H., and Delfosse, P. 2017. A Threshold-Based Weather Model for Predicting Stripe Rust Infection in Winter Wheat. Plant Disease 101:693–703. <a href="https://doi.org/10.1094/pdis-12-16-1766-re">https://doi.org/10.1094/pdis-12-16-1766-re</a>.
</div>
<div id="ref-evans1992" class="csl-entry" role="listitem">
Evans, K. J. 1992. A model based on temperature and leaf wetness duration for establishment of alternaria leaf blight of muskmelon. Phytopathology 82:890. <a href="https://doi.org/10.1094/phyto-82-890">https://doi.org/10.1094/phyto-82-890</a>.
</div>
<div id="ref-fedele2022a" class="csl-entry" role="listitem">
Fedele, G., Brischetto, C., Rossi, V., and Gonzalez-Dominguez, E. 2022. A Systematic Map of the Research on Disease Modelling for Agricultural Crops Worldwide. Plants 11:724. <a href="https://doi.org/10.3390/plants11060724">https://doi.org/10.3390/plants11060724</a>.
</div>
<div id="ref-Gertheiss2024" class="csl-entry" role="listitem">
Gertheiss, J., Rügamer, D., Liew, B. X. W., and Greven, S. 2024. Functional Data Analysis: An Introduction and Recent Developments. Biometrical Journal 66. <a href="https://doi.org/10.1002/bimj.202300363">https://doi.org/10.1002/bimj.202300363</a>.
</div>
<div id="ref-gonzález-domínguez2023" class="csl-entry" role="listitem">
González-Domínguez, E., Caffi, T., Rossi, V., Salotti, I., and Fedele, G. 2023. Plant Disease Models and Forecasting: Changes in Principles and Applications over the Last 50 Years. Phytopathology® 113:678–693. <a href="https://doi.org/10.1094/phyto-10-22-0362-kd">https://doi.org/10.1094/phyto-10-22-0362-kd</a>.
</div>
<div id="ref-gouache2015a" class="csl-entry" role="listitem">
Gouache, D., Léon, M. S., Duyme, F., and Braun, P. 2015. A novel solution to the variable selection problem in Window Pane approaches of plant pathogen <span></span> Climate models: Development, evaluation and application of a climatological model for brown rust of wheat. Agricultural and Forest Meteorology 205:51–59. <a href="https://doi.org/10.1016/j.agrformet.2015.02.013">https://doi.org/10.1016/j.agrformet.2015.02.013</a>.
</div>
<div id="ref-harikrishnan2008" class="csl-entry" role="listitem">
Harikrishnan, R., and Río, L. E. del. 2008. A Logistic Regression Model for Predicting Risk of White Mold Incidence on Dry Bean in North Dakota. Plant Disease 92:42–46. <a href="https://doi.org/10.1094/pdis-92-1-0042">https://doi.org/10.1094/pdis-92-1-0042</a>.
</div>
<div id="ref-hastie2009" class="csl-entry" role="listitem">
Hastie, T., Tibshirani, R., and Friedman, J. 2009. <em>The elements of statistical learning</em>. Springer New York. <a href="https://doi.org/10.1007/978-0-387-84858-7">https://doi.org/10.1007/978-0-387-84858-7</a>.
</div>
<div id="ref-hau1990" class="csl-entry" role="listitem">
Hau, B., and Kranz, J. 1990. Mathematics and statistics for analyses in epidemiology. In Springer Berlin Heidelberg, pp. 12–52. <a href="https://doi.org/10.1007/978-3-642-75398-5_2">https://doi.org/10.1007/978-3-642-75398-5_2</a>.
</div>
<div id="ref-hjelkrem2021a" class="csl-entry" role="listitem">
Hjelkrem, A.-G. R., Aamot, H. U., Lillemo, M., Sørensen, E. S., Brodal, G., Russenes, A. L., Edwards, S. G., and Hofgaard, I. S. 2021. Weather Patterns Associated with DON Levels in Norwegian Spring Oat Grain: A Functional Data Approach. Plants 11:73. <a href="https://doi.org/10.3390/plants11010073">https://doi.org/10.3390/plants11010073</a>.
</div>
<div id="ref-james2021" class="csl-entry" role="listitem">
James, G., Witten, D., Hastie, T., and Tibshirani, R. 2021. <em>An introduction to statistical learning with applications in r</em>. 2nd ed. New York: Springer.
</div>
<div id="ref-ji2021" class="csl-entry" role="listitem">
Ji, T., Languasco, L., Li, M., and Rossi, V. 2021. Effects of Temperature and Wetness Duration on Infection by Coniella diplodiella, the Fungus Causing White Rot of Grape Berries. Plants 10:1696. <a href="https://doi.org/10.3390/plants10081696">https://doi.org/10.3390/plants10081696</a>.
</div>
<div id="ref-ji2023a" class="csl-entry" role="listitem">
Ji, T., Salotti, I., Altieri, V., Li, M., and Rossi, V. 2023. Temperature-Dependent Growth and Spore Germination of Fungi Causing Grapevine Trunk Diseases: Quantitative Analysis of Literature Data. Plant Disease 107:1386–1398. <a href="https://doi.org/10.1094/pdis-09-22-2249-re">https://doi.org/10.1094/pdis-09-22-2249-re</a>.
</div>
<div id="ref-krause1975" class="csl-entry" role="listitem">
Krause, R. A., and Massie, L. B. 1975. Predictive Systems: Modern Approaches to Disease Control. Annual Review of Phytopathology 13:31–47. <a href="https://doi.org/10.1146/annurev.py.13.090175.000335">https://doi.org/10.1146/annurev.py.13.090175.000335</a>.
</div>
<div id="ref-kriss2010" class="csl-entry" role="listitem">
Kriss, A. B., Paul, P. A., and Madden, L. V. 2010. Relationship Between Yearly Fluctuations in Fusarium Head Blight Intensity and Environmental Variables: A Window-Pane Analysis. Phytopathology® 100:784–797. <a href="https://doi.org/10.1094/phyto-100-8-0784">https://doi.org/10.1094/phyto-100-8-0784</a>.
</div>
<div id="ref-lannou2012" class="csl-entry" role="listitem">
Lannou, C. 2012. Variation and Selection of Quantitative Traits in Plant Pathogens. Annual Review of Phytopathology 50:319–338. <a href="https://doi.org/10.1146/annurev-phyto-081211-173031">https://doi.org/10.1146/annurev-phyto-081211-173031</a>.
</div>
<div id="ref-machardy1989" class="csl-entry" role="listitem">
MacHardy, W. E. 1989. A revision of mills’s criteria for predicting apple scab infection periods. Phytopathology 79:304. <a href="https://doi.org/10.1094/phyto-79-304">https://doi.org/10.1094/phyto-79-304</a>.
</div>
<div id="ref-madden2007" class="csl-entry" role="listitem">
Madden, L. V., Hughes, G., and van den Bosch, F. 2007. <em>The study of plant disease epidemics</em>. The American Phytopathological Society. <a href="https://doi.org/10.1094/9780890545058">https://doi.org/10.1094/9780890545058</a>.
</div>
<div id="ref-magarey2007" class="csl-entry" role="listitem">
Magarey, R. D., and Sutton, T. B. 2007. How to Create and Deploy Infection Models for Plant Pathogens. In Springer Netherlands, pp. 3–25. <a href="https://doi.org/10.1007/978-1-4020-6061-8_1">https://doi.org/10.1007/978-1-4020-6061-8_1</a>.
</div>
<div id="ref-magarey2005" class="csl-entry" role="listitem">
Magarey, R. D., Sutton, T. B., and Thayer, C. L. 2005. A Simple Generic Infection Model for Foliar Fungal Plant Pathogens. Phytopathology® 95:92–100. <a href="https://doi.org/10.1094/phyto-95-0092">https://doi.org/10.1094/phyto-95-0092</a>.
</div>
<div id="ref-magarey2002" class="csl-entry" role="listitem">
Magarey, R. D., Travis, J. W., Russo, J. M., Seem, R. C., and Magarey, P. A. 2002. Decision Support Systems: Quenching the Thirst. Plant Disease 86:4–14. <a href="https://doi.org/10.1094/pdis.2002.86.1.4">https://doi.org/10.1094/pdis.2002.86.1.4</a>.
</div>
<div id="ref-mehra2016" class="csl-entry" role="listitem">
Mehra, L. K., Cowger, C., Gross, K., and Ojiambo, P. S. 2016. Predicting pre-planting risk of stagonospora nodorum blotch in winter wheat using machine learning models. Frontiers in Plant Science 7. <a href="https://doi.org/10.3389/fpls.2016.00390">https://doi.org/10.3389/fpls.2016.00390</a>.
</div>
<div id="ref-mehra2017" class="csl-entry" role="listitem">
Mehra, L. K., Cowger, C., and Ojiambo, P. S. 2017. A Model for Predicting Onset of Stagonospora nodorum Blotch in Winter Wheat Based on Preplanting and Weather Factors. Phytopathology® 107:635–644. <a href="https://doi.org/10.1094/phyto-03-16-0133-r">https://doi.org/10.1094/phyto-03-16-0133-r</a>.
</div>
<div id="ref-mila2004" class="csl-entry" role="listitem">
Mila, A. L., Carriquiry, A. L., and Yang, X. B. 2004. Logistic Regression Modeling of Prevalence of Soybean Sclerotinia Stem Rot in the North-Central Region of the United States. Phytopathology® 94:102–110. <a href="https://doi.org/10.1094/phyto.2004.94.1.102">https://doi.org/10.1094/phyto.2004.94.1.102</a>.
</div>
<div id="ref-mills1944" class="csl-entry" role="listitem">
Mills, W. D. 1944. Efficient use of sulfur dusts and sprays during rain to control apple scab. Cornell Extension Bulletin 630.
</div>
<div id="ref-molnar2019" class="csl-entry" role="listitem">
Molnar, C. 2019. <em>Interpretable machine learning</em>. Leanpub.
</div>
<div id="ref-paul2004" class="csl-entry" role="listitem">
Paul, P. A., and Munkvold, G. P. 2004. A Model-Based Approach to Preplanting Risk Assessment for Gray Leaf Spot of Maize. Phytopathology® 94:1350–1357. <a href="https://doi.org/10.1094/phyto.2004.94.12.1350">https://doi.org/10.1094/phyto.2004.94.12.1350</a>.
</div>
<div id="ref-pfender2003" class="csl-entry" role="listitem">
Pfender, W. F. 2003. Prediction of Stem Rust Infection Favorability, by Means of Degree-Hour Wetness Duration, for Perennial Ryegrass Seed Crops. Phytopathology® 93:467–477. <a href="https://doi.org/10.1094/phyto.2003.93.4.467">https://doi.org/10.1094/phyto.2003.93.4.467</a>.
</div>
<div id="ref-pietravalle2003" class="csl-entry" role="listitem">
Pietravalle, S., Shaw, M. W., Parker, S. R., and Bosch, F. van den. 2003. Modeling of Relationships Between Weather and <span><em>Septoria tritici</em></span> Epidemics on Winter Wheat: A Critical Approach. Phytopathology® 93:1329–1339. <a href="https://doi.org/10.1094/phyto.2003.93.10.1329">https://doi.org/10.1094/phyto.2003.93.10.1329</a>.
</div>
<div id="ref-pini2016" class="csl-entry" role="listitem">
Pini, A., and Vantini, S. 2016. The Interval Testing Procedure: A General Framework for Inference in Functional Data Analysis. Biometrics 72:835–845. <a href="https://doi.org/10.1111/biom.12476">https://doi.org/10.1111/biom.12476</a>.
</div>
<div id="ref-ramsay2005functional" class="csl-entry" role="listitem">
Ramsay, J. O., and Silverman, B. W. 2005. <em>Functional data analysis</em>. 2nd ed. New York: Springer.
</div>
<div id="ref-romero2021" class="csl-entry" role="listitem">
Romero, J., Moral, J., Gonzalez-Dominguez, E., Agustí-Brisach, C., Roca, L. F., Rossi, V., and Trapero, A. 2021. Logistic models to predict olive anthracnose under field conditions. Crop Protection 148:105714. <a href="https://doi.org/10.1016/j.cropro.2021.105714">https://doi.org/10.1016/j.cropro.2021.105714</a>.
</div>
<div id="ref-rossi2008" class="csl-entry" role="listitem">
Rossi, V., Caffi, T., Giosuè, S., and Bugiani, R. 2008. A mechanistic model simulating primary infections of downy mildew in grapevine. Ecological Modelling 212:480–491. <a href="https://doi.org/10.1016/j.ecolmodel.2007.10.046">https://doi.org/10.1016/j.ecolmodel.2007.10.046</a>.
</div>
<div id="ref-rossi2010a" class="csl-entry" role="listitem">
Rossi, V., Giosuè, S., and Caffi, T. 2010. Modelling Plant Diseases for Decision Making in Crop Protection. In Springer Netherlands, pp. 241–258. <a href="https://doi.org/10.1007/978-90-481-9277-9_15">https://doi.org/10.1007/978-90-481-9277-9_15</a>.
</div>
<div id="ref-rossi2014" class="csl-entry" role="listitem">
Rossi, V., Onesti, G., Legler, S. E., and Caffi, T. 2014. Use of systems analysis to develop plant disease models based on literature data: grape black-rot as a case-study. European Journal of Plant Pathology 141:427–444. <a href="https://doi.org/10.1007/s10658-014-0553-z">https://doi.org/10.1007/s10658-014-0553-z</a>.
</div>
<div id="ref-rotem1988" class="csl-entry" role="listitem">
Rotem, J. 1988. Techniques of Controlled-Condition Experiments. In Springer Berlin Heidelberg, pp. 19–31. <a href="https://doi.org/10.1007/978-3-642-95534-1_3">https://doi.org/10.1007/978-3-642-95534-1_3</a>.
</div>
<div id="ref-salotti2022" class="csl-entry" role="listitem">
Salotti, I., Bove, F., and Rossi, V. 2022. Development and validation of a mechanistic, weather-based model for predicting puccinia graminis f. Sp. Tritici infections and stem rust progress in wheat. Frontiers in Plant Science 13. <a href="https://doi.org/10.3389/fpls.2022.897680">https://doi.org/10.3389/fpls.2022.897680</a>.
</div>
<div id="ref-salotti2023" class="csl-entry" role="listitem">
Salotti, I., and Rossi, V. 2023. A Mechanistic Model Accounting for the Effect of Soil Moisture, Weather, and Host Growth Stage on the Development of <span><em>Sclerotinia sclerotiorum</em></span>. Plant Disease 107:514–533. <a href="https://doi.org/10.1094/pdis-12-21-2743-re">https://doi.org/10.1094/pdis-12-21-2743-re</a>.
</div>
<div id="ref-savary2018" class="csl-entry" role="listitem">
Savary, S., Nelson, A. D., Djurle, A., Esker, P. D., Sparks, A., Amorim, L., Bergamin Filho, A., Caffi, T., Castilla, N., Garrett, K., McRoberts, N., Rossi, V., Yuen, J., and Willocquet, L. 2018. Concepts, approaches, and avenues for modelling crop health and crop losses. European Journal of Agronomy 100:4–18. <a href="https://doi.org/10.1016/j.eja.2018.04.003">https://doi.org/10.1016/j.eja.2018.04.003</a>.
</div>
<div id="ref-seem1984" class="csl-entry" role="listitem">
Seem, R. C. 1984. Simple decision aids for practical control of pests. Plant Disease 68:656. <a href="https://doi.org/10.1094/pd-69-656">https://doi.org/10.1094/pd-69-656</a>.
</div>
<div id="ref-shah2019a" class="csl-entry" role="listitem">
Shah, D. A., De Wolf, E. D., Paul, P. A., and Madden, L. V. 2019a. Functional Data Analysis of Weather Variables Linked to Fusarium Head Blight Epidemics in the United States. Phytopathology® 109:96–110. <a href="https://doi.org/10.1094/phyto-11-17-0386-r">https://doi.org/10.1094/phyto-11-17-0386-r</a>.
</div>
<div id="ref-shah2013" class="csl-entry" role="listitem">
Shah, D. A., Molineros, J. E., Paul, P. A., Willyerd, K. T., Madden, L. V., and De Wolf, E. D. 2013. Predicting Fusarium Head Blight Epidemics With Weather-Driven Pre- and Post-Anthesis Logistic Regression Models. Phytopathology® 103:906–919. <a href="https://doi.org/10.1094/phyto-11-12-0304-r">https://doi.org/10.1094/phyto-11-12-0304-r</a>.
</div>
<div id="ref-shah2019" class="csl-entry" role="listitem">
Shah, D. A., Paul, P. A., De Wolf, E. D., and Madden, L. V. 2019b. Predicting plant disease epidemics from functionally represented weather series. Philosophical Transactions of the Royal Society B: Biological Sciences 374:20180273. <a href="https://doi.org/10.1098/rstb.2018.0273">https://doi.org/10.1098/rstb.2018.0273</a>.
</div>
<div id="ref-tebeest2008a" class="csl-entry" role="listitem">
Te Beest, D. E., Paveley, N. D., Shaw, M. W., and Bosch, F. van den. 2008. Disease<span></span>Weather Relationships for Powdery Mildew and Yellow Rust on Winter Wheat. Phytopathology® 98:609–617. <a href="https://doi.org/10.1094/phyto-98-5-0609">https://doi.org/10.1094/phyto-98-5-0609</a>.
</div>
<div id="ref-plantdi1963" class="csl-entry" role="listitem">
Vanderplank, J. 1963. <em>Plant disease epidemics and control</em>. Elsevier. <a href="https://doi.org/10.1016/c2013-0-11642-x">https://doi.org/10.1016/c2013-0-11642-x</a>.
</div>
<div id="ref-willbur2018" class="csl-entry" role="listitem">
Willbur, J. F., Fall, M. L., Bloomingdale, C., Byrne, A. M., Chapman, S. A., Isard, S. A., Magarey, R. D., McCaghey, M. M., Mueller, B. D., Russo, J. M., Schlegel, J., Chilvers, M. I., Mueller, D. S., Kabbage, M., and Smith, D. L. 2018. Weather-Based Models for Assessing the Risk of <span><em>Sclerotinia sclerotiorum</em></span> Apothecial Presence in Soybean (<span><em>Glycine max</em></span>) Fields. Plant Disease 102:73–84. <a href="https://doi.org/10.1094/pdis-04-17-0504-re">https://doi.org/10.1094/pdis-04-17-0504-re</a>.
</div>
<div id="ref-windels1998" class="csl-entry" role="listitem">
Windels, C. E., Lamey, H. A., Hilde, D., Widner, J., and Knudsen, T. 1998. A Cerospora Leaf Spot Model for Sugar Beet: In Practice by an Industry. Plant Disease 82:716–726. <a href="https://doi.org/10.1094/pdis.1998.82.7.716">https://doi.org/10.1094/pdis.1998.82.7.716</a>.
</div>
<div id="ref-xu2013" class="csl-entry" role="listitem">
Xu, X., Madden, L. V., Edwards, S. G., Doohan, F. M., Moretti, A., Hornok, L., Nicholson, P., and Ritieni, A. 2013. Developing logistic models to relate the accumulation of DON associated with Fusarium head blight to climatic conditions in Europe. European Journal of Plant Pathology 137:689–706. <a href="https://doi.org/10.1007/s10658-013-0280-x">https://doi.org/10.1007/s10658-013-0280-x</a>.
</div>
<div id="ref-xu2000" class="csl-entry" role="listitem">
Xu, X.-M., and Robinson, J. D. 2000. Effects of temperature on the incubation and latent periods of hawthorn powdery mildew (<span><em>Podosphaera clandestina</em></span>). Plant Pathology 49:791–797. <a href="https://doi.org/10.1046/j.1365-3059.2000.00520.x">https://doi.org/10.1046/j.1365-3059.2000.00520.x</a>.
</div>
</div>
</section>
</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./prediction-warning-systems.html" class="pagination-link" aria-label="Warning systems">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Warning systems</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./references.html" class="pagination-link" aria-label="References">
        <span class="nav-page-text">References</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>R4PDE - R for Plant Disease Epidemiology is written by Emerson Del Ponte</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/emdelponte/epidemiology-R/edit/main/prediction-disease-modeling.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/emdelponte/epidemiology-R/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
<p>This book was built with <a href="https://quarto.org/">Quarto</a>.</p>
</div>
  </div>
</footer>




</body></html>